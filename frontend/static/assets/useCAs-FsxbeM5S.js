import{u as o}from"./useQuery-EiOOdz9l.js";import{a as u}from"./index-B1lIGfJA.js";import{u as l}from"./useMutation-DVmYuee3.js";import{a as r}from"./api-ClVrI7m4.js";const n={getAll:async(e={})=>{const a=await r.get("/api/v2/cas",{params:e}),i=(a.data||[]).map(s=>{const p=new Date(s.valid_to)<new Date;return{id:s.id,name:s.common_name||"Unnamed CA",type:s.is_root?"Root":"Intermediate",status:p?"EXPIRED":"ACTIVE",issued:s.valid_from?s.valid_from.split("T")[0]:"N/A",expires:s.valid_to?s.valid_to.split("T")[0]:"N/A",certs:0,children:[],_raw:s}});return{data:i,meta:a.meta||{page:1,per_page:20,total:i.length}}},getTree:async()=>(await r.get("/api/v2/cas/tree")).data,getById:async e=>(await r.get(`/api/v2/cas/${e}`)).data,create:async e=>(await r.post("/api/v2/cas",e)).data,update:async(e,a)=>(await r.patch(`/api/v2/cas/${e}`,a)).data,delete:async e=>(await r.delete(`/api/v2/cas/${e}`)).data},t={all:["cas"],lists:()=>[...t.all,"list"],list:e=>[...t.lists(),e],tree:()=>[...t.all,"tree"],details:()=>[...t.all,"detail"],detail:e=>[...t.details(),e]},w=(e={})=>o({queryKey:t.list(e),queryFn:()=>n.getAll(e)}),A=()=>o({queryKey:t.tree(),queryFn:()=>n.getTree()}),q=()=>{const e=u();return l({mutationFn:n.create,onSuccess:()=>{e.invalidateQueries({queryKey:t.lists()}),e.invalidateQueries({queryKey:t.tree()})}})},C=()=>{const e=u();return l({mutationFn:n.delete,onSuccess:()=>{e.invalidateQueries({queryKey:t.lists()}),e.invalidateQueries({queryKey:t.tree()})}})};export{A as a,C as b,w as c,q as u};
