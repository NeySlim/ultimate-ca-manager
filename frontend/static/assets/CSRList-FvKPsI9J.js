import{j as e,B as d}from"./index-DbMVyzJo.js";import{P as o}from"./PageTopBar-Cw9Co4CJ.js";import{B as x}from"./Badge-Cip0ieme.js";import{a,u as _}from"./api-l2ERiPny.js";const N={getAll:async(n={})=>await a.get("/api/v2/csrs",{params:n}),getById:async n=>(await a.get(`/api/v2/csrs/${n}`)).data,approve:async(n,i)=>(await a.post(`/api/v2/csrs/${n}/approve`,{ca_id:i})).data,reject:async(n,i)=>(await a.post(`/api/v2/csrs/${n}/reject`,{reason:i})).data,delete:async n=>(await a.delete(`/api/v2/csrs/${n}`)).data},c={all:["csrs"],lists:()=>[...c.all,"list"],list:n=>[...c.lists(),n],details:()=>[...c.all,"detail"],detail:n=>[...c.details(),n]},g=(n={})=>_({queryKey:c.list(n),queryFn:()=>N.getAll(n)}),b="_section_xet4x_2",u="_sectionHeader_xet4x_6",C="_sectionIconWarning_xet4x_13",v="_sectionIconSuccess_xet4x_14",y="_sectionIconError_xet4x_15",E="_sectionTitle_xet4x_46",R="_tableContainer_xet4x_53",w="_subjectCell_xet4x_95",f="_cn_xet4x_101",B="_email_xet4x_106",I="_requestedCell_xet4x_112",A="_approvedCell_xet4x_113",S="_date_xet4x_119",T="_ago_xet4x_123",L="_by_xet4x_124",P="_priorityBadge_xet4x_130",D="_badgeHigh_xet4x_141",H="_badgeNormal_xet4x_146",O="_badgeLow_xet4x_151",q="_certificateLink_xet4x_157",$="_reason_xet4x_169",k="_actionsCell_xet4x_175",K="_actionBtn_xet4x_180",J="_btnApprove_xet4x_198",M="_btnReject_xet4x_208",s={section:b,sectionHeader:u,sectionIconWarning:C,sectionIconSuccess:v,sectionIconError:y,sectionTitle:E,tableContainer:R,subjectCell:w,cn:f,email:B,requestedCell:I,approvedCell:A,date:S,ago:T,by:L,priorityBadge:P,badgeHigh:D,badgeNormal:H,badgeLow:O,certificateLink:q,reason:$,actionsCell:k,actionBtn:K,btnApprove:J,btnReject:M};function F(){const{data:n,isLoading:i,error:l}=g(),p=t=>t==="HIGH"?s.badgeHigh:t==="NORMAL"?s.badgeNormal:s.badgeLow;if(i)return e.jsxs("div",{className:s.csrList,children:[e.jsx(o,{icon:"ph ph-file-text",title:"Certificate Signing Requests",badge:e.jsx(x,{variant:"neutral",children:"Loading..."})}),e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading CSRs..."})]});if(l)return e.jsxs("div",{className:s.csrList,children:[e.jsx(o,{icon:"ph ph-file-text",title:"Certificate Signing Requests",badge:e.jsx(x,{variant:"danger",children:"Error"})}),e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-danger)"},children:["Error loading CSRs: ",l.message]})]});const r=n?.data||[],h=r.filter(t=>t.status==="PENDING"),m=r.filter(t=>t.status==="APPROVED"),j=r.filter(t=>t.status==="REJECTED");return e.jsxs("div",{className:s.csrList,children:[e.jsx(o,{icon:"ph ph-file-text",title:"Certificate Signing Requests",badge:e.jsxs(x,{variant:"warning",children:[h.length," Pending"]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"ph ph-upload-simple",children:"Import CSR"}),e.jsx(d,{icon:"ph ph-download-simple",children:"Export"}),e.jsx(d,{variant:"primary",icon:"ph ph-file-plus",children:"Create CSR"})]})}),e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIconWarning,children:e.jsx("i",{className:"ph ph-clock"})}),e.jsx("span",{className:s.sectionTitle,children:"Pending Approval"})]}),e.jsx("div",{className:s.tableContainer,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"30%"},children:"SUBJECT"}),e.jsx("th",{style:{width:"15%"},children:"KEY"}),e.jsx("th",{style:{width:"15%"},children:"REQUESTED"}),e.jsx("th",{style:{width:"15%"},children:"PRIORITY"}),e.jsx("th",{style:{width:"25%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:h.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.subjectCell,children:[e.jsx("span",{className:s.cn,children:t.cn}),e.jsx("span",{className:s.email,children:t.email})]})}),e.jsx("td",{children:t.key}),e.jsx("td",{children:e.jsxs("div",{className:s.requestedCell,children:[e.jsx("span",{className:s.date,children:t.requested}),e.jsx("span",{className:s.ago,children:t.requestedAgo})]})}),e.jsx("td",{children:e.jsx("span",{className:`${s.priorityBadge} ${p(t.priority)}`,children:t.priority})}),e.jsx("td",{children:e.jsxs("div",{className:s.actionsCell,children:[e.jsx("button",{className:`${s.actionBtn} ${s.btnApprove}`,children:"Approve"}),e.jsx("button",{className:`${s.actionBtn} ${s.btnReject}`,children:"Reject"}),e.jsx("button",{className:s.actionBtn,children:"Details"})]})})]},t.id))})]})})]}),e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIconSuccess,children:e.jsx("i",{className:"ph ph-check-circle"})}),e.jsx("span",{className:s.sectionTitle,children:"Recently Approved"})]}),e.jsx("div",{className:s.tableContainer,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"30%"},children:"SUBJECT"}),e.jsx("th",{style:{width:"15%"},children:"KEY"}),e.jsx("th",{style:{width:"15%"},children:"APPROVED"}),e.jsx("th",{style:{width:"15%"},children:"CERTIFICATE"}),e.jsx("th",{style:{width:"25%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.subjectCell,children:[e.jsx("span",{className:s.cn,children:t.cn}),e.jsx("span",{className:s.email,children:t.email})]})}),e.jsx("td",{children:t.key}),e.jsx("td",{children:e.jsxs("div",{className:s.approvedCell,children:[e.jsx("span",{className:s.date,children:t.approved}),e.jsxs("span",{className:s.by,children:["by ",t.approvedBy]})]})}),e.jsx("td",{children:e.jsx("a",{href:"#",className:s.certificateLink,children:t.certificateId})}),e.jsx("td",{children:e.jsxs("div",{className:s.actionsCell,children:[e.jsx("button",{className:s.actionBtn,children:"View"}),e.jsx("button",{className:s.actionBtn,children:"Download"}),e.jsx("button",{className:s.actionBtn,children:"Details"})]})})]},t.id))})]})})]}),j.length>0&&e.jsxs("div",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("div",{className:s.sectionIconError,children:e.jsx("i",{className:"ph ph-x-circle"})}),e.jsx("span",{className:s.sectionTitle,children:"Rejected"})]}),e.jsx("div",{className:s.tableContainer,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"30%"},children:"SUBJECT"}),e.jsx("th",{style:{width:"15%"},children:"KEY"}),e.jsx("th",{style:{width:"15%"},children:"REJECTED"}),e.jsx("th",{style:{width:"20%"},children:"REASON"}),e.jsx("th",{style:{width:"20%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:j.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.subjectCell,children:[e.jsx("span",{className:s.cn,children:t.cn}),e.jsx("span",{className:s.email,children:t.email})]})}),e.jsx("td",{children:t.key}),e.jsx("td",{children:e.jsxs("div",{className:s.approvedCell,children:[e.jsx("span",{className:s.date,children:t.rejected}),e.jsxs("span",{className:s.by,children:["by ",t.rejectedBy]})]})}),e.jsx("td",{children:e.jsx("span",{className:s.reason,children:t.reason})}),e.jsx("td",{children:e.jsx("div",{className:s.actionsCell,children:e.jsx("button",{className:s.actionBtn,children:"Details"})})})]},t.id))})]})})]})]})}export{F as CSRList,F as default};
