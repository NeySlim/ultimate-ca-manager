import{j as e,C as a,B as i}from"./index-DDlYa2Ct.js";import{T as n}from"./Tabs-DL-Nirss.js";import{S as r}from"./StatCard-D73KxiMx.js";import{D as x}from"./DataTable-CX3JAcpi.js";import{I as c}from"./Input-DNK9PXFP.js";import{j,k as h}from"./mockData-D2CEUkeL.js";import"./Icon-DoPQi0vB.js";const m="_crlManagement_1jqgw_3",u="_tabContent_1jqgw_8",f="_statsGrid_1jqgw_14",p="_actions_1jqgw_20",g="_form_1jqgw_25",v="_formActions_1jqgw_32",C="_statusBadge_1jqgw_38",_="_statusDot_1jqgw_52",b="_infoBox_1jqgw_63",R="_infoContent_1jqgw_67",y="_infoIcon_1jqgw_72",N="_infoTitle_1jqgw_85",T="_infoText_1jqgw_92",s={crlManagement:m,tabContent:u,statsGrid:f,actions:p,form:g,formActions:v,statusBadge:C,statusDot:_,infoBox:b,infoContent:R,infoIcon:y,infoTitle:N,infoText:T};function O(){const l=j(),t=h(),d=[{key:"name",label:"CA Name",sortable:!0},{key:"crlSize",label:"CRL Size",sortable:!0},{key:"revocations",label:"Revocations",sortable:!0,render:o=>e.jsx("span",{style:{color:"var(--text-tertiary)"},children:o.revocations})},{key:"lastGenerated",label:"Last Generated",sortable:!0},{key:"nextUpdate",label:"Next Update",sortable:!0},{key:"actions",label:"Actions",render:o=>e.jsxs("div",{className:s.actions,children:[e.jsx(i,{variant:"primary",icon:"ph ph-arrow-clockwise",onClick:()=>console.log("Regenerate:",o),children:"Regenerate"}),e.jsx(i,{variant:"default",icon:"ph ph-download-simple",onClick:()=>console.log("Download:",o),children:"Download"})]})}];return e.jsx("div",{className:s.crlManagement,children:e.jsxs(n,{children:[e.jsxs(n.List,{children:[e.jsx(n.Tab,{children:"CRL Management"}),e.jsx(n.Tab,{children:"OCSP Configuration"})]}),e.jsxs(n.Panels,{children:[e.jsx(n.Panel,{children:e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.statsGrid,children:[e.jsx(r,{value:l.totalCRLs,label:"Total CRLs",icon:"list-checks",gradient:!0}),e.jsx(r,{value:l.totalRevocations,label:"Total Revocations",icon:"x-circle",gradient:!0})]}),e.jsxs(a,{children:[e.jsxs(a.Header,{children:[e.jsx("h3",{children:"CRL Status by CA"}),e.jsx(i,{variant:"primary",icon:"ph ph-arrow-clockwise",children:"Regenerate All"})]}),e.jsx(a.Body,{children:e.jsx(x,{columns:d,data:l.cas,onRowClick:o=>console.log("CA clicked:",o)})})]}),e.jsx(a,{className:s.infoBox,children:e.jsx(a.Body,{children:e.jsxs("div",{className:s.infoContent,children:[e.jsx("div",{className:s.infoIcon,children:e.jsx("i",{className:"ph ph-info"})}),e.jsxs("div",{children:[e.jsx("div",{className:s.infoTitle,children:"Automatic CRL Generation"}),e.jsxs("div",{className:s.infoText,children:["CRLs are automatically regenerated every 24 hours. You can manually regenerate a CRL at any time. Last automatic generation: ",l.lastGenerated]})]})]})})})]})}),e.jsx(n.Panel,{children:e.jsxs("div",{className:s.tabContent,children:[e.jsxs("div",{className:s.statsGrid,children:[e.jsx(r,{value:t.requests24h,label:"Requests (24h)",icon:"activity",gradient:!0}),e.jsx(r,{value:t.avgResponseTime,label:"Avg Response Time",icon:"clock",gradient:!0}),e.jsx(r,{value:t.cacheHitRate,label:"Cache Hit Rate",icon:"database",gradient:!0})]}),e.jsxs(a,{children:[e.jsxs(a.Header,{children:[e.jsx("h3",{children:"OCSP Responder Configuration"}),e.jsxs("div",{className:s.statusBadge,children:[e.jsx("span",{className:s.statusDot,"data-status":t.responderStatus}),e.jsx("span",{children:t.responderStatus})]})]}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsx(c,{label:"OCSP Responder URL",value:t.responderUrl,readOnly:!0}),e.jsx(c,{label:"Total Requests",value:t.requestsTotal.toLocaleString(),readOnly:!0}),e.jsx(c,{label:"Last Restart",value:t.lastRestart,readOnly:!0}),e.jsxs("div",{className:s.formActions,children:[e.jsx(i,{variant:"primary",icon:"ph ph-play",children:"Restart Responder"}),e.jsx(i,{variant:"default",icon:"ph ph-check-circle",children:"Test OCSP"}),e.jsx(i,{variant:"default",icon:"ph ph-gear",children:"Configure"})]})]})})]}),e.jsx(a,{className:s.infoBox,children:e.jsx(a.Body,{children:e.jsxs("div",{className:s.infoContent,children:[e.jsx("div",{className:s.infoIcon,children:e.jsx("i",{className:"ph ph-info"})}),e.jsxs("div",{children:[e.jsx("div",{className:s.infoTitle,children:"About OCSP"}),e.jsx("div",{className:s.infoText,children:"The OCSP responder provides real-time certificate status information to clients. It uses a cache to improve performance and reduce database load."})]})]})})})]})})]})]})})}export{O as CRLManagement,O as default};
