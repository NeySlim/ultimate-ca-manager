import{r as t,p as P,j as e,B as A,z as g}from"./index-BWDmoKA7.js";import{P as F}from"./PageTopBar-Ce7PBM4r.js";import{B}from"./Badge-BFuVPCyZ.js";import{u as Z,M as k,n as $,a as L,b as U}from"./Modal-4XzzdvWm.js";import{I as b}from"./Input-M6RyvAtx.js";import{a as O}from"./api-ClVrI7m4.js";import{e as K}from"./export-BEFxFx9V.js";import"./useQuery-gjiR4eck.js";import"./useMutation-BNvbrO0b.js";const Y=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216.49,79.52l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.52ZM160,57l23,23H160ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,88H152V32Z",opacity:"0.2"}),t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM152,88V44l44,44Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M210.83,85.17l-56-56A4,4,0,0,0,152,28H56A12,12,0,0,0,44,40V216a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V88A4,4,0,0,0,210.83,85.17ZM156,41.65,198.34,84H156ZM200,220H56a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h92V88a4,4,0,0,0,4,4h52V216A4,4,0,0,1,200,220Z"}))]]),Q=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M228,144v64a12,12,0,0,1-12,12H40a12,12,0,0,1-12-12V144a12,12,0,0,1,24,0v52H204V144a12,12,0,0,1,24,0ZM96.49,80.49,116,61v83a12,12,0,0,0,24,0V61l19.51,19.52a12,12,0,1,0,17-17l-40-40a12,12,0,0,0-17,0l-40,40a12,12,0,1,0,17,17Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,48V208H40V48A16,16,0,0,1,56,32H200A16,16,0,0,1,216,48Z",opacity:"0.2"}),t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0ZM93.66,77.66,120,51.31V144a8,8,0,0,0,16,0V51.31l26.34,26.35a8,8,0,0,0,11.32-11.32l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,93.66,77.66Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0ZM88,80h32v64a8,8,0,0,0,16,0V80h32a8,8,0,0,0,5.66-13.66l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,88,80Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M222,144v64a6,6,0,0,1-6,6H40a6,6,0,0,1-6-6V144a6,6,0,0,1,12,0v58H210V144a6,6,0,0,1,12,0ZM92.24,76.24,122,46.49V144a6,6,0,0,0,12,0V46.49l29.76,29.75a6,6,0,0,0,8.48-8.48l-40-40a6,6,0,0,0-8.48,0l-40,40a6,6,0,0,0,8.48,8.48Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0ZM93.66,77.66,120,51.31V144a8,8,0,0,0,16,0V51.31l26.34,26.35a8,8,0,0,0,11.32-11.32l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,93.66,77.66Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M220,144v64a4,4,0,0,1-4,4H40a4,4,0,0,1-4-4V144a4,4,0,0,1,8,0v60H212V144a4,4,0,0,1,8,0ZM90.83,74.83,124,41.66V144a4,4,0,0,0,8,0V41.66l33.17,33.17a4,4,0,1,0,5.66-5.66l-40-40a4,4,0,0,0-5.66,0l-40,40a4,4,0,0,0,5.66,5.66Z"}))]]),q=t.forwardRef((f,x)=>t.createElement(P,{ref:x,...f,weights:Y}));q.displayName="FileIcon";const X=q,G=t.forwardRef((f,x)=>t.createElement(P,{ref:x,...f,weights:Q}));G.displayName="UploadSimpleIcon";const J=G,W="_form_yeq9h_1",ee="_section_yeq9h_7",te="_sectionTitle_yeq9h_13",ae="_fieldGroup_yeq9h_22",se="_fieldRow_yeq9h_29",le="_label_yeq9h_35",ne="_radioGroup_yeq9h_43",ie="_radio_yeq9h_43",re="_select_yeq9h_67",i={form:W,section:ee,sectionTitle:te,fieldGroup:ae,fieldRow:se,label:le,radioGroup:ne,radio:ie,select:re};function oe({isOpen:f,onClose:x}){const[r,v]=t.useState({commonName:"",organization:"",organizationalUnit:"",country:"",state:"",locality:"",validityDays:"3650",keySize:"2048",isRoot:!0}),p=Z(),j=n=>{if(n.preventDefault(),!r.commonName){g.error("Common Name is required");return}p.mutate({common_name:r.commonName,organization:r.organization,organizational_unit:r.organizationalUnit,country:r.country,state:r.state,locality:r.locality,validity_days:parseInt(r.validityDays),key_size:parseInt(r.keySize),is_root:r.isRoot},{onSuccess:()=>{g.success("CA created successfully"),x(),v({commonName:"",organization:"",organizationalUnit:"",country:"",state:"",locality:"",validityDays:"3650",keySize:"2048",isRoot:!0})},onError:m=>{g.error(`Failed to create CA: ${m.message}`)}})},h=(n,m)=>{v(w=>({...w,[n]:m}))};return e.jsx(k,{isOpen:f,onClose:x,title:"Create Certificate Authority",size:"lg",footer:e.jsxs(e.Fragment,{children:[e.jsx(A,{variant:"default",onClick:x,children:"Cancel"}),e.jsx(A,{variant:"primary",onClick:j,disabled:p.isPending,children:p.isPending?"Creating...":"Create CA"})]}),children:e.jsxs("form",{className:i.form,onSubmit:j,children:[e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"CA Type"}),e.jsxs("div",{className:i.radioGroup,children:[e.jsxs("label",{className:i.radio,children:[e.jsx("input",{type:"radio",checked:r.isRoot,onChange:()=>h("isRoot",!0)}),e.jsx("span",{children:"Root CA"})]}),e.jsxs("label",{className:i.radio,children:[e.jsx("input",{type:"radio",checked:!r.isRoot,onChange:()=>h("isRoot",!1)}),e.jsx("span",{children:"Intermediate CA"})]})]})]}),e.jsxs("div",{className:i.section,children:[e.jsx("h3",{className:i.sectionTitle,children:"Subject Information"}),e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"Common Name (CN) *"}),e.jsx(b,{value:r.commonName,onChange:n=>h("commonName",n.target.value),placeholder:"My Root CA",required:!0})]}),e.jsxs("div",{className:i.fieldRow,children:[e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"Organization (O)"}),e.jsx(b,{value:r.organization,onChange:n=>h("organization",n.target.value),placeholder:"My Company"})]}),e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"Organizational Unit (OU)"}),e.jsx(b,{value:r.organizationalUnit,onChange:n=>h("organizationalUnit",n.target.value),placeholder:"IT Department"})]})]}),e.jsxs("div",{className:i.fieldRow,children:[e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"Country (C)"}),e.jsx(b,{value:r.country,onChange:n=>h("country",n.target.value),placeholder:"US",maxLength:2})]}),e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"State/Province (ST)"}),e.jsx(b,{value:r.state,onChange:n=>h("state",n.target.value),placeholder:"California"})]}),e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"City/Locality (L)"}),e.jsx(b,{value:r.locality,onChange:n=>h("locality",n.target.value),placeholder:"San Francisco"})]})]})]}),e.jsxs("div",{className:i.section,children:[e.jsx("h3",{className:i.sectionTitle,children:"Settings"}),e.jsxs("div",{className:i.fieldRow,children:[e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"Validity (days)"}),e.jsx(b,{type:"number",value:r.validityDays,onChange:n=>h("validityDays",n.target.value),min:"1",max:"36500"})]}),e.jsxs("div",{className:i.fieldGroup,children:[e.jsx("label",{className:i.label,children:"Key Size (bits)"}),e.jsxs("select",{className:i.select,value:r.keySize,onChange:n=>h("keySize",n.target.value),children:[e.jsx("option",{value:"2048",children:"2048"}),e.jsx("option",{value:"4096",children:"4096"})]})]})]})]})]})})}const ce="_container_e1v7i_1",de="_hiddenInput_e1v7i_5",he="_dropzone_e1v7i_9",pe="_disabled_e1v7i_19",me="_dragging_e1v7i_24",ue="_error_e1v7i_35",xe="_icon_e1v7i_39",je="_text_e1v7i_44",fe="_primary_e1v7i_50",ve="_secondary_e1v7i_56",_e="_preview_e1v7i_62",ge="_fileIcon_e1v7i_72",Ce="_fileInfo_e1v7i_77",Ne="_fileName_e1v7i_82",ye="_fileSize_e1v7i_92",we="_removeBtn_e1v7i_98",be="_errorText_e1v7i_118",u={container:ce,hiddenInput:de,dropzone:he,disabled:pe,dragging:me,error:ue,icon:xe,text:je,primary:fe,secondary:ve,preview:_e,fileIcon:ge,fileInfo:Ce,fileName:Ne,fileSize:ye,removeBtn:we,errorText:be};function Se({value:f,onChange:x,accept:r="*",maxSize:v=10*1024*1024,disabled:p=!1,error:j=null}){const[h,n]=t.useState(!1),m=t.useRef(null),w=o=>{o.preventDefault(),o.stopPropagation(),p||n(!0)},S=o=>{o.preventDefault(),o.stopPropagation(),n(!1)},_=o=>{o.preventDefault(),o.stopPropagation()},M=o=>{if(o.preventDefault(),o.stopPropagation(),n(!1),p)return;const l=o.dataTransfer.files;l&&l.length>0&&C(l[0])},y=o=>{const l=o.target.files;l&&l.length>0&&C(l[0])},C=o=>{if(o.size>v){x(null,`File too large. Max size: ${Math.round(v/1024/1024)}MB`);return}x(o,null)},I=()=>{x(null,null),m.current&&(m.current.value="")},V=()=>{!p&&m.current&&m.current.click()},T=o=>{if(o===0)return"0 Bytes";const l=1024,N=["Bytes","KB","MB"],E=Math.floor(Math.log(o)/Math.log(l));return Math.round(o/Math.pow(l,E)*100)/100+" "+N[E]};return e.jsxs("div",{className:u.container,children:[e.jsx("input",{ref:m,type:"file",accept:r,onChange:y,disabled:p,className:u.hiddenInput}),f?e.jsxs("div",{className:u.preview,children:[e.jsx(X,{size:24,className:u.fileIcon}),e.jsxs("div",{className:u.fileInfo,children:[e.jsx("p",{className:u.fileName,children:f.name}),e.jsx("p",{className:u.fileSize,children:T(f.size)})]}),!p&&e.jsx("button",{type:"button",onClick:I,className:u.removeBtn,title:"Remove file",children:e.jsx($,{size:16})})]}):e.jsxs("div",{className:`${u.dropzone} ${h?u.dragging:""} ${p?u.disabled:""} ${j?u.error:""}`,onDragEnter:w,onDragLeave:S,onDragOver:_,onDrop:M,onClick:V,children:[e.jsx(J,{size:32,className:u.icon}),e.jsxs("div",{className:u.text,children:[e.jsx("p",{className:u.primary,children:h?"Drop file here":"Click to browse or drag and drop"}),e.jsxs("p",{className:u.secondary,children:["Max file size: ",Math.round(v/1024/1024),"MB"]})]})]}),j&&e.jsx("p",{className:u.errorText,children:j})]})}const Ee="_form_12l8t_1",Ae="_fieldGroup_12l8t_7",Me="_label_12l8t_13",Ve="_formatSelector_12l8t_19",Te="_formatOption_12l8t_25",Ie="_formatLabel_12l8t_46",He="_formatHint_12l8t_57",ze="_preview_12l8t_63",Re="_previewTitle_12l8t_70",De="_previewContent_12l8t_77",Fe="_previewRow_12l8t_83",Be="_previewLabel_12l8t_89",Pe="_previewValue_12l8t_95",ke="_helpText_12l8t_100",c={form:Ee,fieldGroup:Ae,label:Me,formatSelector:Ve,formatOption:Te,formatLabel:Ie,formatHint:He,preview:ze,previewTitle:Re,previewContent:De,previewRow:Fe,previewLabel:Be,previewValue:Pe,helpText:ke};function qe({isOpen:f,onClose:x,onSuccess:r}){const[v,p]=t.useState(null),[j,h]=t.useState("PEM"),[n,m]=t.useState(""),[w,S]=t.useState(null),[_,M]=t.useState(!1),[y,C]=t.useState(null),I=(l,N)=>{if(p(l),S(N),C(null),l&&j==="PEM"){const E=new FileReader;E.onload=R=>{const H=R.target.result;if(H.includes("BEGIN CERTIFICATE")){const D=H.split(`
`),a=D.findIndex(z=>z.includes("BEGIN CERTIFICATE")),d=D.findIndex(z=>z.includes("END CERTIFICATE"));a>=0&&d>a&&C({type:"PEM Certificate",lines:d-a+1,size:l.size})}},E.readAsText(l)}},V=async()=>{if(!v){g.error("Please select a file to upload");return}if(j==="PKCS12"&&!n){g.error("Password is required for PKCS12 format");return}M(!0);const l=new FormData;l.append("file",v),l.append("format",j),n&&l.append("password",n);try{const N=await O.post("/api/v2/certificates/import",l,{headers:{"Content-Type":"multipart/form-data"}});g.success("CA imported successfully"),p(null),h("PEM"),m(""),C(null),S(null),r&&r(N),x()}catch(N){g.error(`Import failed: ${N.message||"Unknown error"}`)}finally{M(!1)}},T=()=>{_||(p(null),h("PEM"),m(""),C(null),S(null),x())},o={PEM:".pem,.crt,.cer",DER:".der,.cer",PKCS12:".p12,.pfx"};return e.jsx(k,{isOpen:f,onClose:T,title:"Import Certificate Authority",size:"lg",footer:e.jsxs(e.Fragment,{children:[e.jsx(A,{variant:"default",onClick:T,disabled:_,children:"Cancel"}),e.jsx(A,{variant:"primary",onClick:V,disabled:!v||_||!!w,children:_?"Importing...":"Import CA"})]}),children:e.jsxs("div",{className:c.form,children:[e.jsxs("div",{className:c.fieldGroup,children:[e.jsx("label",{className:c.label,children:"Certificate Format"}),e.jsx("div",{className:c.formatSelector,children:["PEM","DER","PKCS12"].map(l=>e.jsxs("label",{className:c.formatOption,children:[e.jsx("input",{type:"radio",name:"format",value:l,checked:j===l,onChange:N=>{h(N.target.value),p(null),C(null)},disabled:_}),e.jsx("span",{className:c.formatLabel,children:l}),e.jsxs("span",{className:c.formatHint,children:[l==="PEM"&&"Base64 encoded, most common",l==="DER"&&"Binary format",l==="PKCS12"&&"Password protected bundle"]})]},l))})]}),e.jsxs("div",{className:c.fieldGroup,children:[e.jsx("label",{className:c.label,children:"Certificate File"}),e.jsx(Se,{value:v,onChange:I,accept:o[j],maxSize:5*1024*1024,disabled:_,error:w})]}),j==="PKCS12"&&e.jsxs("div",{className:c.fieldGroup,children:[e.jsx("label",{className:c.label,children:"Password"}),e.jsx(b,{type:"password",value:n,onChange:l=>m(l.target.value),placeholder:"Enter PKCS12 password",disabled:_})]}),y&&e.jsxs("div",{className:c.preview,children:[e.jsx("h4",{className:c.previewTitle,children:"Certificate Preview"}),e.jsxs("div",{className:c.previewContent,children:[e.jsxs("div",{className:c.previewRow,children:[e.jsx("span",{className:c.previewLabel,children:"Type:"}),e.jsx("span",{className:c.previewValue,children:y.type})]}),e.jsxs("div",{className:c.previewRow,children:[e.jsx("span",{className:c.previewLabel,children:"Size:"}),e.jsxs("span",{className:c.previewValue,children:[y.size," bytes"]})]}),y.lines&&e.jsxs("div",{className:c.previewRow,children:[e.jsx("span",{className:c.previewLabel,children:"Lines:"}),e.jsx("span",{className:c.previewValue,children:y.lines})]})]})]}),e.jsx("div",{className:c.helpText,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," The CA certificate will be validated and imported into the system. Make sure the file format matches the selected type."]})})]})})}const Ge="_filtersSection_1nm9q_2",Ze="_filterGroup_1nm9q_13",$e="_tableContainer_1nm9q_56",Le="_caNameCell_1nm9q_99",Ue="_caExpandBtn_1nm9q_105",Oe="_collapsed_1nm9q_123",Ke="_noChildren_1nm9q_127",Ye="_caTreeIndent_1nm9q_132",Qe="_caIcon_1nm9q_160",Xe="_root_1nm9q_165",Je="_intermediate_1nm9q_169",We="_orphan_1nm9q_173",et="_statusBadge_1nm9q_178",tt="_actionsCell_1nm9q_201",at="_actionBtn_1nm9q_206",st="_orphanedSection_1nm9q_231",lt="_orphanedHeader_1nm9q_239",nt="_orphanedHeaderText_1nm9q_253",it="_orphanedTable_1nm9q_259",s={filtersSection:Ge,filterGroup:Ze,tableContainer:$e,caNameCell:Le,caExpandBtn:Ue,collapsed:Oe,noChildren:Ke,caTreeIndent:Ye,caIcon:Qe,root:Xe,intermediate:Je,orphan:We,statusBadge:et,actionsCell:tt,actionBtn:at,orphanedSection:st,orphanedHeader:lt,orphanedHeaderText:nt,orphanedTable:it};function jt(){const[f,x]=t.useState("all"),[r,v]=t.useState("all"),[p,j]=t.useState("name"),[h,n]=t.useState(""),[m,w]=t.useState(new Set),[S,_]=t.useState(!1),[M,y]=t.useState(!1),{data:C,isLoading:I,error:V}=L(),T=U(),o=a=>{confirm(`Delete CA "${a.name}"? This cannot be undone.`)&&T.mutate(a.id,{onSuccess:()=>g.success("CA deleted"),onError:()=>g.error("Failed to delete CA")})},l=a=>{const d=new Set(m);d.has(a)?d.delete(a):d.add(a),w(d)},N=()=>{const a=C?.data||[];if(a.length===0){g.error("No data to export");return}K(a,"cas-export",{format:"csv",columns:["id","name","type","status","issued","expires","certs"]}),g.success("CAs exported successfully")},E=()=>{g.success("CA imported successfully")};if(I)return e.jsxs("div",{className:s.caList,children:[e.jsx(F,{icon:"ph ph-bank",title:"Certificate Authorities",badge:e.jsx(B,{variant:"neutral",children:"Loading..."})}),e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading CAs..."})]});if(V)return e.jsxs("div",{className:s.caList,children:[e.jsx(F,{icon:"ph ph-bank",title:"Certificate Authorities",badge:e.jsx(B,{variant:"danger",children:"Error"})}),e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-danger)"},children:["Error loading CAs: ",V.message]})]});const R=C?.data||[],H=[],D=R.filter(a=>a.status==="ACTIVE").length;return e.jsxs("div",{className:s.caList,children:[e.jsx(F,{icon:"ph ph-bank",title:"Certificate Authorities",badge:e.jsxs(B,{variant:"success",children:[D," Active"]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(A,{icon:"ph ph-upload-simple",onClick:()=>y(!0),children:"Import"}),e.jsx(A,{icon:"ph ph-download-simple",onClick:N,children:"Export"}),e.jsx(A,{variant:"primary",icon:"ph ph-plus",onClick:()=>_(!0),children:"Create CA"})]})}),e.jsxs("div",{className:s.filtersSection,children:[e.jsxs("div",{className:s.filterGroup,children:[e.jsx("label",{htmlFor:"type-filter",children:"TYPE"}),e.jsxs("select",{id:"type-filter",value:f,onChange:a=>x(a.target.value),children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"root",children:"Root"}),e.jsx("option",{value:"intermediate",children:"Intermediate"})]})]}),e.jsxs("div",{className:s.filterGroup,children:[e.jsx("label",{htmlFor:"status-filter",children:"STATUS"}),e.jsxs("select",{id:"status-filter",value:r,onChange:a=>v(a.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:s.filterGroup,children:[e.jsx("label",{htmlFor:"sort-filter",children:"SORT BY"}),e.jsxs("select",{id:"sort-filter",value:p,onChange:a=>j(a.target.value),children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"issued",children:"Issued Date"}),e.jsx("option",{value:"expires",children:"Expires Date"})]})]}),e.jsx("div",{style:{flex:1}}),e.jsx("div",{className:s.filterGroup,children:e.jsx("input",{type:"text",id:"search-filter",placeholder:"Search CAs...",value:h,onChange:a=>n(a.target.value)})})]}),e.jsx("div",{className:s.tableContainer,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"35%"},children:"NAME"}),e.jsx("th",{style:{width:"15%"},children:"TYPE"}),e.jsx("th",{style:{width:"12%"},children:"STATUS"}),e.jsx("th",{style:{width:"12%"},children:"ISSUED"}),e.jsx("th",{style:{width:"12%"},children:"EXPIRES"}),e.jsx("th",{style:{width:"8%"},children:"CERTS"}),e.jsx("th",{style:{width:"6%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:R.map(a=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.caNameCell,children:[e.jsx("button",{className:`${s.caExpandBtn} ${a.children?"":s.noChildren} ${m.has(a.id)?"":s.collapsed}`,onClick:()=>a.children&&l(a.id),children:e.jsx("i",{className:"ph ph-caret-down"})}),e.jsx("i",{className:`ph ph-bank ${s.caIcon} ${s.root}`}),e.jsx("span",{children:a.name})]})}),e.jsx("td",{children:e.jsx("span",{children:a.type})}),e.jsx("td",{children:e.jsx("span",{className:`${s.statusBadge} ${a.status.toLowerCase()}`,children:a.status})}),e.jsx("td",{children:a.issued}),e.jsx("td",{children:a.expires}),e.jsx("td",{children:a.certs}),e.jsx("td",{children:e.jsxs("div",{className:s.actionsCell,children:[e.jsx("button",{className:s.actionBtn,title:"View",children:e.jsx("i",{className:"ph ph-eye"})}),e.jsx("button",{className:s.actionBtn,title:"Delete",onClick:d=>{d.stopPropagation(),o(a)},children:e.jsx("i",{className:"ph ph-trash"})})]})})]},a.id),a.children&&m.has(a.id)&&a.children.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.caTreeIndent,children:[e.jsx("i",{className:`ph ph-git-branch ${s.caIcon} ${s.intermediate}`}),e.jsx("span",{children:d.name})]})}),e.jsx("td",{children:e.jsx("span",{children:d.type})}),e.jsx("td",{children:e.jsx("span",{className:`${s.statusBadge} ${d.status.toLowerCase()}`,children:d.status})}),e.jsx("td",{children:d.issued}),e.jsx("td",{children:d.expires}),e.jsx("td",{children:d.certs}),e.jsx("td",{children:e.jsxs("div",{className:s.actionsCell,children:[e.jsx("button",{className:s.actionBtn,title:"View",children:e.jsx("i",{className:"ph ph-eye"})}),e.jsx("button",{className:s.actionBtn,title:"Delete",onClick:z=>{z.stopPropagation(),o(d)},children:e.jsx("i",{className:"ph ph-trash"})})]})})]},d.id))]}))})]})}),H.length>0&&e.jsxs("div",{className:s.orphanedSection,children:[e.jsxs("div",{className:s.orphanedHeader,children:[e.jsx("i",{className:"ph ph-warning"}),e.jsx("span",{className:s.orphanedHeaderText,children:"Orphaned Intermediate CAs"})]}),e.jsx("div",{className:s.orphanedTable,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"35%"},children:"NAME"}),e.jsx("th",{style:{width:"15%"},children:"TYPE"}),e.jsx("th",{style:{width:"12%"},children:"STATUS"}),e.jsx("th",{style:{width:"12%"},children:"ISSUED"}),e.jsx("th",{style:{width:"12%"},children:"EXPIRES"}),e.jsx("th",{style:{width:"8%"},children:"CERTS"}),e.jsx("th",{style:{width:"6%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:H.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:s.caNameCell,children:[e.jsx("i",{className:`ph ph-warning ${s.caIcon} ${s.orphan}`}),e.jsx("span",{children:a.name})]})}),e.jsx("td",{children:e.jsx("span",{children:a.type})}),e.jsx("td",{children:e.jsx("span",{className:`${s.statusBadge} ${a.status.toLowerCase()}`,children:a.status})}),e.jsx("td",{children:a.issued}),e.jsx("td",{children:a.expires}),e.jsx("td",{children:a.certs}),e.jsx("td",{children:e.jsxs("div",{className:s.actionsCell,children:[e.jsx("button",{className:s.actionBtn,title:"View",children:e.jsx("i",{className:"ph ph-eye"})}),e.jsx("button",{className:s.actionBtn,title:"Delete",onClick:d=>{d.stopPropagation(),o(a)},children:e.jsx("i",{className:"ph ph-trash"})})]})})]},a.id))})]})})]}),e.jsx(oe,{isOpen:S,onClose:()=>_(!1)}),e.jsx(qe,{isOpen:M,onClose:()=>y(!1),onSuccess:E})]})}export{jt as CAList,jt as default};
