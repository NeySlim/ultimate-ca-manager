import{r as p,j as e,C as a,B as i}from"./index-DObup2mi.js";import{T as l}from"./Tabs-D80WdCyu.js";import{I as r}from"./Input-BDSyLfvX.js";import{B as C}from"./Badge-D_rTYi2D.js";import{D as N}from"./DataTable-D7kJeCeZ.js";const v="_importPage_17krz_1",y="_tabContent_17krz_6",I="_subMethods_17krz_12",P="_subMethod_17krz_12",A="_active_17krz_33",E="_subMethodTitle_17krz_49",k="_form_17krz_58",_="_formGroup_17krz_64",M="_formLabel_17krz_70",T="_formInput_17krz_78",F="_formTextarea_17krz_92",w="_formHelp_17krz_113",B="_formCheckbox_17krz_118",s={importPage:v,tabContent:y,subMethods:I,subMethod:P,active:A,subMethodTitle:E,form:k,formGroup:_,formLabel:M,formInput:T,formTextarea:F,formHelp:w,formCheckbox:B};function L(){const[c,h]=p.useState(0),[o,x]=p.useState(0),j=[{id:1,type:"CA",name:"Root CA",subject:"CN=Root CA",validUntil:"2034-02-15"},{id:2,type:"Certificate",name:"Web GUI",subject:"CN=opnsense.local",validUntil:"2025-03-01"},{id:3,type:"Certificate",name:"VPN Server",subject:"CN=vpn.acme.com",validUntil:"2025-06-12"}],f=[{key:"type",label:"Type",render:t=>e.jsx(C,{variant:t.type==="CA"?"info":"success",children:t.type})},{key:"name",label:"Name"},{key:"subject",label:"Subject",render:t=>e.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:"12px"},children:t.subject})},{key:"validUntil",label:"Valid Until"}],d=(t,b,u)=>e.jsx("div",{className:s.subMethods,children:t.map((m,n)=>e.jsxs("div",{className:`${s.subMethod} ${b===n?s.active:""}`,onClick:()=>u(n),children:[e.jsx("i",{className:m.icon}),e.jsx("div",{className:s.subMethodTitle,children:m.title})]},n))});return e.jsx("div",{className:s.importPage,children:e.jsxs(l,{children:[e.jsxs(l.List,{children:[e.jsx(l.Tab,{children:"CA Import"}),e.jsx(l.Tab,{children:"Certificate Import"}),e.jsx(l.Tab,{children:"OPNsense Import"})]}),e.jsxs(l.Panels,{children:[e.jsx(l.Panel,{children:e.jsxs("div",{className:s.tabContent,children:[d([{icon:"ph ph-clipboard-text",title:"Paste PEM"},{icon:"ph ph-upload",title:"Upload Files"},{icon:"ph ph-package",title:"Container P12/PFX"}],c,h),c===0&&e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"Paste PEM Encoded CA"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"CA Certificate (PEM)"}),e.jsx("textarea",{className:s.formTextarea,placeholder:`-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw
...
-----END CERTIFICATE-----`}),e.jsx("div",{className:s.formHelp,children:"Paste the PEM-encoded CA certificate"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Private Key (Optional, PEM)"}),e.jsx("textarea",{className:s.formTextarea,placeholder:`-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC7VJ...
-----END PRIVATE KEY-----`}),e.jsx("div",{className:s.formHelp,children:"Only required if this CA will issue certificates"})]}),e.jsx(r,{label:"CA Name",placeholder:"My Root CA"}),e.jsxs("div",{className:s.formCheckbox,children:[e.jsx("input",{type:"checkbox",id:"ca-trust"}),e.jsx("label",{htmlFor:"ca-trust",children:"Add to Trust Store"})]}),e.jsx(i,{variant:"primary",icon:"ph ph-download",children:"Import CA"})]})})]}),c===1&&e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"Upload CA Files"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"CA Certificate File"}),e.jsx("input",{type:"file",className:s.formInput,accept:".pem,.crt,.cer"}),e.jsx("div",{className:s.formHelp,children:"Upload PEM or DER encoded certificate"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Private Key File (Optional)"}),e.jsx("input",{type:"file",className:s.formInput,accept:".pem,.key"}),e.jsx("div",{className:s.formHelp,children:"Only required if this CA will issue certificates"})]}),e.jsx(r,{label:"CA Name",placeholder:"My Root CA"}),e.jsxs("div",{className:s.formCheckbox,children:[e.jsx("input",{type:"checkbox",id:"ca-trust-upload"}),e.jsx("label",{htmlFor:"ca-trust-upload",children:"Add to Trust Store"})]}),e.jsx(i,{variant:"primary",icon:"ph ph-download",children:"Import CA"})]})})]}),c===2&&e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"Import from P12/PFX Container"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"P12/PFX File"}),e.jsx("input",{type:"file",className:s.formInput,accept:".p12,.pfx"}),e.jsx("div",{className:s.formHelp,children:"PKCS#12 container with CA certificate and private key"})]}),e.jsx(r,{label:"Container Password",type:"password",placeholder:"Enter password"}),e.jsx(r,{label:"CA Name",placeholder:"My Root CA"}),e.jsxs("div",{className:s.formCheckbox,children:[e.jsx("input",{type:"checkbox",id:"ca-trust-p12"}),e.jsx("label",{htmlFor:"ca-trust-p12",children:"Add to Trust Store"})]}),e.jsx(i,{variant:"primary",icon:"ph ph-download",children:"Import CA"})]})})]})]})}),e.jsx(l.Panel,{children:e.jsxs("div",{className:s.tabContent,children:[d([{icon:"ph ph-clipboard-text",title:"Paste PEM"},{icon:"ph ph-upload",title:"Upload Files"},{icon:"ph ph-package",title:"Container"}],o,x),o===0&&e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"Paste PEM Encoded Certificate"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Certificate (PEM)"}),e.jsx("textarea",{className:s.formTextarea,placeholder:`-----BEGIN CERTIFICATE-----
...`})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Private Key (Optional, PEM)"}),e.jsx("textarea",{className:s.formTextarea,placeholder:`-----BEGIN PRIVATE KEY-----
...`})]}),e.jsx(r,{label:"Certificate Name",placeholder:"server.example.com"}),e.jsx(i,{variant:"primary",icon:"ph ph-download",children:"Import Certificate"})]})})]}),o===1&&e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"Upload Certificate Files"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Certificate File"}),e.jsx("input",{type:"file",className:s.formInput,accept:".pem,.crt,.cer"}),e.jsx("div",{className:s.formHelp,children:"Upload PEM or DER encoded certificate"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Private Key File (Optional)"}),e.jsx("input",{type:"file",className:s.formInput,accept:".pem,.key"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"Certificate Chain (Optional)"}),e.jsx("input",{type:"file",className:s.formInput,accept:".pem,.crt"}),e.jsx("div",{className:s.formHelp,children:"Intermediate certificates"})]}),e.jsx(r,{label:"Certificate Name",placeholder:"server.example.com"}),e.jsx(i,{variant:"primary",icon:"ph ph-download",children:"Import Certificate"})]})})]}),o===2&&e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"Import from Container"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{className:s.formLabel,children:"P12/PFX File"}),e.jsx("input",{type:"file",className:s.formInput,accept:".p12,.pfx"}),e.jsx("div",{className:s.formHelp,children:"PKCS#12 container with certificate and private key"})]}),e.jsx(r,{label:"Container Password",type:"password",placeholder:"Enter password"}),e.jsx(r,{label:"Certificate Name",placeholder:"server.example.com"}),e.jsx(i,{variant:"primary",icon:"ph ph-download",children:"Import Certificate"})]})})]})]})}),e.jsx(l.Panel,{children:e.jsxs("div",{className:s.tabContent,children:[e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h3",{children:"OPNsense Connection"})}),e.jsx(a.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsx(r,{label:"Host",placeholder:"opnsense.local",defaultValue:"192.168.1.1"}),e.jsx(r,{label:"Port",type:"number",placeholder:"443",defaultValue:"443"}),e.jsx(r,{label:"API Key",placeholder:"Enter API key"}),e.jsx(r,{label:"API Secret",type:"password",placeholder:"Enter API secret"}),e.jsxs("div",{className:s.formCheckbox,children:[e.jsx("input",{type:"checkbox",id:"verify-ssl",defaultChecked:!0}),e.jsx("label",{htmlFor:"verify-ssl",children:"Verify SSL Certificate"})]}),e.jsx(i,{variant:"primary",icon:"ph ph-plug",children:"Connect"})]})})]}),e.jsxs(a,{children:[e.jsxs(a.Header,{children:[e.jsx("h3",{children:"Available Items"}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-tertiary)"},children:"Connected to 192.168.1.1"})]}),e.jsx(a.Body,{children:e.jsx(N,{columns:f,data:j,onRowClick:t=>console.log("Item:",t),pageSize:10})})]})]})})]})]})})}export{L as ImportPage,L as default};
