function a(n,t,e){const c=new Blob([n],{type:e}),r=URL.createObjectURL(c),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}function d(n,t=null){if(!n||n.length===0)return"";const e=t||Object.keys(n[0]),c=i=>{if(i==null)return"";const o=String(i);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o},r=e.join(","),s=n.map(i=>e.map(o=>c(i[o])).join(","));return[r,...s].join(`
`)}function p(n,t,e=null){const c=d(n,e),r=new Date().toISOString().split("T")[0];a(c,`${t}-${r}.csv`,"text/csv;charset=utf-8;")}function f(n,t){const e=JSON.stringify(n,null,2),c=new Date().toISOString().split("T")[0];a(e,`${t}-${c}.json`,"application/json")}function m(n,t,e={}){const{format:c="csv",columns:r=null,excludeColumns:s=["_raw","_internal"]}=e,i=n.map(o=>{const u={};return Object.keys(o).forEach(l=>{!l.startsWith("_")&&!s.includes(l)&&(u[l]=o[l])}),u});c==="json"?f(i,t):p(i,t,r)}export{m as e};
