import{u as p}from"./useQuery-BApTqGVR.js";import{a as o}from"./index-BWQLoRwR.js";import{u as l}from"./useMutation-sdNRJHjV.js";import{a as n}from"./api-ClVrI7m4.js";const i={getAll:async(e={})=>{const s=await n.get("/api/v2/cas",{params:e}),r=(s.data||[]).map(t=>{const u=new Date(t.valid_to)<new Date;return{id:t.id,name:t.common_name||"Unnamed CA",type:t.is_root?"Root":"Intermediate",status:u?"EXPIRED":"ACTIVE",issued:t.valid_from?t.valid_from.split("T")[0]:"N/A",expires:t.valid_to?t.valid_to.split("T")[0]:"N/A",certs:0,children:[],_raw:t}});return{data:r,meta:s.meta||{page:1,per_page:20,total:r.length}}},getById:async e=>(await n.get(`/api/v2/cas/${e}`)).data,create:async e=>(await n.post("/api/v2/cas",e)).data,update:async(e,s)=>(await n.patch(`/api/v2/cas/${e}`,s)).data,delete:async e=>(await n.delete(`/api/v2/cas/${e}`)).data},a={all:["cas"],lists:()=>[...a.all,"list"],list:e=>[...a.lists(),e],details:()=>[...a.all,"detail"],detail:e=>[...a.details(),e]},A=(e={})=>p({queryKey:a.list(e),queryFn:()=>i.getAll(e)}),C=()=>{const e=o();return l({mutationFn:i.create,onSuccess:()=>{e.invalidateQueries({queryKey:a.lists()})}})},_=()=>{const e=o();return l({mutationFn:i.delete,onSuccess:()=>{e.invalidateQueries({queryKey:a.lists()})}})};export{A as a,_ as b,C as u};
