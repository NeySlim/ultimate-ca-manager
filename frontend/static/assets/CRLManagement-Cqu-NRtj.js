import{j as e,B as t,C as r,z as i}from"./index-CFAwig20.js";import{P as h}from"./PageTopBar-BSgaL0Fo.js";import{S as m,a as s}from"./StatsGrid-BBxU-1Z8.js";import{D as x}from"./DataTable-gIP3eV8P.js";import{B as o}from"./Badge-CGzdQboG.js";const b="_crlManagement_yal1l_1",C={crlManagement:b};function k(){const d=a=>{window.open(`/api/v2/crl/download/${a}`,"_blank"),i.success("CRL download started")},c=a=>{i.success(`Regenerating CRL for ${a.name}...`)},p=[{id:1,name:"Internal Root CA",crlStatus:"active",lastGenerated:"2 hours ago",nextUpdate:"In 22 hours",ocspStatus:"enabled",revokedCerts:3},{id:2,name:"Production Intermediate CA",crlStatus:"active",lastGenerated:"3 hours ago",nextUpdate:"In 21 hours",ocspStatus:"enabled",revokedCerts:12},{id:3,name:"Development Intermediate CA",crlStatus:"active",lastGenerated:"1 hour ago",nextUpdate:"In 23 hours",ocspStatus:"enabled",revokedCerts:8},{id:4,name:"ECDSA Root CA",crlStatus:"stale",lastGenerated:"3 days ago",nextUpdate:"Overdue",ocspStatus:"enabled",revokedCerts:1},{id:5,name:"Testing Root CA",crlStatus:"disabled",lastGenerated:"-",nextUpdate:"-",ocspStatus:"disabled",revokedCerts:0}],u=[{key:"name",label:"CA Name",sortable:!0,render:a=>e.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:"12px"},children:a.name})},{key:"crlStatus",label:"CRL Status",sortable:!0,render:a=>{const n={active:"success",stale:"warning",disabled:"info"},l={active:"Active",stale:"Stale",disabled:"Disabled"};return e.jsx(o,{variant:n[a.crlStatus],children:l[a.crlStatus]})}},{key:"lastGenerated",label:"Last Generated",sortable:!0},{key:"nextUpdate",label:"Next Update",sortable:!0},{key:"ocspStatus",label:"OCSP",sortable:!0,render:a=>{const n={enabled:"success",disabled:"info"},l={enabled:"Enabled",disabled:"Disabled"};return e.jsx(o,{variant:n[a.ocspStatus],children:l[a.ocspStatus]})}},{key:"revokedCerts",label:"Revoked Certs",sortable:!0},{key:"actions",label:"Actions",render:a=>e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.crlStatus!=="disabled"&&e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-arrows-clockwise",onClick:()=>c(a)}),e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-download-simple",onClick:()=>d(a.id)})]}),a.crlStatus==="disabled"&&e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-gear",onClick:()=>console.log("Configure:",a)})]})}];return e.jsxs("div",{className:C.crlManagement,children:[e.jsx(h,{icon:"ph ph-list-checks",title:"CRL Management",badge:e.jsx(o,{variant:"success",children:"5 Active CAs"}),actions:e.jsxs(e.Fragment,{children:[e.jsx(t,{icon:"ph ph-arrows-clockwise",children:"Regenerate All"}),e.jsx(t,{icon:"ph ph-download-simple",children:"Export CRLs"})]})}),e.jsxs(m,{columns:4,children:[e.jsx(s,{value:"23",label:"CRLs Generated",icon:"ph ph-file-text"}),e.jsx(s,{value:"14,523",label:"OCSP Requests (24h)",icon:"ph ph-chart-line"}),e.jsx(s,{value:"5",label:"Active CAs",icon:"ph ph-certificate"}),e.jsx(s,{value:"12ms",label:"Avg Response Time",icon:"ph ph-timer"})]}),e.jsxs(r,{children:[e.jsxs(r.Header,{children:[e.jsx("h3",{children:"Certificate Authorities"}),e.jsx(t,{variant:"default",icon:"ph ph-funnel",children:"Filter"})]}),e.jsx(r.Body,{children:e.jsx(x,{columns:u,data:p,onRowClick:a=>console.log("CA clicked:",a),pageSize:10})})]})]})}export{k as CRLManagement,k as default};
