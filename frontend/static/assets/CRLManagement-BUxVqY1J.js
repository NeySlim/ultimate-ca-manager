import{r as x,j as e,B as t,C as l,z as o}from"./index-DdQHJRZe.js";import{P as b}from"./PageTopBar-CMHHaflg.js";import{S as C,a as n}from"./StatsGrid-CgYomZaz.js";import{D as g}from"./DataTable-C5P1CUA9.js";import{B as i}from"./Badge-Ds7r_Uvs.js";import{a as v}from"./api-ClVrI7m4.js";const f="_crlManagement_yal1l_1",S={crlManagement:f};function M(){const[d,c]=x.useState(!1),p=a=>{window.open(`/api/v2/crl/download/${a}`,"_blank"),o.success("CRL download started")},u=async a=>{if(confirm(`Regenerate CRL for ${a.name}? This may take a moment.`)){c(!0);try{await v.post(`/api/v2/crl/regenerate/${a.id}`),o.success("CRL regenerated successfully")}catch{o.error("Failed to regenerate CRL")}finally{c(!1)}}},h=[{id:1,name:"Internal Root CA",crlStatus:"active",lastGenerated:"2 hours ago",nextUpdate:"In 22 hours",ocspStatus:"enabled",revokedCerts:3},{id:2,name:"Production Intermediate CA",crlStatus:"active",lastGenerated:"3 hours ago",nextUpdate:"In 21 hours",ocspStatus:"enabled",revokedCerts:12},{id:3,name:"Development Intermediate CA",crlStatus:"active",lastGenerated:"1 hour ago",nextUpdate:"In 23 hours",ocspStatus:"enabled",revokedCerts:8},{id:4,name:"ECDSA Root CA",crlStatus:"stale",lastGenerated:"3 days ago",nextUpdate:"Overdue",ocspStatus:"enabled",revokedCerts:1},{id:5,name:"Testing Root CA",crlStatus:"disabled",lastGenerated:"-",nextUpdate:"-",ocspStatus:"disabled",revokedCerts:0}],m=[{key:"name",label:"CA Name",sortable:!0,render:a=>e.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:"12px"},children:a.name})},{key:"crlStatus",label:"CRL Status",sortable:!0,render:a=>{const s={active:"success",stale:"warning",disabled:"info"},r={active:"Active",stale:"Stale",disabled:"Disabled"};return e.jsx(i,{variant:s[a.crlStatus],children:r[a.crlStatus]})}},{key:"lastGenerated",label:"Last Generated",sortable:!0},{key:"nextUpdate",label:"Next Update",sortable:!0},{key:"ocspStatus",label:"OCSP",sortable:!0,render:a=>{const s={enabled:"success",disabled:"info"},r={enabled:"Enabled",disabled:"Disabled"};return e.jsx(i,{variant:s[a.ocspStatus],children:r[a.ocspStatus]})}},{key:"revokedCerts",label:"Revoked Certs",sortable:!0},{key:"actions",label:"Actions",render:a=>e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.crlStatus!=="disabled"&&e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-arrows-clockwise",onClick:()=>u(a),disabled:d}),e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-download-simple",onClick:()=>p(a.id)})]}),a.crlStatus==="disabled"&&e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-gear",onClick:()=>console.log("Configure:",a)})]})}];return e.jsxs("div",{className:S.crlManagement,children:[e.jsx(b,{icon:"ph ph-list-checks",title:"CRL Management",badge:e.jsx(i,{variant:"success",children:"5 Active CAs"}),actions:e.jsxs(e.Fragment,{children:[e.jsx(t,{icon:"ph ph-arrows-clockwise",children:"Regenerate All"}),e.jsx(t,{icon:"ph ph-download-simple",children:"Export CRLs"})]})}),e.jsxs(C,{columns:4,children:[e.jsx(n,{value:"23",label:"CRLs Generated",icon:"ph ph-file-text"}),e.jsx(n,{value:"14,523",label:"OCSP Requests (24h)",icon:"ph ph-chart-line"}),e.jsx(n,{value:"5",label:"Active CAs",icon:"ph ph-certificate"}),e.jsx(n,{value:"12ms",label:"Avg Response Time",icon:"ph ph-timer"})]}),e.jsxs(l,{children:[e.jsxs(l.Header,{children:[e.jsx("h3",{children:"Certificate Authorities"}),e.jsx(t,{variant:"default",icon:"ph ph-funnel",children:"Filter"})]}),e.jsx(l.Body,{children:e.jsx(g,{columns:m,data:h,onRowClick:a=>console.log("CA clicked:",a),pageSize:10})})]})]})}export{M as CRLManagement,M as default};
