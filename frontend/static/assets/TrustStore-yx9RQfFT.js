import{e as S,z as h,j as e,B as a,C as c}from"./index-Cf_ZuWYu.js";import{P as m}from"./PageTopBar-CAXCwHUV.js";import{S as T,a as o}from"./StatsGrid-CG4860VJ.js";import{D as b}from"./DataTable-_euG_5M5.js";import{B as i}from"./Badge-D1tjk1ny.js";import{u as k}from"./useQuery-DAIbpIUi.js";import{u as A}from"./useMutation-B-n-Ya8e.js";import{a as d}from"./api-ClVrI7m4.js";const y={getTrustedCerts:async(s={})=>(await d.get("/api/v2/truststore",{params:s})).data,addTrustedCert:async s=>(await d.post("/api/v2/truststore",s)).data,removeTrustedCert:async s=>(await d.delete(`/api/v2/truststore/${s}`)).data},l={all:["truststore"],lists:()=>[...l.all,"list"],list:s=>[...l.lists(),s]},w=(s={})=>k({queryKey:l.list(s),queryFn:()=>y.getTrustedCerts(s)}),N=()=>{const s=S();return A({mutationFn:y.removeTrustedCert,onSuccess:()=>{s.invalidateQueries({queryKey:l.all}),h.success("Certificate removed from trust store")},onError:r=>{h.error(r.response?.data?.message||"Failed to remove certificate")}})},z="_trustStore_16j0j_1",x={trustStore:z};function P(){const{data:s,isLoading:r,error:u}=w(),j=N(),f=t=>t?new Date(t).toISOString().split("T")[0]:"N/A",p=(Array.isArray(s)?s:s?.data||[]).map(t=>({id:t.id,name:t.subject?.split(",")[0]?.replace("CN=","")||"Unknown",subject:t.subject||"N/A",fingerprint:t.fingerprint_sha256?.substring(0,20)+"..."||"N/A",validUntil:f(t.valid_until),usage:[t.purpose||"General"],autoTrusted:!1})),g=t=>{confirm(`Remove "${t.name}" from trust store?`)&&j.mutate(t.id)};if(u)return e.jsxs("div",{className:x.trustStore,children:[e.jsx(m,{icon:"ph ph-shield-check",title:"Trust Store",badge:e.jsx(i,{variant:"danger",children:"Error"})}),e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-danger)"},children:["Error loading trust store: ",u.message]})]});const v=[{key:"name",label:"Name",render:t=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"13px",color:"var(--text-primary)",marginBottom:"2px"},children:t.name}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-tertiary)"},children:t.subject})]})},{key:"fingerprint",label:"Fingerprint",render:t=>e.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:"11px",color:"var(--text-tertiary)"},children:t.fingerprint})},{key:"validUntil",label:"Valid Until"},{key:"usage",label:"Usage",render:t=>e.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:t.usage.map((n,C)=>e.jsx(i,{variant:"info",children:n},C))})},{key:"autoTrusted",label:"Auto-Trusted",render:t=>t.autoTrusted?e.jsxs(i,{variant:"success",children:[e.jsx("i",{className:"ph ph-check",style:{marginRight:"4px"}}),"Yes"]}):e.jsx("span",{style:{fontSize:"11px",color:"var(--text-tertiary)"},children:"No"})},{key:"actions",label:"Actions",render:t=>e.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"flex-end"},children:[e.jsx(a,{variant:"default",size:"sm",icon:"ph ph-eye",onClick:()=>console.log("View:",t)}),e.jsx(a,{variant:"default",size:"sm",icon:"ph ph-trash",onClick:n=>{n.stopPropagation(),g(t)}})]})}];return e.jsxs("div",{className:x.trustStore,children:[e.jsx(m,{icon:"ph ph-shield-check",title:"Trust Store",badge:e.jsxs(i,{variant:"success",children:[p.length," Trusted CAs"]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(a,{icon:"ph ph-arrows-clockwise",children:"Sync Trust Store"}),e.jsx(a,{variant:"primary",icon:"ph ph-plus",children:"Add CA"})]})}),e.jsxs(T,{columns:4,children:[e.jsx(o,{value:"12",label:"Trusted CAs",icon:"ph ph-certificate"}),e.jsx(o,{value:"45",label:"System Trust Store",icon:"ph ph-package"}),e.jsx(o,{value:"2 days ago",label:"Last Updated",icon:"ph ph-clock"}),e.jsx(o,{value:e.jsxs(i,{variant:"success",children:[e.jsx("i",{className:"ph ph-check-circle",style:{marginRight:"4px"}}),"Enabled"]}),label:"Auto-Sync Status",icon:"ph ph-arrows-clockwise"})]}),e.jsxs(c,{children:[e.jsxs(c.Header,{children:[e.jsx("h3",{children:"Trusted Certificate Authorities"}),e.jsx(a,{variant:"default",icon:"ph ph-funnel",children:"Filter"})]}),e.jsx(c.Body,{children:e.jsx(b,{columns:v,data:p,loading:r,onRowClick:t=>console.log("CA clicked:",t),pageSize:10})})]})]})}export{P as TrustStore,P as default};
