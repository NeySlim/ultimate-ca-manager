import{r as t,p as Z,j as e,c as w,B as S}from"./index-BLoiUdtC.js";import{I as h,D as R}from"./DataTable-B9vCmons.js";import{B as b}from"./Badge-CXgMz5pb.js";import{c as N}from"./Warning.es-Dg3eOOeZ.js";import{g as $}from"./getBadgeVariant-BF98r0-3.js";import{u as _}from"./useQuery-XSjwF2au.js";import{a as x}from"./api-ClVrI7m4.js";const k=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51ZM236,128A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),t.createElement("path",{d:"M173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34ZM232,128A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm45.66,85.66-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35a8,8,0,0,1,11.32,11.32Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M172.24,99.76a6,6,0,0,1,0,8.48l-56,56a6,6,0,0,1-8.48,0l-24-24a6,6,0,0,1,8.48-8.48L112,151.51l51.76-51.75A6,6,0,0,1,172.24,99.76ZM230,128A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34ZM232,128A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M170.83,101.17a4,4,0,0,1,0,5.66l-56,56a4,4,0,0,1-5.66,0l-24-24a4,4,0,0,1,5.66-5.66L112,154.34l53.17-53.17A4,4,0,0,1,170.83,101.17ZM228,128A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"}))]]),z=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm0,192a84,84,0,1,1,84-84A84.09,84.09,0,0,1,128,212Zm68-84a12,12,0,0,1-12,12H128a12,12,0,0,1-12-12V72a12,12,0,0,1,24,0v44h44A12,12,0,0,1,196,128Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),t.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm56,112H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48a8,8,0,0,1,0,16Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,26A102,102,0,1,0,230,128,102.12,102.12,0,0,0,128,26Zm0,192a90,90,0,1,1,90-90A90.1,90.1,0,0,1,128,218Zm62-90a6,6,0,0,1-6,6H128a6,6,0,0,1-6-6V72a6,6,0,0,1,12,0v50h50A6,6,0,0,1,190,128Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,28A100,100,0,1,0,228,128,100.11,100.11,0,0,0,128,28Zm0,192a92,92,0,1,1,92-92A92.1,92.1,0,0,1,128,220Zm60-92a4,4,0,0,1-4,4H128a4,4,0,0,1-4-4V72a4,4,0,0,1,8,0v52h52A4,4,0,0,1,188,128Z"}))]]),q=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M108,84a16,16,0,1,1,16,16A16,16,0,0,1,108,84Zm128,44A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Zm-72,36.68V132a20,20,0,0,0-20-20,12,12,0,0,0-4,23.32V168a20,20,0,0,0,20,20,12,12,0,0,0,4-23.32Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),t.createElement("path",{d:"M144,176a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176Zm88-48A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128ZM124,96a12,12,0,1,0-12-12A12,12,0,0,0,124,96Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm-4,48a12,12,0,1,1-12,12A12,12,0,0,1,124,72Zm12,112a16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40a8,8,0,0,1,0,16Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M142,176a6,6,0,0,1-6,6,14,14,0,0,1-14-14V128a2,2,0,0,0-2-2,6,6,0,0,1,0-12,14,14,0,0,1,14,14v40a2,2,0,0,0,2,2A6,6,0,0,1,142,176ZM124,94a10,10,0,1,0-10-10A10,10,0,0,0,124,94Zm106,34A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M140,176a4,4,0,0,1-4,4,12,12,0,0,1-12-12V128a4,4,0,0,0-4-4,4,4,0,0,1,0-8,12,12,0,0,1,12,12v40a4,4,0,0,0,4,4A4,4,0,0,1,140,176ZM124,92a8,8,0,1,0-8-8A8,8,0,0,0,124,92Zm104,36A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"}))]]),C=t.forwardRef((i,s)=>t.createElement(Z,{ref:s,...i,weights:k}));C.displayName="CheckCircleIcon";const D=C,M=t.forwardRef((i,s)=>t.createElement(Z,{ref:s,...i,weights:z}));M.displayName="ClockIcon";const B=M,I=t.forwardRef((i,s)=>t.createElement(Z,{ref:s,...i,weights:q}));I.displayName="InfoIcon";const G=I,K="_widget_noaw5_3",O="_widgetHeader_noaw5_19",U="_widgetTitle_noaw5_26",P="_widgetIcon_noaw5_34",J="_widgetValue_noaw5_40",Q="_gradient_noaw5_47",W="_warning_noaw5_54",X="_widgetSublabel_noaw5_58",Y="_statTrend_noaw5_65",ee="_positive_noaw5_73",te="_negative_noaw5_77",l={widget:K,widgetHeader:O,widgetTitle:U,widgetIcon:P,widgetValue:J,gradient:Q,warning:W,widgetSublabel:X,statTrend:Y,positive:ee,negative:te};function u({value:i,label:s,sublabel:c,icon:o,gradient:m=!0,trend:r,variant:d,cols:f=3,className:j}){const E=r?.positive??r?.direction==="up",A=r?.positive===!1||r?.direction==="down";return e.jsx("div",{className:w(l.widget,j),"data-cols":f,"data-variant":d,children:e.jsxs("div",{className:l.widgetHeader,children:[e.jsxs("div",{children:[e.jsx("div",{className:l.widgetTitle,children:s}),e.jsx("div",{className:w(l.widgetValue,m&&!d&&l.gradient,d&&l[d]),children:i}),c&&e.jsx("div",{className:l.widgetSublabel,children:c}),r&&e.jsxs("div",{className:w(l.statTrend,E&&l.positive,A&&l.negative),children:[r.direction==="up"&&e.jsx(h,{name:"ph ph-arrow-up",size:12}),r.direction==="down"&&e.jsx(h,{name:"ph ph-warning",size:12}),e.jsx("span",{children:r.text})]})]}),o&&e.jsx(h,{name:o,size:32,className:l.widgetIcon})]})})}const ae="_activityList_1a8o4_3",ie="_activityItem_1a8o4_9",se="_activityIcon_1a8o4_23",ne="_activityContent_1a8o4_34",re="_activityText_1a8o4_39",le="_activityUser_1a8o4_46",ce="_activityTime_1a8o4_50",g={activityList:ae,activityItem:ie,activityIcon:se,activityContent:ne,activityText:re,activityUser:le,activityTime:ce};function oe({icon:i,text:s,time:c,user:o,variant:m="default",gradient:r=!1}){const d={success:"success",warning:"warning",danger:"danger",info:"info"}[m];return e.jsxs("div",{className:g.activityItem,children:[e.jsx("div",{className:g.activityIcon,children:e.jsx(h,{name:i,size:14,gradient:r,color:!r&&d?d:void 0})}),e.jsxs("div",{className:g.activityContent,children:[e.jsxs("div",{className:g.activityText,children:[s,o&&e.jsxs("span",{className:g.activityUser,children:[" Â· ",o]})]}),e.jsx("div",{className:g.activityTime,children:c})]})]})}function de({items:i=[],className:s}){return e.jsx("div",{className:w(g.activityList,s),children:i.map((c,o)=>e.jsx(oe,{...c},o))})}const y={getOverview:async()=>{const s=(await x.get("/api/v2/stats/overview")).data;return[{label:"Certificate Authorities",value:String(s.total_cas||0),subtext:"Root & Intermediate"},{label:"Issued Certificates",value:String(s.total_certs||0),subtext:"Active certificates"},{label:"ACME Accounts",value:String(s.acme_accounts||0),subtext:"Registered accounts"},{label:"Active Users",value:String(s.active_users||0),subtext:"System users"}]},getStats:async()=>{const s=(await x.get("/api/v2/dashboard/stats")).data;return{activeCertificates:String(s.total_certificates||0),expiringSoon:String(s.expiring_soon||0),pendingRequests:"0",acmeRenewals:"0",totalCAs:String(s.total_cas||0),revoked:String(s.revoked||0)}},getActivity:async(i=20)=>(await x.get(`/api/v2/dashboard/activity?limit=${i}`)).data||[],getExpiringCerts:async(i=10)=>(await x.get(`/api/v2/dashboard/expiring-certs?limit=${i}`)).data||[]},v={all:["dashboard"],stats:()=>[...v.all,"stats"],overview:()=>[...v.all,"overview"],activity:i=>[...v.all,"activity",i],expiringCerts:i=>[...v.all,"expiring-certs",i]},ve=()=>_({queryKey:v.stats(),queryFn:y.getStats}),ge=()=>_({queryKey:v.overview(),queryFn:y.getOverview}),me=(i=20)=>_({queryKey:v.activity(i),queryFn:()=>y.getActivity(i)}),pe=(i=10)=>_({queryKey:v.expiringCerts(i),queryFn:()=>y.getExpiringCerts(i)}),xe="_dashboard_1lg19_3",ue="_widget_1lg19_10",we="_widgetSpan3_1lg19_19",he="_widgetSpan6_1lg19_23",_e="_widgetSpan12_1lg19_27",ye="_overviewGrid_1lg19_38",je="_overviewCard_1lg19_44",Ae="_overviewLabel_1lg19_53",be="_overviewValue_1lg19_59",Ze="_overviewSubtext_1lg19_66",fe="_alertsHeader_1lg19_78",Ee="_alertsGrid_1lg19_86",Se="_alertCard_1lg19_92",Ne="_alertIcon_1lg19_119",Ce="_alertText_1lg19_124",Me="_sectionHeader_1lg19_137",Ie="_sectionTitle_1lg19_145",a={dashboard:xe,widget:ue,widgetSpan3:we,widgetSpan6:he,widgetSpan12:_e,overviewGrid:ye,overviewCard:je,overviewLabel:Ae,overviewValue:be,overviewSubtext:Ze,alertsHeader:fe,alertsGrid:Ee,alertCard:Se,alertIcon:Ne,alertText:Ce,sectionHeader:Me,sectionTitle:Ie};function ke(){const{data:i,isLoading:s,error:c}=ve(),{data:o,isLoading:m,error:r}=ge(),{data:d,isLoading:f}=me(20),{data:j,isLoading:E}=pe(10),A=[{key:"name",label:"Certificate",sortable:!0,render:n=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"13px",color:"var(--text-primary)",marginBottom:"2px"},children:n.name}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-tertiary)",fontFamily:"JetBrains Mono, monospace"},children:n.fingerprint})]})},{key:"type",label:"Type",sortable:!0,render:n=>e.jsx(b,{variant:$("cert-type",n.type),children:n.type})},{key:"issuer",label:"Issuer",sortable:!0},{key:"expiresIn",label:"Expires In",sortable:!0,render:n=>{const V=n.daysLeft<=7?"error":"warning",H=n.daysLeft<=7?e.jsx(N,{size:14}):e.jsx(B,{size:14});return e.jsxs(b,{variant:V,children:[H,n.expiresIn]})}}];if(s||m)return e.jsx("div",{style:{padding:"var(--spacing-xl)",textAlign:"center"},children:e.jsx("div",{style:{fontSize:"14px",color:"var(--text-tertiary)"},children:"Loading dashboard..."})});if(c||r)return e.jsx("div",{style:{padding:"var(--spacing-xl)",textAlign:"center"},children:e.jsxs("div",{style:{fontSize:"14px",color:"var(--status-danger)"},children:["Error loading dashboard: ",c?.message||r?.message]})});const p=i||{activeCertificates:"0",expiringSoon:"0",pendingRequests:"0",acmeRenewals:"0"},T=o||[],L=d||[],F=j||[];return e.jsxs("div",{className:a.dashboard,children:[e.jsx("div",{className:a.widgetSpan3,children:e.jsx(u,{value:p.activeCertificates,label:"Active Certificates",icon:"certificate",trend:{direction:"up",text:"+12 this week",positive:!0},gradient:!0})}),e.jsx("div",{className:a.widgetSpan3,children:e.jsx(u,{value:p.expiringSoon,label:"Expiring Soon",sublabel:"Within 30 days",icon:"clock",trend:{direction:"down",text:"5 critical (7 days)",positive:!1},variant:"warning"})}),e.jsx("div",{className:a.widgetSpan3,children:e.jsx(u,{value:p.pendingRequests,label:"Pending Requests",sublabel:"CSRs awaiting approval",icon:"file-text",gradient:!0})}),e.jsx("div",{className:a.widgetSpan3,children:e.jsx(u,{value:p.acmeRenewals,label:"ACME Renewals",sublabel:"Last 30 days",icon:"globe",trend:{direction:"up",text:"100% success rate",positive:!0},gradient:!0})}),e.jsxs("div",{className:`${a.widget} ${a.widgetSpan6}`,children:[e.jsx("h2",{className:a.sectionTitle,children:"System Overview"}),e.jsx("div",{className:a.overviewGrid,children:T.map(n=>e.jsxs("div",{className:a.overviewCard,children:[e.jsx("div",{className:a.overviewLabel,children:n.label}),e.jsx("div",{className:a.overviewValue,children:n.value}),e.jsx("div",{className:a.overviewSubtext,children:n.subtext})]},n.label))})]}),e.jsxs("div",{className:`${a.widget} ${a.widgetSpan6}`,children:[e.jsxs("div",{className:a.alertsHeader,children:[e.jsx("h2",{className:a.sectionTitle,style:{marginBottom:0},children:"Alerts"}),e.jsx(b,{variant:"warning",children:"3"})]}),e.jsxs("div",{className:a.alertsGrid,children:[e.jsxs("div",{className:a.alertCard,"data-variant":"warning",children:[e.jsx(N,{size:18,className:a.alertIcon,style:{color:"var(--status-warning)"}}),e.jsxs("div",{className:a.alertText,children:["5 certs",e.jsx("br",{}),"expire soon"]})]}),e.jsxs("div",{className:a.alertCard,"data-variant":"info",children:[e.jsx(G,{size:18,className:a.alertIcon,style:{color:"var(--status-info)"}}),e.jsxs("div",{className:a.alertText,children:["8 CSRs",e.jsx("br",{}),"pending"]})]}),e.jsxs("div",{className:a.alertCard,"data-variant":"success",children:[e.jsx(D,{size:18,className:a.alertIcon,style:{color:"var(--status-success)"}}),e.jsxs("div",{className:a.alertText,children:["Backup",e.jsx("br",{}),"OK"]})]})]})]}),e.jsxs("div",{className:`${a.widget} ${a.widgetSpan12}`,style:{padding:0},children:[e.jsx("div",{style:{padding:"var(--spacing-lg)",paddingBottom:"var(--spacing-sm)"},children:e.jsxs("div",{className:a.sectionHeader,children:[e.jsx("h2",{className:a.sectionTitle,children:"Certificates Expiring Soon"}),e.jsxs(S,{variant:"secondary",children:["View All (",p.expiringSoon,")"]})]})}),e.jsx(R,{columns:A,data:F,onRowClick:n=>console.log("Certificate clicked:",n)})]}),e.jsxs("div",{className:`${a.widget} ${a.widgetSpan12}`,children:[e.jsxs("div",{className:a.sectionHeader,children:[e.jsx("h2",{className:a.sectionTitle,children:"Recent Activity"}),e.jsx(S,{variant:"secondary",onClick:()=>window.location.href="/activity",children:"View All"})]}),e.jsx(de,{items:L})]})]})}export{ke as Dashboard,ke as default};
