import{r as A,j as e,B as i,C as c}from"./index-BCBkwSf3.js";import{P as f}from"./PageTopBar-C4GfsMVo.js";import{S as E,a as p}from"./StatsGrid-C_bC4aUb.js";import{S as T,T as g}from"./SectionTabs-B7VKPpIN.js";import{D as N}from"./DataTable-UA39AICe.js";import{S as D}from"./SearchToolbar-Bmhq7q0L.js";import{B as x}from"./Badge-CdGCTdrv.js";import{I as h}from"./Input-DOXmUiMW.js";import{g as P}from"./getBadgeVariant-BF98r0-3.js";import{u as b}from"./useQuery-IYjj0EJ8.js";import{a as j}from"./api-ClVrI7m4.js";const v={getSettings:async()=>(await j.get("/api/v2/scep/config")).data,getStats:async()=>{const o=(await j.get("/api/v2/scep/requests")).data||[],u=o.filter(r=>r.status==="pending").length,d=o.filter(r=>r.status==="approved").length,m=o.filter(r=>r.status==="rejected").length;return{total_requests:o.length,pending:u,approved:d,rejected:m,total_enrollments:d}}},l={all:["scep"],settings:()=>[...l.all,"settings"],stats:()=>[...l.all,"stats"],requests:a=>[...l.all,"requests",a]},B=()=>b({queryKey:l.settings(),queryFn:v.getSettings}),w=()=>b({queryKey:l.stats(),queryFn:v.getStats}),q="_scepDashboard_rp4o0_3",R="_tabContent_rp4o0_8",I="_form_rp4o0_14",L="_checkboxGroup_rp4o0_21",O="_checkbox_rp4o0_21",F="_formActions_rp4o0_42",G="_actions_rp4o0_48",K="_statusBadge_rp4o0_53",V="_statusDot_rp4o0_67",H="_infoBox_rp4o0_78",Q="_infoContent_rp4o0_82",U="_infoIcon_rp4o0_87",z="_infoTitle_rp4o0_100",J="_infoText_rp4o0_107",s={scepDashboard:q,tabContent:R,form:I,checkboxGroup:L,checkbox:O,formActions:F,actions:G,statusBadge:K,statusDot:V,infoBox:H,infoContent:Q,infoIcon:U,infoTitle:z,infoText:J};function oe(){const[a,o]=A.useState("config"),{data:u,isLoading:d}=B(),{data:m,isLoading:r}=w(),y=d||r,t={config:u||{},stats:m||{},enrollments:[]},_=[{key:"deviceId",label:"Device ID",sortable:!0},{key:"commonName",label:"Common Name",sortable:!0},{key:"status",label:"Status",sortable:!0,render:n=>e.jsx(x,{variant:P("scep-status",n.status),children:n.status})},{key:"requestedAt",label:"Requested At",sortable:!0},{key:"approvedAt",label:"Approved At",render:n=>n.approvedAt||e.jsx("span",{style:{color:"var(--text-tertiary)"},children:"â€”"})},{key:"actions",label:"Actions",render:n=>n.status==="pending"?e.jsxs("div",{className:s.actions,children:[e.jsx(i,{variant:"success",icon:"ph ph-check",onClick:()=>console.log("Approve:",n),children:"Approve"}),e.jsx(i,{variant:"danger",icon:"ph ph-x",onClick:()=>console.log("Reject:",n),children:"Reject"})]}):null}],C=[{label:"Status",options:["All Statuses","Pending","Completed","Rejected"]}],S=[{label:"Export List",icon:"ph ph-download-simple",variant:"default"}];return y?e.jsxs("div",{className:s.scepDashboard,children:[e.jsx(f,{icon:"ph ph-device-mobile",title:"SCEP",badge:e.jsx(x,{variant:"secondary",children:"Loading..."})}),e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-tertiary)"},children:"Loading SCEP data..."})]}):e.jsxs("div",{className:s.scepDashboard,children:[e.jsx(f,{icon:"ph ph-device-mobile",title:"SCEP",badge:e.jsx(x,{variant:t.config.enabled?"success":"secondary",children:t.config.enabled?"Enabled":"Disabled"}),actions:e.jsxs(e.Fragment,{children:[e.jsx(i,{icon:"ph ph-arrows-clockwise",children:"Refresh"}),e.jsx(i,{variant:"primary",icon:"ph ph-gear",children:"Configure"})]})}),e.jsxs(E,{columns:4,children:[e.jsx(p,{value:t.stats.totalEnrollments,label:"Total Enrollments",icon:"ph ph-certificate"}),e.jsx(p,{value:t.stats.pendingApprovals,label:"Pending Approvals",icon:"ph ph-clock"}),e.jsx(p,{value:t.stats.completedToday,label:"Completed Today",icon:"ph ph-check-circle"}),e.jsx(p,{value:t.stats.rejectedToday,label:"Rejected Today",icon:"ph ph-x-circle"})]}),e.jsxs(T,{children:[e.jsx(g,{active:a==="config",onClick:()=>o("config"),children:"Configuration"}),e.jsx(g,{active:a==="enrollments",onClick:()=>o("enrollments"),children:"Enrollments"})]}),a==="config"&&e.jsxs("div",{className:s.tabContent,children:[e.jsxs(c,{children:[e.jsxs(c.Header,{children:[e.jsx("h3",{children:"SCEP Server Configuration"}),e.jsxs("div",{className:s.statusBadge,children:[e.jsx("span",{className:s.statusDot,"data-status":t.config.enabled?"enabled":"disabled"}),e.jsx("span",{children:t.config.enabled?"Enabled":"Disabled"})]})]}),e.jsx(c.Body,{children:e.jsxs("form",{className:s.form,children:[e.jsx(h,{label:"SCEP URL",value:t.config.url,readOnly:!0}),e.jsx(h,{label:"CA Identifier",value:t.config.caIdentifier,readOnly:!0}),e.jsx(h,{label:"Challenge Password",type:"password",value:t.config.challengePassword,readOnly:!0}),e.jsx(h,{label:"Certificate Validity (days)",value:t.config.certificateValidity,readOnly:!0}),e.jsxs("div",{className:s.checkboxGroup,children:[e.jsxs("label",{className:s.checkbox,children:[e.jsx("input",{type:"checkbox",checked:t.config.allowRenewal,readOnly:!0}),e.jsx("span",{children:"Allow Certificate Renewal"})]}),e.jsxs("label",{className:s.checkbox,children:[e.jsx("input",{type:"checkbox",checked:t.config.autoApprove,readOnly:!0}),e.jsx("span",{children:"Auto-Approve Enrollments"})]})]}),e.jsxs("div",{className:s.formActions,children:[e.jsx(i,{variant:"primary",icon:"ph ph-floppy-disk",children:"Save Configuration"}),e.jsx(i,{variant:"default",icon:"ph ph-arrow-clockwise",children:"Reset"})]})]})})]}),e.jsx(c,{className:s.infoBox,children:e.jsx(c.Body,{children:e.jsxs("div",{className:s.infoContent,children:[e.jsx("div",{className:s.infoIcon,children:e.jsx("i",{className:"ph ph-info"})}),e.jsxs("div",{children:[e.jsx("div",{className:s.infoTitle,children:"SCEP Enrollment"}),e.jsx("div",{className:s.infoText,children:"SCEP (Simple Certificate Enrollment Protocol) allows devices to automatically request and receive certificates. Common use cases include mobile devices (iOS, Android) and network equipment."})]})]})})})]}),a==="enrollments"&&e.jsxs("div",{className:s.tabContent,children:[e.jsx(D,{placeholder:"Search enrollments...",filters:C,actions:S,onSearch:n=>console.log("Search:",n),onFilterChange:(n,k)=>console.log("Filter:",n,k)}),e.jsx(N,{columns:_,data:t.enrollments,onRowClick:n=>console.log("Enrollment clicked:",n)})]})]})}export{oe as SCEPDashboard,oe as default};
