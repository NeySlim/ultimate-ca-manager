import{a as C,r as o,j as e,B as l,z as r}from"./index-DDkNXKZw.js";import{B as h}from"./Badge-h9qoOYEj.js";import{P as m}from"./PageTopBar-DLmCVWoC.js";import{S as T,T as c}from"./SectionTabs-6jS0MBQ-.js";import{u as w}from"./useQuery-cW_RYtSU.js";import{u as B}from"./useMutation-D3eOAgGd.js";import{a as j}from"./api-ClVrI7m4.js";const b={getGeneral:async()=>(await j.get("/api/v2/settings/general")).data,updateGeneral:async t=>(await j.patch("/api/v2/settings/general",t)).data},d={all:["settings"],general:()=>[...d.all,"general"],users:()=>[...d.all,"users"]},U=()=>w({queryKey:d.general(),queryFn:b.getGeneral}),_=()=>{const t=C();return B({mutationFn:b.updateGeneral,onSuccess:()=>{t.invalidateQueries({queryKey:d.general()})}})},L="_settings_rtspn_3",V="_tabContent_rtspn_17",P="_tabPanel_rtspn_22",A="_settingsSection_rtspn_29",O="_sectionTitle_rtspn_39",R="_formGroup_rtspn_48",D="_inputWithUnit_rtspn_99",s={settings:L,tabContent:V,tabPanel:P,settingsSection:A,sectionTitle:O,formGroup:R,inputWithUnit:D};function K(){const[t,a]=o.useState("system"),[v,f]=o.useState({}),[u,p]=o.useState(!1),{data:E,isLoading:y}=U(),{mutate:g}=_(),N=()=>{g(v,{onSuccess:()=>r.success("Settings saved successfully"),onError:i=>r.error(`Failed to save settings: ${i.message}`)})},k=async()=>{p(!0);try{const i=await fetch("/api/v2/system/backup",{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Backup failed");const G=await i.blob(),x=window.URL.createObjectURL(G),n=document.createElement("a");n.href=x,n.download=`ucm-backup-${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(x),document.body.removeChild(n),r.success("Backup created successfully")}catch{r.error("Failed to create backup")}finally{p(!1)}},S=()=>{window.confirm("Are you sure you want to reset all settings to default?")&&(f({}),r.success("Settings reset to default"))};return y?e.jsxs("div",{className:s.settings,children:[e.jsx(m,{icon:"ph ph-gear",title:"Settings",badge:e.jsx(h,{variant:"secondary",children:"Loading..."})}),e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-tertiary)"},children:"Loading settings..."})]}):e.jsxs("div",{className:s.settings,children:[e.jsx(m,{icon:"ph ph-gear",title:"Settings",badge:e.jsx(h,{variant:"warning",children:"Requires Restart"}),actions:e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"default",onClick:S,children:"Reset All"}),e.jsx(l,{variant:"primary",icon:"ph ph-floppy-disk",onClick:N,children:"Save Changes"})]})}),e.jsxs(T,{children:[e.jsx(c,{active:t==="system",onClick:()=>a("system"),children:"System"}),e.jsx(c,{active:t==="database",onClick:()=>a("database"),children:"Database"}),e.jsx(c,{active:t==="security",onClick:()=>a("security"),children:"Security"}),e.jsx(c,{active:t==="backup",onClick:()=>a("backup"),children:"Backup"})]}),e.jsxs("div",{className:s.tabContent,children:[t==="system"&&e.jsxs("div",{className:s.tabPanel,children:[e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"General"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Application Name"}),e.jsx("input",{type:"text",defaultValue:"UCM - Certificate Manager"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Application URL"}),e.jsx("input",{type:"text",defaultValue:"https://netsuit.lan.pew.pet:8443"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Timezone"}),e.jsxs("select",{children:[e.jsx("option",{children:"UTC"}),e.jsx("option",{children:"Europe/Paris"}),e.jsx("option",{children:"America/New_York"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Language"}),e.jsxs("select",{children:[e.jsx("option",{children:"English"}),e.jsx("option",{children:"Fran√ßais"})]})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Session"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Session Timeout"}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",defaultValue:"30"}),e.jsx("span",{children:"minutes"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Max Concurrent Sessions"}),e.jsx("input",{type:"number",defaultValue:"5"})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Logging"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Log Level"}),e.jsxs("select",{children:[e.jsx("option",{children:"Debug"}),e.jsx("option",{children:"Info"}),e.jsx("option",{children:"Warning"}),e.jsx("option",{children:"Error"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Log Retention"}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",defaultValue:"90"}),e.jsx("span",{children:"days"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Enable Audit Log"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]})]})]}),t==="database"&&e.jsxs("div",{className:s.tabPanel,children:[e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Database Configuration"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Database Type"}),e.jsx("input",{type:"text",defaultValue:"SQLite",readOnly:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Database Path"}),e.jsx("input",{type:"text",defaultValue:"/var/lib/ucm/ucm.db",readOnly:!0})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Database Maintenance"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Database Size"}),e.jsx("input",{type:"text",defaultValue:"142.5 MB",readOnly:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Fragmentation"}),e.jsx("input",{type:"text",defaultValue:"3.2%",readOnly:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Last Optimization"}),e.jsx("input",{type:"text",defaultValue:"2024-03-15 02:00 UTC",readOnly:!0})]}),e.jsx("div",{className:s.formGroup,children:e.jsx(l,{variant:"primary",icon:"ph ph-broom",children:"Optimize Database"})})]})]}),t==="security"&&e.jsxs("div",{className:s.tabPanel,children:[e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Password Policy"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Minimum Length"}),e.jsx("input",{type:"number",defaultValue:"12"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Require Uppercase"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Require Numbers"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Password Expiration"}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",defaultValue:"90"}),e.jsx("span",{children:"days"})]})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Authentication"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Max Failed Login Attempts"}),e.jsx("input",{type:"number",defaultValue:"5"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Account Lockout Duration"}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",defaultValue:"30"}),e.jsx("span",{children:"minutes"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Two-Factor Authentication"}),e.jsx("input",{type:"checkbox"})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"HTTPS Certificate"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Current Certificate"}),e.jsx("input",{type:"text",defaultValue:"CN=ucm.local",readOnly:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Valid Until"}),e.jsx("input",{type:"text",defaultValue:"2025-03-15",readOnly:!0})]}),e.jsx("div",{className:s.formGroup,children:e.jsx(l,{variant:"primary",icon:"ph ph-arrows-clockwise",children:"Regenerate Self-Signed"})})]})]}),t==="backup"&&e.jsxs("div",{className:s.tabPanel,children:[e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Automated Backup"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Enable Automated Backup"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Backup Schedule"}),e.jsxs("select",{children:[e.jsx("option",{children:"Daily at 03:00"}),e.jsx("option",{children:"Weekly on Sunday"}),e.jsx("option",{children:"Monthly on 1st"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Backup Retention"}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",defaultValue:"30"}),e.jsx("span",{children:"days"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Backup Location"}),e.jsx("input",{type:"text",defaultValue:"/var/backups/ucm/"})]})]}),e.jsxs("div",{className:s.settingsSection,children:[e.jsx("div",{className:s.sectionTitle,children:"Manual Backup"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Last Backup"}),e.jsx("input",{type:"text",defaultValue:"2024-03-15 03:00 UTC",readOnly:!0})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Backup Size"}),e.jsx("input",{type:"text",defaultValue:"245.3 MB",readOnly:!0})]}),e.jsx("div",{className:s.formGroup,children:e.jsx(l,{variant:"primary",icon:"ph ph-download-simple",onClick:k,disabled:u,children:u?"Creating Backup...":"Create Backup Now"})})]})]})]})]})}export{K as Settings,K as default};
