import{r as C,j as e,B as t,C as i,z as s}from"./index-DDkNXKZw.js";import{P as b}from"./PageTopBar-DLmCVWoC.js";import{S as f,a as n}from"./StatsGrid-BQ4NEOGC.js";import{D as g}from"./DataTable-SUMLdn_x.js";import{B as c}from"./Badge-h9qoOYEj.js";import{e as v}from"./export-BEFxFx9V.js";import{a as S}from"./api-ClVrI7m4.js";const R="_crlManagement_yal1l_1",j={crlManagement:R};function D(){const[p,d]=C.useState(!1),u=a=>{window.open(`/api/v2/crl/download/${a}`,"_blank"),s.success("CRL download started")},h=async a=>{if(confirm(`Regenerate CRL for ${a.name}? This may take a moment.`)){d(!0);try{await S.post(`/api/v2/crl/regenerate/${a.id}`),s.success("CRL regenerated successfully")}catch{s.error("Failed to regenerate CRL")}finally{d(!1)}}},m=()=>{if(l.length===0){s.error("No CRL data to export");return}v(l,"crls-export",{format:"csv",columns:["id","name","crlStatus","lastGenerated","nextUpdate","ocspStatus"]}),s.success("CRLs exported successfully")},l=[{id:1,name:"Internal Root CA",crlStatus:"active",lastGenerated:"2 hours ago",nextUpdate:"In 22 hours",ocspStatus:"enabled",revokedCerts:3},{id:2,name:"Production Intermediate CA",crlStatus:"active",lastGenerated:"3 hours ago",nextUpdate:"In 21 hours",ocspStatus:"enabled",revokedCerts:12},{id:3,name:"Development Intermediate CA",crlStatus:"active",lastGenerated:"1 hour ago",nextUpdate:"In 23 hours",ocspStatus:"enabled",revokedCerts:8},{id:4,name:"ECDSA Root CA",crlStatus:"stale",lastGenerated:"3 days ago",nextUpdate:"Overdue",ocspStatus:"enabled",revokedCerts:1},{id:5,name:"Testing Root CA",crlStatus:"disabled",lastGenerated:"-",nextUpdate:"-",ocspStatus:"disabled",revokedCerts:0}],x=[{key:"name",label:"CA Name",sortable:!0,render:a=>e.jsx("span",{style:{fontFamily:"var(--font-mono)",fontSize:"12px"},children:a.name})},{key:"crlStatus",label:"CRL Status",sortable:!0,render:a=>{const r={active:"success",stale:"warning",disabled:"info"},o={active:"Active",stale:"Stale",disabled:"Disabled"};return e.jsx(c,{variant:r[a.crlStatus],children:o[a.crlStatus]})}},{key:"lastGenerated",label:"Last Generated",sortable:!0},{key:"nextUpdate",label:"Next Update",sortable:!0},{key:"ocspStatus",label:"OCSP",sortable:!0,render:a=>{const r={enabled:"success",disabled:"info"},o={enabled:"Enabled",disabled:"Disabled"};return e.jsx(c,{variant:r[a.ocspStatus],children:o[a.ocspStatus]})}},{key:"revokedCerts",label:"Revoked Certs",sortable:!0},{key:"actions",label:"Actions",render:a=>e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.crlStatus!=="disabled"&&e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-arrows-clockwise",onClick:()=>h(a),disabled:p}),e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-download-simple",onClick:()=>u(a.id)})]}),a.crlStatus==="disabled"&&e.jsx(t,{variant:"default",size:"sm",icon:"ph ph-gear",onClick:()=>{window.location.href="/settings#crl",s.info("Redirecting to CRL configuration...")}})]})}];return e.jsxs("div",{className:j.crlManagement,children:[e.jsx(b,{icon:"ph ph-list-checks",title:"CRL Management",badge:e.jsx(c,{variant:"success",children:"5 Active CAs"}),actions:e.jsxs(e.Fragment,{children:[e.jsx(t,{icon:"ph ph-arrows-clockwise",children:"Regenerate All"}),e.jsx(t,{icon:"ph ph-download-simple",onClick:m,children:"Export CRLs"})]})}),e.jsxs(f,{columns:4,children:[e.jsx(n,{value:"23",label:"CRLs Generated",icon:"ph ph-file-text"}),e.jsx(n,{value:"14,523",label:"OCSP Requests (24h)",icon:"ph ph-chart-line"}),e.jsx(n,{value:"5",label:"Active CAs",icon:"ph ph-certificate"}),e.jsx(n,{value:"12ms",label:"Avg Response Time",icon:"ph ph-timer"})]}),e.jsxs(i,{children:[e.jsxs(i.Header,{children:[e.jsx("h3",{children:"Certificate Authorities"}),e.jsx(t,{variant:"default",icon:"ph ph-funnel",children:"Filter"})]}),e.jsx(i.Body,{children:e.jsx(g,{columns:x,data:l,onRowClick:a=>console.log("CA clicked:",a),pageSize:10})})]})]})}export{D as CRLManagement,D as default};
