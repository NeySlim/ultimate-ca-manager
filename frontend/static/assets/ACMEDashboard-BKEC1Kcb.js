import{r as F,j as e}from"./index-Bz_2fcyu.js";import{P as x}from"./PageTopBar-a3bUybbK.js";import{S as R,a as d}from"./StatsGrid-gcMqbLke.js";import{S as K,T as A}from"./SectionTabs-AMKrIILf.js";import{D as y}from"./DataTable-fm5UDvBu.js";import{S as B}from"./SearchToolbar--m3v_Uls.js";import{B as u}from"./Badge-BJVTH_dQ.js";import{g as v}from"./getBadgeVariant-BF98r0-3.js";import{u as p}from"./useQuery-DpPME6wH.js";import{a as l}from"./api-ClVrI7m4.js";import"./Input-Bf3XEq6Z.js";const m={getSettings:async()=>(await l.get("/api/v2/acme/settings")).data,updateSettings:async t=>(await l.patch("/api/v2/acme/settings",t)).data,getStats:async()=>{const a=(await l.get("/api/v2/acme/stats")).data||{};return{accounts:a.active_accounts||0,activeOrders:a.pending_orders||0,completedOrders:a.valid_orders||0,domains:0,_raw:a}},getAccounts:async(t={})=>{const a=await l.get("/api/v2/acme/accounts",{params:t}),i=(a.data||[]).map(s=>({id:s.id,email:s.email||s.contact_email||"N/A",status:(s.status||"ACTIVE").toUpperCase(),createdAt:s.created_at?s.created_at.split("T")[0]:"N/A",orders:s.total_orders||0,_raw:s}));return{data:i,meta:a.meta||{page:1,per_page:20,total:i.length}}},getOrders:async(t={})=>{const a=await l.get("/api/v2/acme/orders",{params:t}),i=(a.data||[]).map(s=>({id:s.id,domain:s.domain||s.identifier||"N/A",account:s.account_email||s.account_id||"N/A",status:(s.status||"PENDING").toUpperCase(),createdAt:s.created_at?s.created_at.split("T")[0]:"N/A",expiresAt:s.expires_at?s.expires_at.split("T")[0]:"N/A",_raw:s}));return{data:i,meta:a.meta||{page:1,per_page:20,total:i.length}}}},o={all:["acme"],settings:()=>[...o.all,"settings"],stats:()=>[...o.all,"stats"],accounts:t=>[...o.all,"accounts",t],orders:t=>[...o.all,"orders",t]},I=()=>p({queryKey:o.settings(),queryFn:m.getSettings}),P=()=>p({queryKey:o.stats(),queryFn:m.getStats}),V=(t={})=>p({queryKey:o.accounts(t),queryFn:()=>m.getAccounts(t)}),G=(t={})=>p({queryKey:o.orders(t),queryFn:()=>m.getOrders(t)}),U="_acmeDashboard_k0xpk_3",Q="_tabContent_k0xpk_8",z="_section_k0xpk_14",H="_sectionTitle_k0xpk_20",n={acmeDashboard:U,tabContent:Q,section:z,sectionTitle:H};function ce(){const[t,a]=F.useState("internal"),{data:i,isLoading:s,error:j}=I(),{data:J,isLoading:_,error:C}=P(),{data:S,isLoading:k,error:f}=V(),{data:E,isLoading:N,error:T}=G(),D=s||_||k||N,g=j||C||f||T,O=[{key:"email",label:"Email",sortable:!0},{key:"status",label:"Status",sortable:!0,render:r=>e.jsx(u,{variant:v("acme-status",r.status),children:r.status})},{key:"createdAt",label:"Created At",sortable:!0},{key:"orders",label:"Orders",sortable:!0,render:r=>e.jsx("span",{style:{color:"var(--text-tertiary)"},children:r.orders})}],w=[{key:"domain",label:"Domain",sortable:!0},{key:"account",label:"Account",sortable:!0},{key:"status",label:"Status",sortable:!0,render:r=>e.jsx(u,{variant:v("acme-status",r.status),children:r.status})},{key:"createdAt",label:"Created",sortable:!0},{key:"expiresAt",label:"Expires",sortable:!0}],M=[{label:"Status",options:["All Statuses","Valid","Pending","Invalid"]}],q=[{label:"New Account",icon:"ph ph-plus",variant:"primary"},{label:"New Order",icon:"ph ph-certificate",variant:"default"}];if(D)return e.jsxs("div",{className:n.acmeDashboard,children:[e.jsx(x,{icon:"ph ph-globe",title:"ACME",badge:e.jsx(u,{variant:"neutral",children:"Loading..."})}),e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading ACME data..."})]});if(g)return e.jsxs("div",{className:n.acmeDashboard,children:[e.jsx(x,{icon:"ph ph-globe",title:"ACME",badge:e.jsx(u,{variant:"danger",children:"Error"})}),e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-danger)"},children:["Error loading ACME data: ",g.message]})]});const h={accounts:S?.data||[],orders:E?.data||[]},b=(r,W)=>e.jsxs("div",{className:n.tabContent,children:[e.jsxs(R,{columns:4,children:[e.jsx(d,{value:r.stats.accounts,label:"Accounts",icon:"ph ph-user"}),e.jsx(d,{value:r.stats.activeOrders,label:"Active Orders",icon:"ph ph-clock"}),e.jsx(d,{value:r.stats.completedOrders,label:"Completed Orders",icon:"ph ph-check-circle"}),e.jsx(d,{value:r.stats.domains,label:"Domains",icon:"ph ph-globe"})]}),e.jsxs("div",{className:n.section,children:[e.jsx("h3",{className:n.sectionTitle,children:"Accounts"}),e.jsx(B,{placeholder:"Search accounts...",filters:M,actions:q,onSearch:c=>console.log("Search:",c),onFilterChange:(c,L)=>console.log("Filter:",c,L)}),e.jsx(y,{columns:O,data:r.accounts,onRowClick:c=>console.log("Account clicked:",c)})]}),e.jsxs("div",{className:n.section,children:[e.jsx("h3",{className:n.sectionTitle,children:"Recent Orders"}),e.jsx(y,{columns:w,data:r.orders,onRowClick:c=>console.log("Order clicked:",c)})]})]});return e.jsxs("div",{className:n.acmeDashboard,children:[e.jsxs(K,{children:[e.jsx(A,{active:t==="internal",onClick:()=>a("internal"),children:"Internal ACME"}),e.jsx(A,{active:t==="letsencrypt",onClick:()=>a("letsencrypt"),children:"Let's Encrypt"})]}),e.jsxs("div",{className:n.tabContent,children:[t==="internal"&&b(h.internal),t==="letsencrypt"&&b(h.letsencrypt)]})]})}export{ce as ACMEDashboard,ce as default};
