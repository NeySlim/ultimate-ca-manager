import{r as C,j as e,B as h,z as f}from"./index-BT4yjXpT.js";import{D as y}from"./DataTable-BuYkuw-y.js";import{B as N}from"./Badge-BGO5XS8W.js";import{P as S}from"./PageTopBar-DSQruy4T.js";import{P as L,a as p}from"./PillFilter-WzgW1drf.js";import{e as _}from"./export-BEFxFx9V.js";import{M as D}from"./Modal-BKZ7-FI9.js";import{I as j}from"./Input-vDpGvHxM.js";import{s as i}from"./CreateCAModal.module-DdQgTClK.js";function O({isOpen:c,onClose:m}){const[a,d]=C.useState({username:"",password:"",confirmPassword:"",email:"",fullName:"",role:"operator",permissions:{manageCAs:!1,issueCertificates:!0,revokeCertificates:!1,manageUsers:!1,viewLogs:!0,manageSettings:!1}}),[x,v]=C.useState(!1),b=async n=>{if(n.preventDefault(),!a.username||!a.password){f.error("Username and password are required");return}if(a.password!==a.confirmPassword){f.error("Passwords do not match");return}if(a.password.length<8){f.error("Password must be at least 8 characters");return}v(!0);try{const r=await fetch("/api/v2/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a.username,password:a.password,email:a.email,full_name:a.fullName,role:a.role,permissions:a.permissions})});if(!r.ok){const u=await r.json();throw new Error(u.message||"Failed to create user")}f.success("User created successfully"),m(),d({username:"",password:"",confirmPassword:"",email:"",fullName:"",role:"operator",permissions:{manageCAs:!1,issueCertificates:!0,revokeCertificates:!1,manageUsers:!1,viewLogs:!0,manageSettings:!1}}),window.location.reload()}catch(r){f.error(r.message||"Failed to create user")}finally{v(!1)}},l=n=>{d(r=>({...r,[n.target.name]:n.target.value}))},o=n=>{d(r=>({...r,permissions:{...r.permissions,[n]:!r.permissions[n]}}))},A=n=>{const r=n.target.value;let u={...a.permissions};r==="admin"?u={manageCAs:!0,issueCertificates:!0,revokeCertificates:!0,manageUsers:!0,viewLogs:!0,manageSettings:!0}:r==="operator"?u={manageCAs:!1,issueCertificates:!0,revokeCertificates:!1,manageUsers:!1,viewLogs:!0,manageSettings:!1}:r==="viewer"&&(u={manageCAs:!1,issueCertificates:!1,revokeCertificates:!1,manageUsers:!1,viewLogs:!0,manageSettings:!1}),d(w=>({...w,role:r,permissions:u}))},k=e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"secondary",onClick:m,disabled:x,children:"Cancel"}),e.jsx(h,{variant:"primary",onClick:b,disabled:x,children:x?"Creating...":"Create User"})]});return e.jsx(D,{isOpen:c,onClose:m,title:"Create User",size:"md",footer:k,children:e.jsxs("form",{onSubmit:b,className:i.form,children:[e.jsxs("div",{className:i.section,children:[e.jsx("h3",{className:i.sectionTitle,children:"Account Information"}),e.jsx(j,{label:"Username",name:"username",value:a.username,onChange:l,placeholder:"john.doe",required:!0}),e.jsx(j,{label:"Full Name",name:"fullName",value:a.fullName,onChange:l,placeholder:"John Doe"}),e.jsx(j,{label:"Email Address",name:"email",type:"email",value:a.email,onChange:l,placeholder:"john.doe@example.com"})]}),e.jsxs("div",{className:i.section,children:[e.jsx("h3",{className:i.sectionTitle,children:"Security"}),e.jsx(j,{label:"Password",name:"password",type:"password",value:a.password,onChange:l,placeholder:"••••••••",required:!0,helpText:"Minimum 8 characters"}),e.jsx(j,{label:"Confirm Password",name:"confirmPassword",type:"password",value:a.confirmPassword,onChange:l,placeholder:"••••••••",required:!0})]}),e.jsxs("div",{className:i.section,children:[e.jsx("h3",{className:i.sectionTitle,children:"Role & Permissions"}),e.jsxs("div",{className:i.field,children:[e.jsx("label",{className:i.label,children:"Role"}),e.jsxs("select",{name:"role",value:a.role,onChange:A,className:i.select,children:[e.jsx("option",{value:"admin",children:"Administrator"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsxs("p",{className:i.helpText,children:[a.role==="admin"&&"Full access to all features",a.role==="operator"&&"Can issue and manage certificates",a.role==="viewer"&&"Read-only access"]})]}),e.jsxs("div",{className:i.permissionsGrid,children:[e.jsxs("label",{className:i.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a.permissions.manageCAs,onChange:()=>o("manageCAs"),className:i.checkbox}),e.jsx("span",{children:"Manage CAs"})]}),e.jsxs("label",{className:i.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a.permissions.issueCertificates,onChange:()=>o("issueCertificates"),className:i.checkbox}),e.jsx("span",{children:"Issue Certificates"})]}),e.jsxs("label",{className:i.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a.permissions.revokeCertificates,onChange:()=>o("revokeCertificates"),className:i.checkbox}),e.jsx("span",{children:"Revoke Certificates"})]}),e.jsxs("label",{className:i.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a.permissions.manageUsers,onChange:()=>o("manageUsers"),className:i.checkbox}),e.jsx("span",{children:"Manage Users"})]}),e.jsxs("label",{className:i.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a.permissions.viewLogs,onChange:()=>o("viewLogs"),className:i.checkbox}),e.jsx("span",{children:"View Logs"})]}),e.jsxs("label",{className:i.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a.permissions.manageSettings,onChange:()=>o("manageSettings"),className:i.checkbox}),e.jsx("span",{children:"Manage Settings"})]})]})]})]})})}const P="_userList_96igz_3",U="_filtersSection_96igz_9",M="_filterGroup_96igz_21",R="_badge_96igz_35",V="_tableContainer_96igz_40",z="_userInfoCell_96igz_46",F="_userAvatar_96igz_52",T="_userDetails_96igz_66",I="_userName_96igz_72",J="_userEmail_96igz_78",E="_actionsCell_96igz_83",t={userList:P,filtersSection:U,filterGroup:M,badge:R,tableContainer:V,userInfoCell:z,userAvatar:F,userDetails:T,userName:I,userEmail:J,actionsCell:E};function Y(){const[c,m]=C.useState("All"),[a,d]=C.useState("All"),[x,v]=C.useState(!1),b=()=>{if(o.length===0){f.error("No data to export");return}_(o,"users-export",{format:"csv",columns:["id","name","email","role","status","lastLogin","created"]}),f.success("Users exported successfully")},l=[{id:1,name:"John Admin",initials:"JA",email:"admin@acme.com",role:"Admin",status:"Active",lastLogin:"2 min ago",created:"Jan 2020"},{id:2,name:"Alice Root",initials:"AR",email:"alice.root@acme.com",role:"Admin",status:"Active",lastLogin:"1 hour ago",created:"Mar 2020"},{id:3,name:"Security Team",initials:"ST",email:"security@acme.com",role:"Admin",status:"Active",lastLogin:"5 hours ago",created:"Jun 2021"},{id:4,name:"Bob Operator",initials:"BO",email:"bob.ops@acme.com",role:"Operator",status:"Active",lastLogin:"10 min ago",created:"Jan 2021"},{id:5,name:"Charlie Deploy",initials:"CD",email:"charlie@acme.com",role:"Operator",status:"Active",lastLogin:"30 min ago",created:"Feb 2021"},{id:6,name:"David Cert",initials:"DC",email:"david.cert@acme.com",role:"Operator",status:"Active",lastLogin:"2 hours ago",created:"Mar 2021"},{id:7,name:"Emma Manage",initials:"EM",email:"emma@acme.com",role:"Operator",status:"Active",lastLogin:"1 day ago",created:"Apr 2021"},{id:8,name:"Frank PKI",initials:"FP",email:"frank.pki@acme.com",role:"Operator",status:"Active",lastLogin:"2 days ago",created:"May 2021"},{id:9,name:"Grace Ops",initials:"GO",email:"grace@acme.com",role:"Operator",status:"Active",lastLogin:"3 days ago",created:"Jun 2021"},{id:10,name:"Henry Sysadmin",initials:"HS",email:"henry@acme.com",role:"Operator",status:"Disabled",lastLogin:"Never",created:"Jul 2021"},{id:11,name:"Iris Deploy",initials:"ID",email:"iris.deploy@acme.com",role:"Operator",status:"Active",lastLogin:"1 week ago",created:"Aug 2021"},{id:12,name:"Jack Viewer",initials:"JV",email:"jack.viewer@acme.com",role:"Viewer",status:"Active",lastLogin:"3 hours ago",created:"Jan 2022"},{id:13,name:"Karen Read",initials:"KR",email:"karen@acme.com",role:"Viewer",status:"Active",lastLogin:"1 day ago",created:"Feb 2022"},{id:14,name:"Leo Monitor",initials:"LM",email:"leo.monitor@acme.com",role:"Viewer",status:"Active",lastLogin:"2 days ago",created:"Mar 2022"},{id:15,name:"Mona Track",initials:"MT",email:"mona@acme.com",role:"Viewer",status:"Active",lastLogin:"3 days ago",created:"Apr 2022"},{id:16,name:"Nathan Log",initials:"NL",email:"nathan.log@acme.com",role:"Viewer",status:"Active",lastLogin:"4 days ago",created:"May 2022"},{id:17,name:"Olivia Audit",initials:"OA",email:"olivia@acme.com",role:"Viewer",status:"Active",lastLogin:"5 days ago",created:"Jun 2022"},{id:18,name:"Paul Check",initials:"PC",email:"paul.check@acme.com",role:"Viewer",status:"Active",lastLogin:"1 week ago",created:"Jul 2022"},{id:19,name:"Quinn Report",initials:"QR",email:"quinn@acme.com",role:"Viewer",status:"Active",lastLogin:"1 week ago",created:"Aug 2022"},{id:20,name:"Robert Stats",initials:"RS",email:"robert.stats@acme.com",role:"Viewer",status:"Active",lastLogin:"2 weeks ago",created:"Sep 2022"},{id:21,name:"Sara Inactive",initials:"SI",email:"sara@acme.com",role:"Viewer",status:"Disabled",lastLogin:"Never",created:"Oct 2022"},{id:22,name:"Tom Access",initials:"TA",email:"tom.access@acme.com",role:"Viewer",status:"Disabled",lastLogin:"Mar 2024",created:"Nov 2022"},{id:23,name:"Uma Review",initials:"UR",email:"uma@acme.com",role:"Viewer",status:"Active",lastLogin:"3 weeks ago",created:"Dec 2022"}],o=l.filter(s=>!(c!=="All"&&s.role!==c||a!=="All"&&s.status!==a)),A=l.filter(s=>s.role==="Admin").length,k=l.filter(s=>s.role==="Operator").length,n=l.filter(s=>s.role==="Viewer").length,r=l.filter(s=>s.status==="Active").length,u=l.filter(s=>s.status==="Disabled").length,w=[{key:"name",label:"User",render:s=>e.jsxs("div",{className:t.userInfoCell,children:[e.jsx("div",{className:t.userAvatar,children:s.initials}),e.jsxs("div",{className:t.userDetails,children:[e.jsx("div",{className:t.userName,children:s.name}),e.jsx("div",{className:t.userEmail,children:s.email})]})]})},{key:"role",label:"Role",render:s=>{const g=s.role==="Admin"?"error":s.role==="Operator"?"warning":"info";return e.jsx(N,{variant:g,children:s.role})}},{key:"status",label:"Status",render:s=>e.jsx(N,{variant:s.status==="Active"?"success":"error",children:s.status})},{key:"lastLogin",label:"Last Login"},{key:"created",label:"Created"},{key:"actions",label:"Actions",render:s=>e.jsxs("div",{className:t.actionsCell,children:[e.jsx(h,{variant:"default",size:"sm",icon:"ph ph-pencil-simple",onClick:g=>{g.stopPropagation(),console.log("Edit:",s)}}),e.jsx(h,{variant:"default",size:"sm",icon:"ph ph-prohibit",onClick:g=>{g.stopPropagation(),console.log("Disable:",s)}}),e.jsx(h,{variant:"default",size:"sm",icon:"ph ph-dots-three-outline-vertical",onClick:g=>{g.stopPropagation(),console.log("More:",s)}})]})}];return e.jsxs("div",{className:t.userList,children:[e.jsx(S,{icon:"ph ph-users",title:"Users",badge:e.jsxs(N,{variant:"info",children:[r," Active"]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"default",icon:"ph ph-upload-simple",children:"Import"}),e.jsx(h,{variant:"default",icon:"ph ph-download-simple",onClick:b,children:"Export"}),e.jsx(h,{variant:"primary",icon:"ph ph-plus",onClick:()=>v(!0),children:"Create User"})]})}),e.jsxs("div",{className:t.filtersSection,children:[e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{children:"Role"}),e.jsxs(L,{children:[e.jsxs(p,{active:c==="All",onClick:()=>m("All"),children:["All ",e.jsxs("span",{className:t.badge,children:["(",l.length,")"]})]}),e.jsxs(p,{active:c==="Admin",onClick:()=>m("Admin"),children:["Admin ",e.jsxs("span",{className:t.badge,children:["(",A,")"]})]}),e.jsxs(p,{active:c==="Operator",onClick:()=>m("Operator"),children:["Operator ",e.jsxs("span",{className:t.badge,children:["(",k,")"]})]}),e.jsxs(p,{active:c==="Viewer",onClick:()=>m("Viewer"),children:["Viewer ",e.jsxs("span",{className:t.badge,children:["(",n,")"]})]})]})]}),e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{children:"Status"}),e.jsxs(L,{children:[e.jsxs(p,{active:a==="All",onClick:()=>d("All"),children:["All ",e.jsxs("span",{className:t.badge,children:["(",l.length,")"]})]}),e.jsxs(p,{active:a==="Active",onClick:()=>d("Active"),children:["Active ",e.jsxs("span",{className:t.badge,children:["(",r,")"]})]}),e.jsxs(p,{active:a==="Disabled",onClick:()=>d("Disabled"),children:["Disabled ",e.jsxs("span",{className:t.badge,children:["(",u,")"]})]})]})]})]}),e.jsx("div",{className:t.tableContainer,children:e.jsx(y,{columns:w,data:o,onRowClick:s=>console.log("User clicked:",s),pageSize:10})}),e.jsx(O,{isOpen:x,onClose:()=>v(!1)})]})}export{Y as UserList,Y as default};
