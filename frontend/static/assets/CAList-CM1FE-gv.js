import{r as d,j as e,B as x}from"./index-CFAwig20.js";import{P as j}from"./PageTopBar-BSgaL0Fo.js";import{B as m}from"./Badge-CGzdQboG.js";import{u as T}from"./useQuery-C5GhzvIS.js";import{a as c}from"./api-ClVrI7m4.js";const E={getAll:async(n={})=>{const r=await c.get("/api/v2/cas",{params:n}),l=(r.data||[]).map(i=>{const h=new Date(i.valid_to)<new Date;return{id:i.id,name:i.common_name||"Unnamed CA",type:i.is_root?"Root":"Intermediate",status:h?"EXPIRED":"ACTIVE",issued:i.valid_from?i.valid_from.split("T")[0]:"N/A",expires:i.valid_to?i.valid_to.split("T")[0]:"N/A",certs:0,children:[],_raw:i}});return{data:l,meta:r.meta||{page:1,per_page:20,total:l.length}}},getById:async n=>(await c.get(`/api/v2/cas/${n}`)).data,create:async n=>(await c.post("/api/v2/cas",n)).data,update:async(n,r)=>(await c.patch(`/api/v2/cas/${n}`,r)).data,delete:async n=>(await c.delete(`/api/v2/cas/${n}`)).data},o={all:["cas"],lists:()=>[...o.all,"list"],list:n=>[...o.lists(),n],details:()=>[...o.all,"detail"],detail:n=>[...o.details(),n]},b=(n={})=>T({queryKey:o.list(n),queryFn:()=>E.getAll(n)}),B="_filtersSection_1nm9q_2",I="_filterGroup_1nm9q_13",q="_tableContainer_1nm9q_56",$="_caNameCell_1nm9q_99",D="_caExpandBtn_1nm9q_105",R="_collapsed_1nm9q_123",F="_noChildren_1nm9q_127",L="_caTreeIndent_1nm9q_132",H="_caIcon_1nm9q_160",P="_root_1nm9q_165",G="_intermediate_1nm9q_169",O="_orphan_1nm9q_173",U="_statusBadge_1nm9q_178",k="_actionsCell_1nm9q_201",V="_actionBtn_1nm9q_206",Y="_orphanedSection_1nm9q_231",K="_orphanedHeader_1nm9q_239",M="_orphanedHeaderText_1nm9q_253",Q="_orphanedTable_1nm9q_259",t={filtersSection:B,filterGroup:I,tableContainer:q,caNameCell:$,caExpandBtn:D,collapsed:R,noChildren:F,caTreeIndent:L,caIcon:H,root:P,intermediate:G,orphan:O,statusBadge:U,actionsCell:k,actionBtn:V,orphanedSection:Y,orphanedHeader:K,orphanedHeaderText:M,orphanedTable:Q};function ee(){const[n,r]=d.useState("all"),[l,i]=d.useState("all"),[u,_]=d.useState("name"),[h,g]=d.useState(""),[p,N]=d.useState(new Set),{data:S,isLoading:w,error:v}=b(),A=s=>{const a=new Set(p);a.has(s)?a.delete(s):a.add(s),N(a)};if(w)return e.jsxs("div",{className:t.caList,children:[e.jsx(j,{icon:"ph ph-bank",title:"Certificate Authorities",badge:e.jsx(m,{variant:"neutral",children:"Loading..."})}),e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading CAs..."})]});if(v)return e.jsxs("div",{className:t.caList,children:[e.jsx(j,{icon:"ph ph-bank",title:"Certificate Authorities",badge:e.jsx(m,{variant:"danger",children:"Error"})}),e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-danger)"},children:["Error loading CAs: ",v.message]})]});const C=S?.data||[],y=[],f=C.filter(s=>s.status==="ACTIVE").length;return e.jsxs("div",{className:t.caList,children:[e.jsx(j,{icon:"ph ph-bank",title:"Certificate Authorities",badge:e.jsxs(m,{variant:"success",children:[f," Active"]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(x,{icon:"ph ph-upload-simple",children:"Import"}),e.jsx(x,{icon:"ph ph-download-simple",children:"Export"}),e.jsx(x,{variant:"primary",icon:"ph ph-plus",children:"Create CA"})]})}),e.jsxs("div",{className:t.filtersSection,children:[e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{htmlFor:"type-filter",children:"TYPE"}),e.jsxs("select",{id:"type-filter",value:n,onChange:s=>r(s.target.value),children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"root",children:"Root"}),e.jsx("option",{value:"intermediate",children:"Intermediate"})]})]}),e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{htmlFor:"status-filter",children:"STATUS"}),e.jsxs("select",{id:"status-filter",value:l,onChange:s=>i(s.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:t.filterGroup,children:[e.jsx("label",{htmlFor:"sort-filter",children:"SORT BY"}),e.jsxs("select",{id:"sort-filter",value:u,onChange:s=>_(s.target.value),children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"issued",children:"Issued Date"}),e.jsx("option",{value:"expires",children:"Expires Date"})]})]}),e.jsx("div",{style:{flex:1}}),e.jsx("div",{className:t.filterGroup,children:e.jsx("input",{type:"text",id:"search-filter",placeholder:"Search CAs...",value:h,onChange:s=>g(s.target.value)})})]}),e.jsx("div",{className:t.tableContainer,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"35%"},children:"NAME"}),e.jsx("th",{style:{width:"15%"},children:"TYPE"}),e.jsx("th",{style:{width:"12%"},children:"STATUS"}),e.jsx("th",{style:{width:"12%"},children:"ISSUED"}),e.jsx("th",{style:{width:"12%"},children:"EXPIRES"}),e.jsx("th",{style:{width:"8%"},children:"CERTS"}),e.jsx("th",{style:{width:"6%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:C.map(s=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:t.caNameCell,children:[e.jsx("button",{className:`${t.caExpandBtn} ${s.children?"":t.noChildren} ${p.has(s.id)?"":t.collapsed}`,onClick:()=>s.children&&A(s.id),children:e.jsx("i",{className:"ph ph-caret-down"})}),e.jsx("i",{className:`ph ph-bank ${t.caIcon} ${t.root}`}),e.jsx("span",{children:s.name})]})}),e.jsx("td",{children:e.jsx("span",{children:s.type})}),e.jsx("td",{children:e.jsx("span",{className:`${t.statusBadge} ${s.status.toLowerCase()}`,children:s.status})}),e.jsx("td",{children:s.issued}),e.jsx("td",{children:s.expires}),e.jsx("td",{children:s.certs}),e.jsx("td",{children:e.jsx("div",{className:t.actionsCell,children:e.jsx("button",{className:t.actionBtn,title:"View",children:e.jsx("i",{className:"ph ph-eye"})})})})]},s.id),s.children&&p.has(s.id)&&s.children.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:t.caTreeIndent,children:[e.jsx("i",{className:`ph ph-git-branch ${t.caIcon} ${t.intermediate}`}),e.jsx("span",{children:a.name})]})}),e.jsx("td",{children:e.jsx("span",{children:a.type})}),e.jsx("td",{children:e.jsx("span",{className:`${t.statusBadge} ${a.status.toLowerCase()}`,children:a.status})}),e.jsx("td",{children:a.issued}),e.jsx("td",{children:a.expires}),e.jsx("td",{children:a.certs}),e.jsx("td",{children:e.jsx("div",{className:t.actionsCell,children:e.jsx("button",{className:t.actionBtn,title:"View",children:e.jsx("i",{className:"ph ph-eye"})})})})]},a.id))]}))})]})}),y.length>0&&e.jsxs("div",{className:t.orphanedSection,children:[e.jsxs("div",{className:t.orphanedHeader,children:[e.jsx("i",{className:"ph ph-warning"}),e.jsx("span",{className:t.orphanedHeaderText,children:"Orphaned Intermediate CAs"})]}),e.jsx("div",{className:t.orphanedTable,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"35%"},children:"NAME"}),e.jsx("th",{style:{width:"15%"},children:"TYPE"}),e.jsx("th",{style:{width:"12%"},children:"STATUS"}),e.jsx("th",{style:{width:"12%"},children:"ISSUED"}),e.jsx("th",{style:{width:"12%"},children:"EXPIRES"}),e.jsx("th",{style:{width:"8%"},children:"CERTS"}),e.jsx("th",{style:{width:"6%"},children:"ACTIONS"})]})}),e.jsx("tbody",{children:y.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:t.caNameCell,children:[e.jsx("i",{className:`ph ph-warning ${t.caIcon} ${t.orphan}`}),e.jsx("span",{children:s.name})]})}),e.jsx("td",{children:e.jsx("span",{children:s.type})}),e.jsx("td",{children:e.jsx("span",{className:`${t.statusBadge} ${s.status.toLowerCase()}`,children:s.status})}),e.jsx("td",{children:s.issued}),e.jsx("td",{children:s.expires}),e.jsx("td",{children:s.certs}),e.jsx("td",{children:e.jsx("div",{className:t.actionsCell,children:e.jsx("button",{className:t.actionBtn,title:"View",children:e.jsx("i",{className:"ph ph-eye"})})})})]},s.id))})]})})]})]})}export{ee as CAList,ee as default};
