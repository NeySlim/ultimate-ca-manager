import{j as e}from"./radix-B6Y-MRu0.js";import{a as s}from"./vendor-DEQSVNfj.js";import{m as ve,C as Ne,a as we,e as Ce,b as ne,c as Le,d as T}from"./DetailCard-BKBzFg8i.js";import{a as Me}from"./PencilSimple.es-CJefJBPq.js";import{n as W}from"./Plus.es-DN9hvW10.js";import{G as Se,Q as Ae,q as Ee,d as p,u as ze,B as A,A as le,c as ke,a as G,C as De,z as Q,I as ie,n as ce,x as Ge,s as Pe}from"./index-vswyqp58.js";import{n as oe}from"./Trash.es-DhgoD9TD.js";import{p as J,g as de,l as me}from"./ui-bTlm5Mct.js";import{M as xe}from"./Modal-7_eTIvz3.js";import{B as K}from"./Badge-CZ5NzBfK.js";import{H as pe}from"./HelpCard-BINCqYIf.js";import{H as ue}from"./HelpModal-BnkmCwhU.js";import{E as he}from"./EmptyState-B4dAc_K5.js";import{s as fe,a as $e}from"./CaretUp.es-CYK8cpGg.js";import{s as X}from"./CaretRight.es-B3hFfvz_.js";import{s as He}from"./CaretDown.es-DuThAI6u.js";import{u as _e}from"./useCommon-lRatzZ8x.js";import{default as Mt}from"./RBACPage-dM9QpF_a.js";import{default as At}from"./SSOPage-BMsu7Pz7.js";import{default as zt}from"./HSMPage-C9Pw6E8M.js";import{S as Dt,p as Gt}from"./settings-DbRG-wdj.js";import"./Globe.es-CtUoIY1T.js";import"./Fingerprint.es-a52JDt2Q.js";import"./UnifiedManagementLayout-Wib7G_7r.js";import"./ResponsiveDataTable-kYvH3TtM.js";import"./UnifiedPageHeader-Cbwye_R6.js";import"./ArrowLeft.es-CZcTzWfI.js";import"./ArrowsClockwise.es-DS70dwCP.js";import"./Lightning.es-C-Sz8AXK.js";import"./TestTube.es-BJzbVb1c.js";import"./PageLayout-Dh0KLD48.js";import"./Select-PwXyFoxR.js";import"./Textarea-DuI5mbE0.js";const Re=new Map([["bold",s.createElement(s.Fragment,null,s.createElement("path",{d:"M243,96a20.33,20.33,0,0,0-17.74-14l-56.59-4.57L146.83,24.62a20.36,20.36,0,0,0-37.66,0L87.35,77.44,30.76,82A20.45,20.45,0,0,0,19.1,117.88l43.18,37.24-13.2,55.7A20.37,20.37,0,0,0,79.57,233L128,203.19,176.43,233a20.39,20.39,0,0,0,30.49-22.15l-13.2-55.7,43.18-37.24A20.43,20.43,0,0,0,243,96ZM172.53,141.7a12,12,0,0,0-3.84,11.86L181.58,208l-47.29-29.08a12,12,0,0,0-12.58,0L74.42,208l12.89-54.4a12,12,0,0,0-3.84-11.86L41.2,105.24l55.4-4.47a12,12,0,0,0,10.13-7.38L128,41.89l21.27,51.5a12,12,0,0,0,10.13,7.38l55.4,4.47Z"}))],["duotone",s.createElement(s.Fragment,null,s.createElement("path",{d:"M229.06,108.79l-48.7,42,14.88,62.79a8.4,8.4,0,0,1-12.52,9.17L128,189.09,73.28,222.74a8.4,8.4,0,0,1-12.52-9.17l14.88-62.79-48.7-42A8.46,8.46,0,0,1,31.73,94L95.64,88.8l24.62-59.6a8.36,8.36,0,0,1,15.48,0l24.62,59.6L224.27,94A8.46,8.46,0,0,1,229.06,108.79Z",opacity:"0.2"}),s.createElement("path",{d:"M239.18,97.26A16.38,16.38,0,0,0,224.92,86l-59-4.76L143.14,26.15a16.36,16.36,0,0,0-30.27,0L90.11,81.23,31.08,86a16.46,16.46,0,0,0-9.37,28.86l45,38.83L53,211.75a16.38,16.38,0,0,0,24.5,17.82L128,198.49l50.53,31.08A16.4,16.4,0,0,0,203,211.75l-13.76-58.07,45-38.83A16.43,16.43,0,0,0,239.18,97.26Zm-15.34,5.47-48.7,42a8,8,0,0,0-2.56,7.91l14.88,62.8a.37.37,0,0,1-.17.48c-.18.14-.23.11-.38,0l-54.72-33.65a8,8,0,0,0-8.38,0L69.09,215.94c-.15.09-.19.12-.38,0a.37.37,0,0,1-.17-.48l14.88-62.8a8,8,0,0,0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16A8,8,0,0,0,103,91.86l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153,91.86a8,8,0,0,0,6.75,4.92l63.92,5.16c.15,0,.24,0,.33.29S224,102.63,223.84,102.73Z"}))],["fill",s.createElement(s.Fragment,null,s.createElement("path",{d:"M234.29,114.85l-45,38.83L203,211.75a16.4,16.4,0,0,1-24.5,17.82L128,198.49,77.47,229.57A16.4,16.4,0,0,1,53,211.75l13.76-58.07-45-38.83A16.46,16.46,0,0,1,31.08,86l59-4.76,22.76-55.08a16.36,16.36,0,0,1,30.27,0l22.75,55.08,59,4.76a16.46,16.46,0,0,1,9.37,28.86Z"}))],["light",s.createElement(s.Fragment,null,s.createElement("path",{d:"M237.28,97.87A14.18,14.18,0,0,0,224.76,88l-60.25-4.87-23.22-56.2a14.37,14.37,0,0,0-26.58,0L91.49,83.11,31.24,88a14.18,14.18,0,0,0-12.52,9.89A14.43,14.43,0,0,0,23,113.32L69,152.93l-14,59.25a14.4,14.4,0,0,0,5.59,15,14.1,14.1,0,0,0,15.91.6L128,196.12l51.58,31.71a14.1,14.1,0,0,0,15.91-.6,14.4,14.4,0,0,0,5.59-15l-14-59.25L233,113.32A14.43,14.43,0,0,0,237.28,97.87Zm-12.14,6.37-48.69,42a6,6,0,0,0-1.92,5.92l14.88,62.79a2.35,2.35,0,0,1-.95,2.57,2.24,2.24,0,0,1-2.6.1L131.14,184a6,6,0,0,0-6.28,0L70.14,217.61a2.24,2.24,0,0,1-2.6-.1,2.35,2.35,0,0,1-1-2.57l14.88-62.79a6,6,0,0,0-1.92-5.92l-48.69-42a2.37,2.37,0,0,1-.73-2.65,2.28,2.28,0,0,1,2.07-1.65l63.92-5.16a6,6,0,0,0,5.06-3.69l24.63-59.6a2.35,2.35,0,0,1,4.38,0l24.63,59.6a6,6,0,0,0,5.06,3.69l63.92,5.16a2.28,2.28,0,0,1,2.07,1.65A2.37,2.37,0,0,1,225.14,104.24Z"}))],["regular",s.createElement(s.Fragment,null,s.createElement("path",{d:"M239.18,97.26A16.38,16.38,0,0,0,224.92,86l-59-4.76L143.14,26.15a16.36,16.36,0,0,0-30.27,0L90.11,81.23,31.08,86a16.46,16.46,0,0,0-9.37,28.86l45,38.83L53,211.75a16.38,16.38,0,0,0,24.5,17.82L128,198.49l50.53,31.08A16.4,16.4,0,0,0,203,211.75l-13.76-58.07,45-38.83A16.43,16.43,0,0,0,239.18,97.26Zm-15.34,5.47-48.7,42a8,8,0,0,0-2.56,7.91l14.88,62.8a.37.37,0,0,1-.17.48c-.18.14-.23.11-.38,0l-54.72-33.65a8,8,0,0,0-8.38,0L69.09,215.94c-.15.09-.19.12-.38,0a.37.37,0,0,1-.17-.48l14.88-62.8a8,8,0,0,0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16A8,8,0,0,0,103,91.86l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153,91.86a8,8,0,0,0,6.75,4.92l63.92,5.16c.15,0,.24,0,.33.29S224,102.63,223.84,102.73Z"}))],["thin",s.createElement(s.Fragment,null,s.createElement("path",{d:"M235.36,98.49A12.21,12.21,0,0,0,224.59,90l-61.47-5L139.44,27.67a12.37,12.37,0,0,0-22.88,0L92.88,85,31.41,90a12.45,12.45,0,0,0-7.07,21.84l46.85,40.41L56.87,212.64a12.35,12.35,0,0,0,18.51,13.49L128,193.77l52.62,32.36a12.12,12.12,0,0,0,13.69-.51,12.28,12.28,0,0,0,4.82-13l-14.32-60.42,46.85-40.41A12.29,12.29,0,0,0,235.36,98.49Zm-8.93,7.26-48.68,42a4,4,0,0,0-1.28,3.95l14.87,62.79a4.37,4.37,0,0,1-1.72,4.65,4.24,4.24,0,0,1-4.81.18L130.1,185.67a4,4,0,0,0-4.2,0L71.19,219.32a4.24,4.24,0,0,1-4.81-.18,4.37,4.37,0,0,1-1.72-4.65L79.53,151.7a4,4,0,0,0-1.28-3.95l-48.68-42A4.37,4.37,0,0,1,28.25,101a4.31,4.31,0,0,1,3.81-3L96,92.79a4,4,0,0,0,3.38-2.46L124,30.73a4.35,4.35,0,0,1,8.08,0l24.62,59.6A4,4,0,0,0,160,92.79l63.9,5.15a4.31,4.31,0,0,1,3.81,3A4.37,4.37,0,0,1,226.43,105.75Z"}))]]),ge=s.forwardRef((n,i)=>s.createElement(Se,{ref:i,...n,weights:Re}));ge.displayName="StarIcon";const Fe=ge,V=56;function Oe({open:n,onOpenChange:i,title:b,children:u,snapPoints:c=["25%","50%","90%"],defaultSnap:x=1}){const[l,o]=s.useState(n?x:-1),[d,m]=s.useState(!1),[j,v]=s.useState(0),E=s.useRef(null),h=s.useRef(0),N=s.useRef(0),y=s.useRef(!1);s.useEffect(()=>{n&&l===-1?o(x):!n&&l!==-1&&o(-1)},[n,x]);const f=t=>{if(t===-1)return V;const a=c[t];return typeof a=="string"&&a.endsWith("%")?parseInt(a)/100*window.innerHeight:parseInt(a)},L=f(l)-j,M=l!==-1,U=t=>{m(!0),y.current=!1,h.current=t.touches?t.touches[0].clientY:t.clientY,N.current=L},P=t=>{if(!d)return;const z=(t.touches?t.touches[0].clientY:t.clientY)-h.current;Math.abs(z)>5&&(y.current=!0);const C=N.current-V,Z=-(window.innerHeight*.9-N.current);v(Math.max(Z,Math.min(C,z)))},w=()=>{const t=d&&y.current;if(m(!1),!t){v(0);return}const a=L;let z=-1,C=Math.abs(V-a);c.forEach((Z,B)=>{const Y=f(B),R=Math.abs(Y-a);R<C&&(C=R,z=B)}),o(z),i(z!==-1),v(0)},$=()=>{M||(o(x),i(!0))},S=()=>{o(-1),i(!1)},H=t=>{t==="up"?l===-1?(o(0),i(!0)):o(Math.min(l+1,c.length-1)):l===0?S():l>0&&o(l-1)};return e.jsxs(e.Fragment,{children:[M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 transition-opacity",onClick:S}),e.jsxs("div",{ref:E,className:p("fixed left-0 right-0 bottom-0 z-50 bg-bg-secondary rounded-t-xl shadow-2xl flex flex-col",!d&&"transition-all duration-200"),style:{height:Math.max(V,L)},children:[e.jsxs("div",{className:p("flex-shrink-0",!M&&"bg-bg-tertiary cursor-pointer active:bg-bg-secondary"),onClick:M?void 0:$,children:[e.jsx("div",{className:"cursor-grab active:cursor-grabbing touch-none",onMouseDown:U,onMouseMove:P,onMouseUp:w,onMouseLeave:()=>d&&w(),onTouchStart:U,onTouchMove:P,onTouchEnd:w,children:e.jsx("div",{className:"pt-2 pb-1",children:e.jsx("div",{className:"w-10 h-1 bg-border rounded-full mx-auto"})})}),e.jsxs("div",{className:"flex items-center justify-between px-4 h-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{size:18,className:"text-text-secondary"}),e.jsx("span",{className:"text-sm font-semibold text-text-primary tracking-wide",children:b})]}),e.jsx("div",{className:"flex items-center gap-1",children:M?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),H("up")},className:"w-7 h-7 flex items-center justify-center rounded text-text-secondary hover:bg-bg-primary/50",disabled:l===c.length-1,children:e.jsx(fe,{size:16})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),H("down")},className:"w-7 h-7 flex items-center justify-center rounded text-text-secondary hover:bg-bg-primary/50",children:e.jsx(He,{size:16})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),S()},className:"w-7 h-7 flex items-center justify-center rounded text-text-secondary hover:bg-bg-primary/50 ml-1",children:e.jsx(Ee,{size:16})})]}):e.jsx(fe,{size:18,className:"text-text-tertiary"})})]})]}),M&&e.jsx("div",{className:"flex-1 overflow-auto min-h-0 border-t border-border",children:u})]})]})}function Te({title:n,tabs:i,activeTab:b,onTabChange:u,items:c=[],loading:x=!1,selectedItem:l,onSelectItem:o,idKey:d="id",itemIcon:m,itemTitle:j,itemSubtitle:v,itemBadge:E,renderItem:h,renderDetails:N,detailsTitle:y,onCreate:f,createLabel:L="Create",onEdit:M,onDelete:U,searchable:P=!0,searchPlaceholder:w="Search...",searchKeys:$=["name"],helpContent:S,helpTitle:H,emptyIcon:t,emptyTitle:a="No items",emptyDescription:z="Create your first item to get started",itemName:C="item",className:Z}){const{isMobile:B}=ze(),[Y,R]=s.useState(!1),[k,te]=s.useState(""),[I,be]=s.useState(!0),F=c.filter(r=>{if(!k)return!0;const g=k.toLowerCase();return $.some(D=>{const _=r[D];return _&&String(_).toLowerCase().includes(g)})}),se=()=>S?e.jsxs("button",{onClick:()=>R(!0),className:p("flex items-center gap-1.5 px-2.5 py-1.5 rounded-md transition-all duration-200","bg-accent-primary/10 border border-accent-primary/30","text-accent-primary hover:bg-accent-primary/20 hover:border-accent-primary/50","text-xs font-medium"),title:me.helpAndInfo,children:[e.jsx(ve,{size:14,weight:"bold"}),e.jsx("span",{children:me.help})]}):null,re=i?.length>0?e.jsx("div",{className:"flex gap-1 ml-4",children:i.map(r=>{const g=r.icon,D=b===r.id;return e.jsxs("button",{onClick:()=>u?.(r.id),className:p("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-md transition-colors",D?"bg-accent-primary/15 text-accent-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-tertiary"),children:[g&&e.jsx(g,{size:14}),r.label,r.pro&&e.jsx(K,{variant:"info",size:"sm",children:"Pro"})]},r.id)})}):null,je=(r,g)=>{const D=m,_=j?j(r):r.name,q=v?v(r):null,O=E?E(r):null;return e.jsxs("button",{onClick:()=>o?.(r),className:p("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-150","text-left group",g?"bg-accent-primary/15 border border-accent-primary/30":"hover:bg-bg-tertiary/80 border border-transparent"),children:[D&&e.jsx("div",{className:p("w-9 h-9 rounded-lg flex items-center justify-center shrink-0",g?"bg-accent-primary/20":"bg-bg-tertiary"),children:e.jsx(D,{size:18,className:g?"text-accent-primary":"text-text-secondary",weight:"duotone"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:p("text-sm font-medium truncate",g?"text-accent-primary":"text-text-primary"),children:_}),q&&e.jsx("p",{className:"text-xs text-text-tertiary truncate mt-0.5",children:q})]}),O,e.jsx(X,{size:14,className:p("shrink-0 transition-transform",g?"text-accent-primary":"text-text-tertiary","group-hover:translate-x-0.5")})]})},ye=e.jsxs("div",{className:"flex flex-col h-full",children:[f&&e.jsx("div",{className:"p-3 border-b border-border shrink-0",children:e.jsxs(A,{onClick:f,size:"sm",className:"w-full",children:[e.jsx(W,{size:16}),L]})}),P&&e.jsx("div",{className:"p-3 border-b border-border shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:w,value:k,onChange:r=>te(r.target.value),className:p("w-full pl-8 pr-3 py-2 text-sm rounded-md","bg-bg-tertiary border border-border","text-text-primary placeholder:text-text-tertiary","focus:outline-none focus:ring-1 focus:ring-accent-primary focus:border-accent-primary")})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-2",children:x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-6 h-6 border-2 border-accent-primary/30 border-t-accent-primary rounded-full animate-spin"})}):F.length===0?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-text-tertiary",children:k?"No matching items":a})}):e.jsx("div",{className:"space-y-1",children:F.map(r=>e.jsx("div",{children:h?h(r,l?.[d]===r[d]):je(r,l?.[d]===r[d])},r[d]))})}),e.jsx("div",{className:"px-3 py-2 border-t border-border text-xs text-text-tertiary shrink-0",children:J(F.length,C)})]}),ae=l?N?.(l):e.jsx(he,{icon:t||m,title:`Select ${C}`,description:`Choose ${C==="item"?"an item":`a ${C}`} from the list to view details`});return B?e.jsxs("div",{className:p("flex flex-col h-full w-full",Z),children:[e.jsx("div",{className:"px-4 py-3 border-b border-border bg-bg-secondary shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-base font-semibold text-text-primary",children:n}),re]}),e.jsxs("div",{className:"flex items-center gap-2",children:[f&&e.jsxs(A,{onClick:f,size:"sm",children:[e.jsx(W,{size:16}),L]}),e.jsx(se,{})]})]})}),P&&e.jsx("div",{className:"px-4 py-2 border-b border-border bg-bg-secondary shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-text-tertiary"}),e.jsx("input",{type:"text",placeholder:w,value:k,onChange:r=>te(r.target.value),className:p("w-full pl-8 pr-3 py-2 text-sm rounded-md","bg-bg-tertiary border border-border","text-text-primary placeholder:text-text-tertiary","focus:outline-none focus:ring-1 focus:ring-accent-primary")})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-3",children:x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-2 border-accent-primary/30 border-t-accent-primary rounded-full animate-spin"})}):F.length===0?e.jsx(he,{icon:t||m,title:k?"No results":a,description:k?"Try a different search term":z,action:!k&&f&&e.jsxs(A,{onClick:f,children:[e.jsx(W,{size:16}),L]})}):e.jsx("div",{className:"space-y-2",children:F.map(r=>{const g=m,D=j?j(r):r.name,_=v?v(r):null,q=E?E(r):null,O=l?.[d]===r[d];return e.jsxs("button",{onClick:()=>o?.(r),className:p("w-full flex items-center gap-3 p-3 rounded-xl transition-all","bg-bg-secondary border text-left",O?"border-accent-primary/50 bg-accent-primary/5":"border-border hover:border-border/80"),children:[g&&e.jsx("div",{className:p("w-11 h-11 rounded-xl flex items-center justify-center shrink-0",O?"bg-accent-primary/20":"bg-bg-tertiary"),children:e.jsx(g,{size:22,className:O?"text-accent-primary":"text-text-secondary",weight:"duotone"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:p("text-sm font-medium",O?"text-accent-primary":"text-text-primary"),children:D}),_&&e.jsx("p",{className:"text-xs text-text-tertiary mt-0.5",children:_})]}),q,e.jsx(X,{size:16,className:"text-text-tertiary shrink-0"})]},r[d])})})}),e.jsx("div",{className:"px-4 py-2 border-t border-border bg-bg-secondary text-xs text-text-tertiary text-center shrink-0",children:J(F.length,C)}),l&&e.jsx(Oe,{open:!!l,onOpenChange:r=>!r&&o?.(null),title:y||(j?j(l):"Details"),snapPoints:["50%","85%"],defaultSnap:1,children:ae}),e.jsx(ue,{open:Y,onClose:()=>R(!1),title:H||de(n),children:S})]}):e.jsxs("div",{className:p("flex h-full w-full",Z),children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 min-h-0",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-border bg-bg-secondary flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:n}),re]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{}),e.jsx("button",{onClick:()=>be(!I),className:"p-1.5 rounded-md hover:bg-bg-tertiary text-text-secondary hover:text-text-primary transition-colors",title:I?"Hide list":"Show list",children:I?e.jsx(X,{size:16}):e.jsx($e,{size:16})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:ae})]}),I&&e.jsx("div",{className:"w-72 xl:w-80 border-l border-border bg-bg-secondary flex flex-col min-h-0 shrink-0",children:ye}),e.jsx(ue,{open:Y,onClose:()=>R(!1),title:H||de(n),children:S})]})}function bt(){const{showSuccess:n,showError:i}=ke(),{modals:b,open:u,close:c}=_e(),[x,l]=s.useState(!0),[o,d]=s.useState([]),[m,j]=s.useState(null),[v,E]=s.useState([]),[h,N]=s.useState({name:"",description:"",role:"viewer",permissions:[]});s.useEffect(()=>{y()},[]);const y=async()=>{l(!0);try{const[t,a]=await Promise.all([G.get("/groups"),G.get("/users")]);d(t.data||[]),E(a.data||[])}catch{i("Failed to load groups")}finally{l(!1)}},f=async t=>{try{const a=await G.get(`/groups/${t.id}`);j(a.data||t)}catch{j(t)}},L=async()=>{try{await G.post("/groups",h),n("Group created"),c("create"),y(),N({name:"",description:"",role:"viewer",permissions:[]})}catch(t){i(t.message||"Failed to create group")}},M=async t=>{if(confirm(`Delete group "${t.name}"?`))try{await G.delete(`/groups/${t.id}`),n("Group deleted"),j(null),y()}catch(a){i(a.message||"Failed to delete group")}},U=async t=>{if(m)try{await G.post(`/groups/${m.id}/members`,{user_id:t}),n("Member added"),y(),f(m)}catch(a){i(a.message||"Failed to add member")}},P=async t=>{if(m)try{await G.delete(`/groups/${m.id}/members/${t}`),n("Member removed"),y(),f(m)}catch(a){i(a.message||"Failed to remove member")}},w=m?.members||[],$=v.filter(t=>!w.some(a=>a.user_id===t.id)),S=e.jsxs("div",{className:"space-y-4",children:[e.jsxs(De,{className:"p-4 space-y-3 bg-gradient-to-br from-accent-primary/5 to-transparent",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(Q,{size:16,className:"text-accent-primary"}),"Group Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:o.length}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Total Groups"})]}),e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-accent-primary",children:o.reduce((t,a)=>t+(a.member_count||0),0)}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Total Members"})]})]})]}),e.jsx(pe,{variant:"info",title:"User Groups",children:"Groups allow bulk permission assignment. Members inherit the group's role and permissions."}),e.jsx(pe,{variant:"tip",title:"Best Practice",children:'Create groups by function (e.g., "PKI Operators", "Auditors") rather than by department.'})]}),H=t=>e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsx(Ne,{icon:Q,iconClass:"bg-accent-primary/20",title:t.name,subtitle:t.description||"No description",badge:e.jsx(K,{variant:"primary",size:"sm",children:J(t.member_count||0,"member")})}),e.jsx(we,{stats:[{icon:Ge,value:`${t.permissions?.length||0} perms`},{icon:Ce,value:t.created_at?new Date(t.created_at).toLocaleDateString():"N/A"}]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{size:"sm",variant:"secondary",onClick:()=>u("edit"),children:[e.jsx(Me,{size:14})," Edit"]}),e.jsx(A,{size:"sm",variant:"danger",onClick:()=>M(t),children:e.jsx(oe,{size:14})})]}),e.jsx(ne,{title:"Group Information",children:e.jsxs(Le,{children:[e.jsx(T,{label:"Group Name",value:t.name}),e.jsx(T,{label:"Description",value:t.description||"No description"}),e.jsx(T,{label:"Member Count",value:t.member_count||0}),e.jsx(T,{label:"Permissions",value:t.permissions?.length||0}),e.jsx(T,{label:"Created",value:t.created_at?new Date(t.created_at).toLocaleDateString():"N/A"}),e.jsx(T,{label:"Updated",value:t.updated_at?new Date(t.updated_at).toLocaleDateString():"N/A"})]})}),e.jsx(ne,{title:"Members",children:e.jsxs("div",{className:"space-y-3",children:[$.length>0&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(A,{size:"sm",onClick:()=>u("addMember"),children:[e.jsx(W,{size:14}),"Add Member"]})}),w.length===0?e.jsx("p",{className:"text-sm text-text-tertiary text-center py-4",children:"No members in this group"}):e.jsx("div",{className:"space-y-2",children:w.map(a=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5 bg-bg-tertiary/50 border border-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary/20 flex items-center justify-center",children:e.jsx(ce,{size:16,className:"text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:a.username}),e.jsx("p",{className:"text-xs text-text-tertiary",children:a.email})]})]}),e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>P(a.user_id),children:e.jsx(oe,{size:14,className:"status-danger-text"})})]},a.user_id))})]})})]});return e.jsxs(e.Fragment,{children:[e.jsx(Te,{title:"Groups",items:o,loading:x,selectedItem:m,onSelectItem:f,itemIcon:Q,itemTitle:t=>t.name,itemSubtitle:t=>J(t.member_count||0,"member"),itemBadge:t=>e.jsxs(K,{variant:"secondary",size:"sm",children:[t.permissions?.length||0," perms"]}),renderDetails:H,detailsTitle:"Group Details",onCreate:()=>u("create"),createLabel:"Create Group",searchable:!0,searchKeys:["name","description"],searchPlaceholder:"Search groups...",helpContent:S,emptyIcon:Q,emptyTitle:"No groups",emptyDescription:"Create your first group to organize users",itemName:"group"}),e.jsx(xe,{open:b.create,onOpenChange:t=>!t&&c("create"),title:"Create Group",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ie,{label:"Group Name",value:h.name,onChange:t=>N({...h,name:t.target.value}),placeholder:"e.g., PKI Operators"}),e.jsx(ie,{label:"Description",value:h.description,onChange:t=>N({...h,description:t.target.value}),placeholder:"Optional description"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-text-secondary mb-1.5 block",children:"Default Role"}),e.jsxs("select",{value:h.role,onChange:t=>N({...h,role:t.target.value}),className:"w-full px-3 py-2 bg-bg-tertiary border border-border rounded-lg text-sm text-text-primary",children:[e.jsx("option",{value:"viewer",children:"Viewer"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(A,{variant:"ghost",onClick:()=>c("create"),children:"Cancel"}),e.jsx(A,{onClick:L,disabled:!h.name,children:"Create"})]})]})}),e.jsx(xe,{open:b.addMember,onOpenChange:t=>!t&&c("addMember"),title:"Add Member",children:e.jsx("div",{className:"space-y-2 max-h-80 overflow-auto",children:$.length===0?e.jsx("p",{className:"text-sm text-text-tertiary text-center py-4",children:"All users are already members of this group"}):$.map(t=>e.jsxs("button",{onClick:()=>{U(t.id),c("addMember")},className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-bg-tertiary transition-colors",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary/20 flex items-center justify-center",children:e.jsx(ce,{size:16,className:"text-accent-primary"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:t.username}),e.jsx("p",{className:"text-xs text-text-tertiary",children:t.email})]})]},t.id))})})]})}const Ue=!0;function ee(){const[n,i]=s.useState(null),[b,u]=s.useState(!0);s.useEffect(()=>{G.get("/license").then(x=>i(x.data)).catch(()=>i({type:"community",features:[],pro_enabled:!1})).finally(()=>u(!1))},[]);const c=Ue;return{loading:b,isPro:c,isEnterprise:n?.type==="enterprise",type:"pro",features:n?.features||[],expiresAt:n?.expires_at,licensedTo:n?.licensed_to,hasFeature:x=>c}}function jt(){return{...ee(),canUseGroups:!0,canUseRBAC:!0,canUseSSO:!0,canUseHSM:!0,canUseAuditExport:!0}}function yt({compact:n=!1}){const{type:i,loading:b,expiresAt:u}=ee();if(b||i==="community")return null;const c=i==="enterprise",x=c?Pe:Fe,l=c?"Enterprise":"Pro",o=c?"stat-card-warning status-warning-border border":"bg-accent-pro/20 border-accent-pro/30",d=c?"status-warning-text":"text-accent-pro";return n?e.jsx("div",{className:`flex items-center justify-center p-1.5 rounded-lg ${o} border`,children:e.jsx(x,{size:16,weight:"fill",className:d})}):e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${o} border`,children:[e.jsx(x,{size:16,weight:"fill",className:d}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-xs font-semibold ${d}`,children:l}),u&&e.jsxs("p",{className:"text-[10px] text-text-tertiary",children:["Expires ",new Date(u).toLocaleDateString()]})]})]})}function vt({feature:n,children:i,fallback:b=null}){const{hasFeature:u,isPro:c}=ee();return!c&&!u(n)?b:i}const Nt=[{path:"/groups",component:"GroupsPage",label:"Groups",icon:"UsersThree"},{path:"/rbac",component:"RBACPage",label:"RBAC",icon:"Shield"},{path:"/hsm",component:"HSMPage",label:"HSM",icon:"Lock"}],wt=!0;export{bt as GroupsPage,zt as HSMPage,wt as PRO_MODULE_PRESENT,yt as ProBadge,vt as ProFeatureGate,Mt as RBACPage,At as SSOPage,Dt as SSOSettingsSection,Nt as proRoutes,Gt as proSettingsCategories,ee as useLicense,jt as useProFeatures};
