import{j as e}from"./radix-B6Y-MRu0.js";import{a as t}from"./vendor-DEQSVNfj.js";import{m as oe}from"./ArrowsClockwise.es-DS70dwCP.js";import{G as q,c as de,a as x,y as k,i as R,k as C,B as m,v as ue,I as c}from"./index-vswyqp58.js";import{a as L}from"./PencilSimple.es-CJefJBPq.js";import{n as A}from"./Plus.es-DN9hvW10.js";import{n as G}from"./TestTube.es-BJzbVb1c.js";import{n as P}from"./Trash.es-DhgoD9TD.js";import{M as W}from"./Modal-7_eTIvz3.js";import{B as Z}from"./Badge-CZ5NzBfK.js";import{S as N}from"./Select-PwXyFoxR.js";import{H as U}from"./HelpCard-BINCqYIf.js";import{C as me,a as pe,b as B,c as w,d as p}from"./DetailCard-BKBzFg8i.js";import{U as ye}from"./UnifiedManagementLayout-Wib7G_7r.js";import"./CaretDown.es-DuThAI6u.js";import"./Globe.es-CtUoIY1T.js";import"./Fingerprint.es-a52JDt2Q.js";import"./ui-bTlm5Mct.js";import"./ResponsiveDataTable-kYvH3TtM.js";import"./CaretUp.es-CYK8cpGg.js";import"./CaretRight.es-B3hFfvz_.js";import"./UnifiedPageHeader-Cbwye_R6.js";import"./HelpModal-BnkmCwhU.js";import"./ArrowLeft.es-CZcTzWfI.js";const ge=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M160,36A92.09,92.09,0,0,0,79,84.36,68,68,0,1,0,72,220h88a92,92,0,0,0,0-184Zm0,160H72a44,44,0,0,1-1.82-88A91.86,91.86,0,0,0,68,128a12,12,0,0,0,24,0,68,68,0,1,1,68,68Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M240,128a80,80,0,0,1-80,80H72A56,56,0,1,1,85.92,97.74l0,.1A80,80,0,0,1,240,128Z",opacity:"0.2"}),t.createElement("path",{d:"M160,40A88.09,88.09,0,0,0,81.29,88.67,64,64,0,1,0,72,216h88a88,88,0,0,0,0-176Zm0,160H72a48,48,0,0,1,0-96c1.1,0,2.2,0,3.29.11A88,88,0,0,0,72,128a8,8,0,0,0,16,0,72,72,0,1,1,72,72Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M160.06,40A88.1,88.1,0,0,0,81.29,88.67h0A87.48,87.48,0,0,0,72,127.73,8.18,8.18,0,0,1,64.57,136,8,8,0,0,1,56,128a103.66,103.66,0,0,1,5.34-32.92,4,4,0,0,0-4.75-5.18A64.09,64.09,0,0,0,8,152c0,35.19,29.75,64,65,64H160a88.09,88.09,0,0,0,87.93-91.48C246.11,77.54,207.07,40,160.06,40Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M160,42A86.11,86.11,0,0,0,82.43,90.88,62,62,0,1,0,72,214h88a86,86,0,0,0,0-172Zm0,160H72a50,50,0,0,1,0-100,50.67,50.67,0,0,1,5.91.35A85.61,85.61,0,0,0,74,128a6,6,0,0,0,12,0,74,74,0,1,1,74,74Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M160,40A88.09,88.09,0,0,0,81.29,88.67,64,64,0,1,0,72,216h88a88,88,0,0,0,0-176Zm0,160H72a48,48,0,0,1,0-96c1.1,0,2.2,0,3.29.11A88,88,0,0,0,72,128a8,8,0,0,0,16,0,72,72,0,1,1,72,72Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M160,44A84.11,84.11,0,0,0,83.59,93.12,60.71,60.71,0,0,0,72,92a60,60,0,0,0,0,120h88a84,84,0,0,0,0-168Zm0,160H72a52,52,0,1,1,8.55-103.3A83.66,83.66,0,0,0,76,128a4,4,0,0,0,8,0,76,76,0,1,1,76,76Z"}))]]),he=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,60H32A20,20,0,0,0,12,80v96a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V80A20,20,0,0,0,224,60Zm-4,112H36V84H220Zm-56-44a16,16,0,1,1,16,16A16,16,0,0,1,164,128Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M232,80v96a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H224A8,8,0,0,1,232,80Z",opacity:"0.2"}),t.createElement("path",{d:"M224,64H32A16,16,0,0,0,16,80v96a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64Zm0,112H32V80H224v96Zm-24-48a12,12,0,1,1-12-12A12,12,0,0,1,200,128Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,64H32A16,16,0,0,0,16,80v96a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64Zm-36,76a12,12,0,1,1,12-12A12,12,0,0,1,188,140Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,66H32A14,14,0,0,0,18,80v96a14,14,0,0,0,14,14H224a14,14,0,0,0,14-14V80A14,14,0,0,0,224,66Zm2,110a2,2,0,0,1-2,2H32a2,2,0,0,1-2-2V80a2,2,0,0,1,2-2H224a2,2,0,0,1,2,2Zm-28-48a10,10,0,1,1-10-10A10,10,0,0,1,198,128Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,64H32A16,16,0,0,0,16,80v96a16,16,0,0,0,16,16H224a16,16,0,0,0,16-16V80A16,16,0,0,0,224,64Zm0,112H32V80H224v96Zm-24-48a12,12,0,1,1-12-12A12,12,0,0,1,200,128Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,68H32A12,12,0,0,0,20,80v96a12,12,0,0,0,12,12H224a12,12,0,0,0,12-12V80A12,12,0,0,0,224,68Zm4,108a4,4,0,0,1-4,4H32a4,4,0,0,1-4-4V80a4,4,0,0,1,4-4H224a4,4,0,0,1,4,4Zm-32-48a8,8,0,1,1-8-8A8,8,0,0,1,196,128Z"}))]]),Y=t.forwardRef((n,y)=>t.createElement(q,{ref:y,...n,weights:ge}));Y.displayName="CloudIcon";const j=Y,J=t.forwardRef((n,y)=>t.createElement(q,{ref:y,...n,weights:he}));J.displayName="HardDriveIcon";const Q=J,S=[{value:"pkcs11",label:"PKCS#11 (Local HSM)",icon:Q},{value:"aws-cloudhsm",label:"AWS CloudHSM",icon:j},{value:"azure-keyvault",label:"Azure Key Vault",icon:j},{value:"google-kms",label:"Google Cloud KMS",icon:j}],O={pkcs11:Q,"aws-cloudhsm":j,"azure-keyvault":j,"google-kms":j};function Le(){const[n,y]=t.useState([]),[g,l]=t.useState([]),[o,r]=t.useState(null),[d,s]=t.useState(!0),[z,v]=t.useState(!1),[D,K]=t.useState("create"),[X,H]=t.useState(!1),[E,F]=t.useState(!1),{showSuccess:b,showError:_}=de();t.useEffect(()=>{f()},[]),t.useEffect(()=>{o&&M(o.id)},[o]);const f=async()=>{try{const a=await x.get("/hsm/providers");y(a.data||[])}catch{_("Failed to load HSM providers")}finally{s(!1)}},M=async a=>{try{const i=await x.get(`/hsm/keys?provider_id=${a}`);l(i.data||[])}catch(i){console.error("Failed to load keys:",i)}},I=()=>{r(null),K("create"),v(!0)},$=a=>{r(a),K("edit"),v(!0)},T=async a=>{if(confirm(`Delete HSM provider "${a.name}"?`))try{await x.delete(`/hsm/providers/${a.id}`),b("Provider deleted"),f(),r(null)}catch(i){_(i.message||"Failed to delete provider")}},V=async a=>{F(!0);try{const i=await x.post(`/hsm/providers/${a.id}/test`);i.data?.status==="success"?(b(i.data.message||"Connection successful"),f()):_(i.message||"Test failed")}catch(i){_(i.message||"Connection test failed")}finally{F(!1)}},ee=async a=>{try{D==="create"?(await x.post("/hsm/providers",a),b("Provider created")):(await x.put(`/hsm/providers/${o.id}`,a),b("Provider updated")),v(!1),f()}catch(i){_(i.message||"Failed to save provider")}},ae=async a=>{try{await x.post(`/hsm/providers/${o.id}/keys`,a),b("Key generated"),H(!1),M(o.id)}catch(i){_(i.message||"Failed to generate key")}},te=async a=>{if(confirm(`Destroy key "${a.key_label}"? This cannot be undone.`))try{await x.delete(`/hsm/keys/${a.id}`),b("Key destroyed"),M(o.id)}catch(i){_(i.message||"Failed to destroy key")}},se=[{key:"name",header:"Provider Name",render:(a,i)=>{const h=O[i.provider_type]||k;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{size:16,className:i.enabled?"status-purple-text":"text-text-tertiary"}),e.jsx("span",{className:"font-medium truncate",children:a})]})}},{key:"provider_type",header:"Type",render:a=>{const i=S.find(h=>h.value===a);return e.jsx("span",{className:"text-xs text-text-secondary",children:i?.label.split(" ")[0]||a})}},{key:"enabled",header:"Status",render:a=>e.jsx(Z,{variant:a?"success":"secondary",size:"sm",children:a?"Enabled":"Disabled"})},{key:"key_count",header:"Keys",render:a=>a||0}],le=a=>[{label:"Test",icon:G,onClick:()=>V(a)},{label:"Edit",icon:L,onClick:()=>$(a)},{label:"Delete",icon:P,variant:"danger",onClick:()=>T(a)}],ne=t.useMemo(()=>{const a=n.filter(h=>h.enabled).length,i=n.reduce((h,u)=>h+(u.key_count||0),0);return[{label:"Providers",value:n.length,icon:k},{label:"Enabled",value:a,icon:R,variant:"success"},{label:"Keys",value:i,icon:C,variant:"primary"}]},[n]),re=a=>{const i=O[a.provider_type]||k,h=S.find(u=>u.value===a.provider_type)?.label||a.provider_type;return e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsx(me,{icon:i,iconClass:a.enabled?"status-purple-bg":"bg-bg-tertiary",title:a.name,subtitle:h,badge:e.jsx(Z,{variant:a.enabled?"success":"secondary",size:"sm",children:a.enabled?"Enabled":"Disabled"})}),e.jsx(pe,{stats:[{icon:C,value:`${a.key_count||0} keys`},{icon:R,value:a.last_connected_at?"Connected":"Never"}]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{size:"sm",variant:"secondary",className:"flex-1",onClick:()=>V(a),disabled:E,children:[E?e.jsx(oe,{size:14,className:"animate-spin"}):e.jsx(G,{size:14}),E?"Testing...":"Test"]}),e.jsx(m,{size:"sm",variant:"secondary",onClick:()=>$(a),children:e.jsx(L,{size:14})}),e.jsx(m,{size:"sm",variant:"danger",onClick:()=>T(a),children:e.jsx(P,{size:14})})]}),a.last_error&&e.jsxs("div",{className:"p-3 rounded-lg bg-status-danger/10 border border-status-danger/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-status-danger text-xs",children:[e.jsx(ue,{size:14}),e.jsx("span",{className:"font-medium",children:"Connection Error"})]}),e.jsx("p",{className:"text-[10px] text-text-secondary mt-1",children:a.last_error})]}),e.jsxs(B,{title:"Configuration",children:[a.provider_type==="pkcs11"&&e.jsxs(e.Fragment,{children:[e.jsxs(w,{children:[e.jsx(p,{label:"Slot ID",value:a.pkcs11_slot_id??"Auto"}),e.jsx(p,{label:"Token",value:a.pkcs11_token_label||"-"})]}),e.jsxs("div",{className:"mt-2 text-xs",children:[e.jsx("span",{className:"text-text-tertiary block mb-0.5",children:"Library Path:"}),e.jsx("p",{className:"font-mono text-[10px] text-text-secondary break-all bg-bg-tertiary/50 p-1.5 rounded",children:a.pkcs11_library_path||"-"})]})]}),a.provider_type==="aws-cloudhsm"&&e.jsxs(w,{children:[e.jsx(p,{label:"Cluster",value:a.aws_cluster_id,mono:!0}),e.jsx(p,{label:"Region",value:a.aws_region}),e.jsx(p,{label:"User",value:a.aws_crypto_user})]}),a.provider_type==="azure-keyvault"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs mb-2",children:[e.jsx("span",{className:"text-text-tertiary block mb-0.5",children:"Vault URL:"}),e.jsx("p",{className:"font-mono text-[10px] text-text-secondary break-all bg-bg-tertiary/50 p-1.5 rounded",children:a.azure_vault_url||"-"})]}),e.jsxs(w,{children:[e.jsx(p,{label:"Tenant",value:a.azure_tenant_id,mono:!0}),e.jsx(p,{label:"Client",value:a.azure_client_id,mono:!0})]})]}),a.provider_type==="google-kms"&&e.jsxs(w,{children:[e.jsx(p,{label:"Project",value:a.gcp_project_id}),e.jsx(p,{label:"Location",value:a.gcp_location}),e.jsx(p,{label:"Key Ring",value:a.gcp_keyring})]})]}),e.jsxs(B,{title:"HSM Keys",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-xs text-text-tertiary",children:[g.length," keys in this HSM"]}),e.jsxs(m,{size:"sm",variant:"secondary",onClick:()=>H(!0),children:[e.jsx(A,{size:12}),"Generate"]})]}),g.length===0?e.jsx("p",{className:"text-xs text-text-tertiary text-center py-4",children:"No keys in this HSM"}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:g.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-bg-tertiary/50 rounded text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(C,{size:14,className:"text-text-tertiary flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-text-primary truncate",children:u.key_label}),e.jsxs("p",{className:"text-text-tertiary",children:[u.key_type," ",u.key_size]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{variant:u.status==="active"?"success":"danger",size:"sm",children:u.status}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>te(u),children:e.jsx(P,{size:12,className:"text-status-danger"})})]})]},u.id))})]})]})},ie=e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{title:"Security",variant:"warning",children:"HSM keys are in tamper-resistant hardware. Destroying a key is irreversible."}),e.jsx(U,{title:"Best Practice",variant:"info",children:"Use HSM for all CA signing keys. Test connections regularly."})]}),ce=[{key:"enabled",label:"Status",options:[{value:!0,label:"Enabled"},{value:!1,label:"Disabled"}]},{key:"provider_type",label:"Type",options:S.map(a=>({value:a.value,label:a.label.split(" ")[0]}))}];return e.jsxs(e.Fragment,{children:[e.jsx(ye,{title:"HSM Management",stats:ne,data:n,columns:se,loading:d,selectedItem:o,onSelectItem:r,renderDetails:re,detailsTitle:"Provider Details",icon:C,subtitle:`${n.length} provider${n.length!==1?"s":""}`,splitView:!0,splitEmptyContent:e.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-bg-tertiary flex items-center justify-center mb-3",children:e.jsx(k,{size:24,className:"text-text-tertiary",weight:"duotone"})}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Select a provider to view details"})]}),searchable:!0,searchPlaceholder:"Search providers...",searchKeys:["name","provider_type"],sortable:!0,defaultSort:{key:"name",direction:"asc"},paginated:!1,rowActions:le,filters:ce,emptyIcon:k,emptyTitle:"No HSM providers",emptyDescription:"Configure hardware security modules for key storage",emptyAction:e.jsxs(m,{onClick:I,children:[e.jsx(A,{size:16})," New Provider"]}),helpContent:ie,actions:e.jsxs(m,{size:"sm",onClick:I,children:[e.jsx(A,{size:16})," New Provider"]})}),z&&e.jsx(xe,{provider:D==="edit"?o:null,onSave:ee,onClose:()=>v(!1)}),X&&o&&e.jsx(_e,{provider:o,onSave:ae,onClose:()=>H(!1)})]})}function xe({provider:n,onSave:y,onClose:g}){const[l,o]=t.useState({name:n?.name||"",provider_type:n?.provider_type||"pkcs11",enabled:n?.enabled??!1,connection_timeout:n?.connection_timeout||30,pkcs11_library_path:n?.pkcs11_library_path||"",pkcs11_slot_id:n?.pkcs11_slot_id??"",pkcs11_pin:"",pkcs11_token_label:n?.pkcs11_token_label||"",aws_cluster_id:n?.aws_cluster_id||"",aws_region:n?.aws_region||"us-east-1",aws_access_key:n?.aws_access_key||"",aws_secret_key:"",aws_crypto_user:n?.aws_crypto_user||"",aws_crypto_password:"",azure_vault_url:n?.azure_vault_url||"",azure_tenant_id:n?.azure_tenant_id||"",azure_client_id:n?.azure_client_id||"",azure_client_secret:"",gcp_project_id:n?.gcp_project_id||"",gcp_location:n?.gcp_location||"global",gcp_keyring:n?.gcp_keyring||"",gcp_credentials_json:""}),r=(s,z)=>{o(v=>({...v,[s]:z}))},d=s=>{s.preventDefault(),y(l)};return e.jsx(W,{open:!0,onClose:g,title:n?"Edit HSM Provider":"New HSM Provider",size:"lg",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Provider Name",value:l.name,onChange:s=>r("name",s.target.value),required:!0}),!n&&e.jsx(N,{label:"Provider Type",value:l.provider_type,onChange:s=>r("provider_type",s),options:S})]}),l.provider_type==="pkcs11"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{label:"PKCS#11 Library Path",value:l.pkcs11_library_path,onChange:s=>r("pkcs11_library_path",s.target.value),placeholder:"/usr/lib/softhsm/libsofthsm2.so"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Slot ID (optional)",type:"number",value:l.pkcs11_slot_id,onChange:s=>r("pkcs11_slot_id",s.target.value?parseInt(s.target.value):"")}),e.jsx(c,{label:"Token Label",value:l.pkcs11_token_label,onChange:s=>r("pkcs11_token_label",s.target.value)})]}),e.jsx(c,{label:"PIN",type:"password",value:l.pkcs11_pin,onChange:s=>r("pkcs11_pin",s.target.value),placeholder:n?"(leave empty to keep)":""})]}),l.provider_type==="aws-cloudhsm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Cluster ID",value:l.aws_cluster_id,onChange:s=>r("aws_cluster_id",s.target.value)}),e.jsx(c,{label:"Region",value:l.aws_region,onChange:s=>r("aws_region",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Access Key",value:l.aws_access_key,onChange:s=>r("aws_access_key",s.target.value)}),e.jsx(c,{label:"Secret Key",type:"password",value:l.aws_secret_key,onChange:s=>r("aws_secret_key",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Crypto User",value:l.aws_crypto_user,onChange:s=>r("aws_crypto_user",s.target.value)}),e.jsx(c,{label:"Crypto Password",type:"password",value:l.aws_crypto_password,onChange:s=>r("aws_crypto_password",s.target.value)})]})]}),l.provider_type==="azure-keyvault"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{label:"Vault URL",value:l.azure_vault_url,onChange:s=>r("azure_vault_url",s.target.value),placeholder:"https://your-vault.vault.azure.net"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Tenant ID",value:l.azure_tenant_id,onChange:s=>r("azure_tenant_id",s.target.value)}),e.jsx(c,{label:"Client ID",value:l.azure_client_id,onChange:s=>r("azure_client_id",s.target.value)})]}),e.jsx(c,{label:"Client Secret",type:"password",value:l.azure_client_secret,onChange:s=>r("azure_client_secret",s.target.value)})]}),l.provider_type==="google-kms"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Project ID",value:l.gcp_project_id,onChange:s=>r("gcp_project_id",s.target.value)}),e.jsx(c,{label:"Location",value:l.gcp_location,onChange:s=>r("gcp_location",s.target.value)})]}),e.jsx(c,{label:"Key Ring",value:l.gcp_keyring,onChange:s=>r("gcp_keyring",s.target.value)})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:l.enabled,onChange:s=>r("enabled",s.target.checked)}),"Enable provider"]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-border",children:[e.jsx(m,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),e.jsx(m,{type:"submit",children:n?"Update":"Create"})]})]})})}function _e({provider:n,onSave:y,onClose:g}){const[l,o]=t.useState({key_label:"",key_type:"rsa",key_size:2048,purpose:"general",is_exportable:!1}),r=d=>{d.preventDefault(),y(l)};return e.jsx(W,{open:!0,onClose:g,title:"Generate HSM Key",size:"md",children:e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsx(c,{label:"Key Label",value:l.key_label,onChange:d=>o({...l,key_label:d.target.value}),required:!0,placeholder:"my-signing-key"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(N,{label:"Key Type",value:l.key_type,onChange:d=>o({...l,key_type:d}),options:[{value:"rsa",label:"RSA"},{value:"ec",label:"ECDSA"},{value:"aes",label:"AES"}]}),e.jsx(N,{label:"Key Size",value:l.key_size,onChange:d=>o({...l,key_size:parseInt(d)}),options:l.key_type==="rsa"?[{value:2048,label:"2048"},{value:3072,label:"3072"},{value:4096,label:"4096"}]:l.key_type==="ec"?[{value:256,label:"P-256"},{value:384,label:"P-384"},{value:521,label:"P-521"}]:[{value:128,label:"128"},{value:256,label:"256"}]})]}),e.jsx(N,{label:"Purpose",value:l.purpose,onChange:d=>o({...l,purpose:d}),options:[{value:"general",label:"General Purpose"},{value:"ca_signing",label:"CA Signing"},{value:"code_signing",label:"Code Signing"},{value:"encryption",label:"Encryption"}]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-border",children:[e.jsx(m,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),e.jsx(m,{type:"submit",children:"Generate Key"})]})]})})}export{Le as default};
