import{j as e}from"./radix-B6Y-MRu0.js";import{a}from"./vendor-DEQSVNfj.js";import{G as He,w as Ie,c as ie,n as R,k as U,C as re,L as Le,I as m,B as i,m as Ee}from"./index-vswyqp58.js";import{p as Ze}from"./Fingerprint.es-a52JDt2Q.js";import{m as Re}from"./FloppyDisk.es-CJlG_KS3.js";import{a as Ue}from"./PencilSimple.es-CJefJBPq.js";import{i as ze}from"./Pulse.es-DcGwjDre.js";import{F as We,P as $e}from"./PageLayout-Dh0KLD48.js";import{M as k}from"./Modal-7_eTIvz3.js";import{B as u}from"./Badge-CZ5NzBfK.js";import{H as z}from"./HelpCard-BINCqYIf.js";import{f as Oe,o as Be,D as qe,g as j,h as ne,i as v}from"./DetailCard-BKBzFg8i.js";import{a as c}from"./account.service-DlHdLrXD.js";import"./ui-bTlm5Mct.js";import"./ArrowLeft.es-CZcTzWfI.js";import"./HelpModal-BnkmCwhU.js";import"./CaretDown.es-DuThAI6u.js";import"./Globe.es-CtUoIY1T.js";const Ge=new Map([["bold",a.createElement(a.Fragment,null,a.createElement("path",{d:"M208,76H180V56A52,52,0,0,0,76,56V76H48A20,20,0,0,0,28,96V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V96A20,20,0,0,0,208,76ZM100,56a28,28,0,0,1,56,0V76H100ZM204,204H52V100H204Zm-76-92a32,32,0,0,0-12,61.66V180a12,12,0,0,0,24,0v-6.34A32,32,0,0,0,128,112Zm0,24a8,8,0,1,1-8,8A8,8,0,0,1,128,136Z"}))],["duotone",a.createElement(a.Fragment,null,a.createElement("path",{d:"M208,88H48a8,8,0,0,0-8,8V208a8,8,0,0,0,8,8H208a8,8,0,0,0,8-8V96A8,8,0,0,0,208,88Zm-80,72a20,20,0,1,1,20-20A20,20,0,0,1,128,160Z",opacity:"0.2"}),a.createElement("path",{d:"M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96ZM208,208H48V96H208V208Zm-80-96a28,28,0,0,0-8,54.83V184a8,8,0,0,0,16,0V166.83A28,28,0,0,0,128,112Zm0,40a12,12,0,1,1,12-12A12,12,0,0,1,128,152Z"}))],["fill",a.createElement(a.Fragment,null,a.createElement("path",{d:"M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80Zm-72,78.63V184a8,8,0,0,1-16,0V158.63a24,24,0,1,1,16,0ZM160,80H96V56a32,32,0,0,1,64,0Z"}))],["light",a.createElement(a.Fragment,null,a.createElement("path",{d:"M208,82H174V56a46,46,0,0,0-92,0V82H48A14,14,0,0,0,34,96V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V96A14,14,0,0,0,208,82ZM94,56a34,34,0,0,1,68,0V82H94ZM210,208a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V96a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2Zm-82-94a26,26,0,0,0-6,51.29V184a6,6,0,0,0,12,0V165.29A26,26,0,0,0,128,114Zm0,40a14,14,0,1,1,14-14A14,14,0,0,1,128,154Z"}))],["regular",a.createElement(a.Fragment,null,a.createElement("path",{d:"M128,112a28,28,0,0,0-8,54.83V184a8,8,0,0,0,16,0V166.83A28,28,0,0,0,128,112Zm0,40a12,12,0,1,1,12-12A12,12,0,0,1,128,152Zm80-72H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96ZM208,208H48V96H208V208Z"}))],["thin",a.createElement(a.Fragment,null,a.createElement("path",{d:"M208,84H172V56a44,44,0,0,0-88,0V84H48A12,12,0,0,0,36,96V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V96A12,12,0,0,0,208,84ZM92,56a36,36,0,0,1,72,0V84H92ZM212,208a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V96a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4Zm-84-92a24,24,0,0,0-4,47.66V184a4,4,0,0,0,8,0V163.66A24,24,0,0,0,128,116Zm0,40a16,16,0,1,1,16-16A16,16,0,0,1,128,156Z"}))]]),le=a.forwardRef((h,l)=>a.createElement(He,{ref:l,...h,weights:Ge}));le.displayName="LockKeyIcon";const Q=le;function gt(){const{user:h}=Ie(),{showSuccess:l,showError:n,showConfirm:d,showPrompt:w}=ie(),[p,o]=a.useState(!0),[g,W]=a.useState(!1),[s,J]=a.useState({}),[b,ce]=a.useState([]),[oe,P]=a.useState(!1),[de,F]=a.useState(!1),[me,V]=a.useState(!1),[C,M]=a.useState(null),[$,K]=a.useState(""),[S,X]=a.useState("profile"),[T,xe]=a.useState([]),[ue,H]=a.useState(!1),[I,L]=a.useState(""),[ee,te]=a.useState(!1),[O,he]=a.useState([]),[ye,E]=a.useState(!1),[Je,Xe]=a.useState("create"),[y,A]=a.useState({cn:"",email:"",validity_days:365});a.useEffect(()=>{f(),B(),q(),G()},[]);const f=async()=>{o(!0);try{const t=await c.getProfile();J(t.data||t)}catch(t){n(t.message||"Failed to load account")}finally{o(!1)}},B=async()=>{try{const t=await c.getApiKeys();ce(t.data||t||[])}catch(t){console.error("Failed to load API keys:",t)}},q=async()=>{try{const t=await c.getWebAuthnCredentials();xe(t.data||[])}catch(t){console.error("Failed to load WebAuthn credentials:",t)}},G=async()=>{try{const t=await c.getMTLSCertificates();he(t.data||[])}catch(t){console.error("Failed to load mTLS certificates:",t)}},pe=async()=>{try{await c.updateProfile(s),l("Profile updated successfully"),W(!1),f()}catch(t){n(t.message||"Failed to update profile")}},fe=async t=>{try{await c.changePassword(t),l("Password changed successfully"),P(!1)}catch(r){n(r.message||"Failed to change password")}},ge=async t=>{try{const r=await c.createApiKey(t);l(`API key created: ${r.key}`),F(!1),B()}catch(r){n(r.message||"Failed to create API key")}},be=async t=>{if(await d("Are you sure you want to delete this API key?",{title:"Delete API Key",confirmText:"Delete",variant:"danger"}))try{await c.deleteApiKey(t),l("API key deleted"),B()}catch(x){n(x.message||"Failed to delete API key")}},je=async()=>{try{if(s.two_factor_enabled){const t=await w("Enter your 2FA code to disable:",{title:"Disable Two-Factor Authentication",placeholder:"123456",confirmText:"Disable 2FA"});if(!t)return;await c.disable2FA(t),l("Two-factor authentication disabled"),f()}else{const t=await c.enable2FA();M(t.data||t),V(!0)}}catch(t){n(t.message||"Failed to toggle 2FA")}},ve=async()=>{try{await c.confirm2FA($),l("2FA enabled successfully! Save your backup codes."),V(!1),M(null),K(""),f()}catch(t){n(t.message||"Invalid code. Please try again.")}},we=async()=>{if(!I.trim()){n("Please enter a name for the security key");return}te(!0);try{const r=(await c.startWebAuthnRegistration()).data,x=N=>{let Y=N.replace(/-/g,"+").replace(/_/g,"/");for(;Y.length%4;)Y+="=";return Uint8Array.from(atob(Y),Te=>Te.charCodeAt(0))},Z=N=>new TextEncoder().encode(N),_=x(r.challenge),Me=Z(r.user.id),D=await navigator.credentials.create({publicKey:{...r,challenge:_,user:{...r.user,id:Me},excludeCredentials:(r.excludeCredentials||[]).map(N=>({...N,id:x(N.id)}))}}),Ke={id:D.id,rawId:btoa(String.fromCharCode(...new Uint8Array(D.rawId))),type:D.type,response:{clientDataJSON:btoa(String.fromCharCode(...new Uint8Array(D.response.clientDataJSON))),attestationObject:btoa(String.fromCharCode(...new Uint8Array(D.response.attestationObject)))}};await c.completeWebAuthnRegistration(Ke,I),l("Security key registered successfully!"),H(!1),L(""),f(),q()}catch(t){console.error("WebAuthn registration failed:",t),t.name==="NotAllowedError"?n("Security key registration was cancelled or timed out"):n(t.message||"Failed to register security key")}finally{te(!1)}},Ae=async t=>{if(await d("Delete this security key?",{title:"Delete Security Key",confirmText:"Delete",variant:"danger"}))try{await c.deleteWebAuthnCredential(t),l("Security key deleted"),f(),q()}catch(x){n(x.message||"Failed to delete security key")}},Ne=async()=>{if(!y.cn.trim()){n("Please enter a Common Name (CN)");return}try{const t=await c.createMTLSCertificate({cn:y.cn,email:y.email||s.email,validity_days:y.validity_days,self_signed:!1});l("Certificate created! Download it now."),t.cert_pem&&ae(t.cert_pem,`${y.cn}-cert.pem`),t.key_pem&&ae(t.key_pem,`${y.cn}-key.pem`),E(!1),A({cn:"",email:"",validity_days:365}),f(),G()}catch(t){n(t.message||"Failed to create certificate")}},Ce=async t=>{if(await d("Delete this certificate?",{title:"Delete Certificate",confirmText:"Delete",variant:"danger"}))try{await c.deleteMTLSCertificate(t),l("Certificate deleted"),f(),G()}catch(x){n(x.message||"Failed to delete certificate")}},ae=(t,r)=>{const x=new Blob([t],{type:"application/x-pem-file"}),Z=URL.createObjectURL(x),_=document.createElement("a");_.href=Z,_.download=r,_.click(),URL.revokeObjectURL(Z)},se=(t,r)=>{J(x=>({...x,[t]:r}))},Se=[{id:"profile",label:"Profile",icon:R},{id:"security",label:"Security",icon:Q},{id:"api-keys",label:"API Keys",icon:U,count:b.length}],_e=[{id:"profile",title:"Personal Info",subtitle:"Username, email, name",icon:R},{id:"security",title:"Security",subtitle:"Password, 2FA, keys",icon:Q},{id:"api-keys",title:"API Keys",subtitle:`${b.length} key(s)`,icon:U},{id:"activity",title:"Pulse",subtitle:"Sessions & logins",icon:ze}],De=()=>e.jsxs(e.Fragment,{children:[e.jsx(j,{title:"Personal Information",children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{label:"Username",value:s.username||"",disabled:!0,helperText:"Username cannot be changed"}),e.jsx(m,{label:"Email",type:"email",value:s.email||"",onChange:t=>se("email",t.target.value)}),e.jsx(m,{label:"Full Name",value:s.full_name||"",onChange:t=>se("full_name",t.target.value)}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs(i,{size:"sm",onClick:pe,children:[e.jsx(Re,{size:16}),"Save Changes"]}),e.jsx(i,{size:"sm",variant:"ghost",onClick:()=>{W(!1),f()},children:"Cancel"})]})]}):e.jsxs(ne,{children:[e.jsx(v,{label:"Username",value:s.username}),e.jsx(v,{label:"Email",value:s.email,copyable:!0}),e.jsx(v,{label:"Full Name",value:s.full_name||"—"}),e.jsx(v,{label:"Role",value:e.jsx(u,{variant:"primary",children:s.role})})]})}),e.jsx(j,{title:"Account Information",children:e.jsxs(ne,{children:[e.jsx(v,{label:"Account Created",value:s.created_at?new Date(s.created_at).toLocaleDateString():"—"}),e.jsx(v,{label:"Last Login",value:s.last_login?new Date(s.last_login).toLocaleString():"—"}),e.jsx(v,{label:"Total Logins",value:s.login_count||0}),e.jsx(v,{label:"Status",value:e.jsx(u,{variant:s.active?"success":"danger",children:s.active?"Active":"Inactive"})})]})})]}),ke=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{variant:"tip",title:"Security Best Practices",items:["Enable 2FA for additional protection","Use security keys (WebAuthn) for passwordless login","Rotate API keys regularly"]}),e.jsx(j,{title:"Password",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Change Password"}),e.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["Last changed: ",s.password_changed_at?new Date(s.password_changed_at).toLocaleDateString():"Never"]})]}),e.jsx(i,{size:"sm",onClick:()=>P(!0),children:"Change Password"})]})}),e.jsx(j,{title:"Two-Factor Authentication",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Authenticator App (TOTP)"}),e.jsx("div",{className:"mt-1",children:s.two_factor_enabled?e.jsx(u,{variant:"success",children:"Enabled"}):e.jsx(u,{variant:"secondary",children:"Disabled"})})]}),e.jsx(i,{size:"sm",variant:s.two_factor_enabled?"danger":"primary",onClick:je,children:s.two_factor_enabled?"Disable 2FA":"Enable 2FA"})]})}),e.jsx(j,{title:"Security Keys (WebAuthn/FIDO2)",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(i,{size:"sm",onClick:()=>H(!0),children:"Add Key"})}),T.length===0?e.jsxs("div",{className:"p-4 bg-bg-tertiary border border-border rounded-lg text-center",children:[e.jsx(Ze,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"No security keys registered"}),e.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Add a YubiKey, TouchID, or Windows Hello for passwordless login"})]}):e.jsx("div",{className:"space-y-2",children:T.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:t.name||"Security Key"}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Added ",new Date(t.created_at).toLocaleDateString(),t.last_used_at&&` · Last used ${new Date(t.last_used_at).toLocaleDateString()}`]})]}),e.jsx(i,{size:"sm",variant:"danger",onClick:()=>Ae(t.id),children:"Delete"})]},t.id))})]})}),e.jsx(j,{title:"Client Certificates (mTLS)",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(i,{size:"sm",onClick:()=>E(!0),children:"Create Certificate"})}),O.length===0?e.jsxs("div",{className:"p-4 bg-bg-tertiary border border-border rounded-lg text-center",children:[e.jsx(Ee,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"No certificates enrolled"}),e.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Create a client certificate for mutual TLS authentication"})]}):e.jsx("div",{className:"space-y-2",children:O.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:t.name||t.cert_subject}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Expires ",new Date(t.valid_until).toLocaleDateString()," · ",e.jsx(u,{variant:t.enabled?"success":"secondary",className:"text-xs",children:t.enabled?"Active":"Disabled"})]})]}),e.jsx(i,{size:"sm",variant:"danger",onClick:()=>Ce(t.id),children:"Delete"})]},t.id))})]})}),e.jsx(j,{title:"Active Sessions",children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary border border-border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Current Session"}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Started ",new Date().toLocaleString()]})]}),e.jsx(u,{variant:"success",children:"Active"})]})})]}),Pe=()=>e.jsx(e.Fragment,{children:e.jsx(j,{title:"API Keys",noBorder:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(i,{size:"sm",onClick:()=>F(!0),children:[e.jsx(U,{size:16}),"Create API Key"]})}),b.length===0?e.jsxs("div",{className:"text-center py-12 text-text-secondary bg-bg-tertiary border border-border rounded-lg",children:[e.jsx(U,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No API keys"}),e.jsx("p",{className:"text-xs mt-1",children:"Create an API key for programmatic access"})]}):e.jsx("div",{className:"space-y-2",children:b.map(t=>e.jsx("div",{className:"p-4 bg-bg-tertiary border border-border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-text-primary",children:t.name}),e.jsxs("p",{className:"text-xs font-mono text-text-secondary mt-1",children:[t.key_preview,"••••••••"]}),e.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["Created: ",new Date(t.created_at).toLocaleDateString(),t.last_used&&` • Last used: ${new Date(t.last_used).toLocaleDateString()}`]})]}),e.jsx(i,{variant:"danger",size:"sm",onClick:()=>be(t.id),children:"Delete"})]})},t.id))}),e.jsxs("div",{className:"p-4 status-warning-bg status-warning-border border rounded-lg",children:[e.jsx("p",{className:"text-sm status-warning-text font-medium",children:"⚠️ API Key Security"}),e.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"API keys provide full access to your account. Keep them secure and never share them."})]})]})})}),Fe=e.jsxs("div",{className:"space-y-4",children:[e.jsxs(re,{className:"p-4 space-y-3 bg-gradient-to-br from-accent-primary/5 to-transparent",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(R,{size:16,className:"text-accent-primary"}),"Account Overview"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:b.length}),e.jsx("p",{className:"text-xs text-text-secondary",children:"API Keys"})]}),e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:T.length}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Security Keys"})]})]})]}),e.jsxs(re,{className:`p-4 space-y-3 ${s.two_factor_enabled?"stat-card-success":"stat-card-warning"}`,children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(Q,{size:16,className:"text-accent-primary"}),"Security Status"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"2FA"}),e.jsx(u,{variant:s.two_factor_enabled?"success":"warning",children:s.two_factor_enabled?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"mTLS Certs"}),e.jsx("span",{className:"text-sm font-medium text-text-primary",children:O.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Role"}),e.jsx(u,{variant:h?.role==="admin"?"primary":"secondary",children:h?.role||"User"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(z,{variant:"info",title:"Account Management",children:"Manage your profile information, security settings, and API access from this page. Keep your contact information up to date for important notifications."}),e.jsx(z,{variant:"tip",title:"Security Best Practices",children:"Enable two-factor authentication and use security keys (WebAuthn) for maximum protection. Rotate API keys regularly and never share them."}),e.jsx(z,{variant:"warning",title:"API Key Security",children:"API keys provide full access to your account. Keep them secure, store them safely, and delete unused keys immediately."})]})]}),Ve=e.jsx("div",{className:"p-2 space-y-1.5",children:_e.map(t=>e.jsx(We,{icon:t.icon,title:t.title,subtitle:t.subtitle,badge:t.id==="security"&&s.two_factor_enabled?e.jsx(u,{variant:"success",size:"sm",children:"2FA"}):t.id==="api-keys"&&b.length>0?e.jsx(u,{variant:"primary",size:"sm",children:b.length}):null,selected:S===t.id,onClick:()=>X(t.id)},t.id))});return p?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(Le,{message:"Loading account..."})}):e.jsxs($e,{title:"My Account",focusTitle:"Profile",focusContent:Ve,focusFooter:`${h?.username||"User"} • ${h?.role||"User"}`,helpContent:Fe,children:[e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(Oe,{icon:R,title:s.username||"User",subtitle:s.email,badge:e.jsx(u,{variant:s.role==="admin"?"primary":"secondary",children:s.role}),stats:[{label:"API Keys:",value:b.length},{label:"Security Keys:",value:T.length},{label:"2FA:",value:s.two_factor_enabled?"Enabled":"Disabled"}],actions:g?[]:[{label:"Edit Profile",icon:Ue,onClick:()=>W(!0)}]})}),e.jsx(Be,{tabs:Se,activeTab:S,onChange:X}),e.jsxs(qe,{children:[S==="profile"&&De(),S==="security"&&ke(),S==="api-keys"&&Pe()]}),e.jsx(k,{open:oe,onClose:()=>P(!1),title:"Change Password",children:e.jsx(Ye,{onSubmit:fe,onCancel:()=>P(!1)})}),e.jsx(k,{open:de,onClose:()=>F(!1),title:"Create API Key",children:e.jsx(Qe,{onSubmit:ge,onCancel:()=>F(!1)})}),e.jsx(k,{open:me,onClose:()=>{V(!1),M(null),K("")},title:"Enable Two-Factor Authentication",children:C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-text-secondary",children:[e.jsx("p",{className:"mb-2",children:"1. Scan this QR code with Google Authenticator, Authy, or any TOTP app:"}),e.jsx("div",{className:"flex justify-center p-4 bg-surface-elevated rounded-lg",children:e.jsx("img",{src:C.qr_code,alt:"2FA QR Code",className:"w-48 h-48"})})]}),e.jsxs("div",{className:"text-sm text-text-secondary",children:[e.jsx("p",{className:"mb-2",children:"2. Enter the 6-digit code from your authenticator app:"}),e.jsx(m,{type:"text",placeholder:"000000",value:$,onChange:t=>K(t.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-2xl tracking-widest"})]}),C.backup_codes&&C.backup_codes.length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-text-primary mb-2",children:"⚠️ Save these backup codes:"}),e.jsx("div",{className:"bg-surface-elevated rounded p-3 space-y-1 font-mono text-xs",children:C.backup_codes.map((t,r)=>e.jsx("div",{children:t},r))}),e.jsx("p",{className:"text-text-secondary mt-2 text-xs",children:"Keep these codes safe! You'll need them if you lose access to your authenticator app."})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(i,{variant:"secondary",onClick:()=>{V(!1),M(null),K("")},className:"flex-1",children:"Cancel"}),e.jsx(i,{variant:"primary",onClick:ve,disabled:$.length!==6,className:"flex-1",children:"Confirm & Enable"})]})]})}),e.jsx(k,{open:ue,onClose:()=>{H(!1),L("")},title:"Register Security Key",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{label:"Key Name",value:I,onChange:t=>L(t.target.value),placeholder:"YubiKey 5 NFC",helperText:"Give your security key a recognizable name"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Click Register and follow your browser's prompts to activate your security key (YubiKey, TouchID, Windows Hello, etc.)"}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(i,{variant:"secondary",onClick:()=>{H(!1),L("")},className:"flex-1",children:"Cancel"}),e.jsx(i,{variant:"primary",onClick:we,disabled:!I.trim()||ee,className:"flex-1",children:ee?"Registering...":"Register Key"})]})]})}),e.jsx(k,{open:ye,onClose:()=>{E(!1),A({cn:"",email:"",validity_days:365})},title:"Create Client Certificate",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{label:"Common Name (CN)",value:y.cn,onChange:t=>A(r=>({...r,cn:t.target.value})),placeholder:"john.doe",helperText:"Usually your username or identifier"}),e.jsx(m,{label:"Email (optional)",type:"email",value:y.email,onChange:t=>A(r=>({...r,email:t.target.value})),placeholder:"john@example.com"}),e.jsx(m,{label:"Validity (days)",type:"number",value:y.validity_days,onChange:t=>A(r=>({...r,validity_days:parseInt(t.target.value)||365})),min:"1",max:"3650"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"A new client certificate will be generated. Download and install it in your browser for mTLS authentication."}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(i,{variant:"secondary",onClick:()=>{E(!1),A({cn:"",email:"",validity_days:365})},className:"flex-1",children:"Cancel"}),e.jsx(i,{variant:"primary",onClick:Ne,disabled:!y.cn.trim(),className:"flex-1",children:"Create Certificate"})]})]})})]})}function Ye({onSubmit:h,onCancel:l}){const{showWarning:n}=ie(),[d,w]=a.useState({current_password:"",new_password:"",confirm_password:""}),p=o=>{if(o.preventDefault(),d.new_password!==d.confirm_password){n("New passwords do not match");return}h(d)};return e.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[e.jsx(m,{label:"Current Password",type:"password",value:d.current_password,onChange:o=>w(g=>({...g,current_password:o.target.value})),required:!0}),e.jsx(m,{label:"New Password",type:"password",value:d.new_password,onChange:o=>w(g=>({...g,new_password:o.target.value})),required:!0}),e.jsx(m,{label:"Confirm New Password",type:"password",value:d.confirm_password,onChange:o=>w(g=>({...g,confirm_password:o.target.value})),required:!0}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-border",children:[e.jsx(i,{type:"button",variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(i,{type:"submit",children:"Change Password"})]})]})}function Qe({onSubmit:h,onCancel:l}){const[n,d]=a.useState({name:"",expires_in_days:90}),w=p=>{p.preventDefault(),h(n)};return e.jsxs("form",{onSubmit:w,className:"p-4 space-y-4",children:[e.jsx(m,{label:"Key Name",value:n.name,onChange:p=>d(o=>({...o,name:p.target.value})),placeholder:"My API Key",required:!0,helperText:"A descriptive name to identify this key"}),e.jsx(m,{label:"Expires in (days)",type:"number",value:n.expires_in_days,onChange:p=>d(o=>({...o,expires_in_days:parseInt(p.target.value)})),min:"1",max:"365",helperText:"Key will expire after this many days (1-365)"}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-border",children:[e.jsx(i,{type:"button",variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(i,{type:"submit",children:"Create Key"})]})]})}export{gt as default};
