const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DZhoaXx-.js","assets/index-vswyqp58.js","assets/radix-B6Y-MRu0.js","assets/vendor-DEQSVNfj.js","assets/index-_glI2Qgx.css","assets/account.service-DlHdLrXD.js","assets/dashboard.service-X6OT3p5u.js","assets/certificates.service-DOwLiyPH.js","assets/cas.service-CAbj5j2-.js","assets/csrs.service-B5ZOA1gt.js","assets/templates.service-CpYEtCuT.js","assets/groupsService-DOlTM9fo.js","assets/system.service-q0xuQUf8.js","assets/acme.service-CvmaI0ze.js","assets/scep.service-VPi3T2o7.js","assets/crl.service-Z976FtHj.js","assets/truststore.service-DLtx8kP5.js","assets/audit.service-C2V-F5Hn.js","assets/Globe.es-CtUoIY1T.js","assets/Export.es-ZKf2NYml.js","assets/FileArrowUp.es-C-xJex7r.js","assets/FloppyDisk.es-CJlG_KS3.js","assets/DetailCard-BKBzFg8i.js","assets/CaretDown.es-DuThAI6u.js","assets/Fingerprint.es-a52JDt2Q.js","assets/Badge-CZ5NzBfK.js","assets/HelpModal-BnkmCwhU.js","assets/Modal-7_eTIvz3.js","assets/Select-PwXyFoxR.js","assets/Link.es-DqHpjeM6.js","assets/HelpCard-BINCqYIf.js"])))=>i.map(i=>d[i]);
import{G as z,c as be,T as _e,y as ce,k as Fe,a as oe,C as de,u as ke,d as J,m as Q,h as F,I as j,B as pe,l as Le,i as Re,_ as me}from"./index-vswyqp58.js";import{j as e}from"./radix-B6Y-MRu0.js";import{a as t,e as Oe}from"./vendor-DEQSVNfj.js";import{b as $e}from"./Globe.es-CtUoIY1T.js";import{s as G,l as K}from"./Export.es-ZKf2NYml.js";import{c as D}from"./FileArrowUp.es-C-xJex7r.js";import{m as De}from"./FloppyDisk.es-CJlG_KS3.js";import{m as Te,D as Ke,f as Z,g as m,h as M,i as _}from"./DetailCard-BKBzFg8i.js";import{H as ze}from"./HelpModal-BnkmCwhU.js";import{B as f}from"./Badge-CZ5NzBfK.js";import{S as Be}from"./Select-PwXyFoxR.js";import{c as Ue}from"./Link.es-DqHpjeM6.js";import{H as T}from"./HelpCard-BINCqYIf.js";import{c as qe}from"./certificates.service-DOwLiyPH.js";import{c as xe}from"./cas.service-CAbj5j2-.js";const Je=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216.49,184.49l-32,32a12,12,0,0,1-17-17L179,188H48a12,12,0,0,1,0-24H179l-11.52-11.51a12,12,0,0,1,17-17l32,32A12,12,0,0,1,216.49,184.49Zm-145-64a12,12,0,0,0,17-17L77,92H208a12,12,0,0,0,0-24H77L88.49,56.49a12,12,0,0,0-17-17l-32,32a12,12,0,0,0,0,17Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,80v96H48V80Z",opacity:"0.2"}),t.createElement("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M42.34,85.66a8,8,0,0,1,0-11.32l32-32A8,8,0,0,1,88,48V72H208a8,8,0,0,1,0,16H88v24a8,8,0,0,1-13.66,5.66Zm171.32,84.68-32-32A8,8,0,0,0,168,144v24H48a8,8,0,0,0,0,16H168v24a8,8,0,0,0,13.66,5.66l32-32A8,8,0,0,0,213.66,170.34Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M212.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48-8.48L193.51,182H48a6,6,0,0,1,0-12H193.51l-21.75-21.76a6,6,0,0,1,8.48-8.48ZM75.76,116.24a6,6,0,0,0,8.48-8.48L62.49,86H208a6,6,0,0,0,0-12H62.49L84.24,52.24a6,6,0,0,0-8.48-8.48l-32,32a6,6,0,0,0,0,8.48Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,181.66l-32,32a8,8,0,0,1-11.32-11.32L188.69,184H48a8,8,0,0,1,0-16H188.69l-18.35-18.34a8,8,0,0,1,11.32-11.32l32,32A8,8,0,0,1,213.66,181.66Zm-139.32-64a8,8,0,0,0,11.32-11.32L67.31,88H208a8,8,0,0,0,0-16H67.31L85.66,53.66A8,8,0,0,0,74.34,42.34l-32,32a8,8,0,0,0,0,11.32Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M210.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66-5.66L198.34,180H48a4,4,0,0,1,0-8H198.34l-25.17-25.17a4,4,0,0,1,5.66-5.66ZM77.17,114.83a4,4,0,0,0,5.66-5.66L57.66,84H208a4,4,0,0,0,0-8H57.66L82.83,50.83a4,4,0,0,0-5.66-5.66l-32,32a4,4,0,0,0,0,5.66Z"}))]]),Ge=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M196.49,151.51a12,12,0,0,1-17,17L168,157v51a12,12,0,0,1-24,0V157l-11.51,11.52a12,12,0,1,1-17-17l32-32a12,12,0,0,1,17,0ZM160,36A92.08,92.08,0,0,0,79,84.37,68,68,0,1,0,72,220h28a12,12,0,0,0,0-24H72a44,44,0,0,1-1.81-87.95A91.7,91.7,0,0,0,68,128a12,12,0,0,0,24,0,68,68,0,1,1,132.6,21.29,12,12,0,1,0,22.8,7.51A92.06,92.06,0,0,0,160,36Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M240,128a80,80,0,0,1-80,80H72A56,56,0,1,1,85.92,97.74l0,.1A80,80,0,0,1,240,128Z",opacity:"0.2"}),t.createElement("path",{d:"M178.34,165.66,160,147.31V208a8,8,0,0,1-16,0V147.31l-18.34,18.35a8,8,0,0,1-11.32-11.32l32-32a8,8,0,0,1,11.32,0l32,32a8,8,0,0,1-11.32,11.32ZM160,40A88.08,88.08,0,0,0,81.29,88.68,64,64,0,1,0,72,216h40a8,8,0,0,0,0-16H72a48,48,0,0,1,0-96c1.1,0,2.2,0,3.29.12A88,88,0,0,0,72,128a8,8,0,0,0,16,0,72,72,0,1,1,100.8,66,8,8,0,0,0,3.2,15.34,7.9,7.9,0,0,0,3.2-.68A88,88,0,0,0,160,40Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M247.93,124.52C246.11,77.54,207.07,40,160.06,40A88.1,88.1,0,0,0,81.29,88.67h0A87.48,87.48,0,0,0,72,127.73,8.18,8.18,0,0,1,64.57,136,8,8,0,0,1,56,128a103.66,103.66,0,0,1,5.34-32.92,4,4,0,0,0-4.75-5.18A64.09,64.09,0,0,0,8,152c0,35.19,29.75,64,65,64H160A88.09,88.09,0,0,0,247.93,124.52Zm-50.27,9.14a8,8,0,0,1-11.32,0L168,115.31V176a8,8,0,0,1-16,0V115.31l-18.34,18.35a8,8,0,0,1-11.32-11.32l32-32a8,8,0,0,1,11.32,0l32,32A8,8,0,0,1,197.66,133.66Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M188.24,164.24a6,6,0,0,1-8.48,0L158,142.49V208a6,6,0,0,1-12,0V142.49l-21.76,21.75a6,6,0,0,1-8.48-8.48l32-32a6,6,0,0,1,8.48,0l32,32A6,6,0,0,1,188.24,164.24ZM160,42A86.1,86.1,0,0,0,82.43,90.88,62,62,0,1,0,72,214h40a6,6,0,0,0,0-12H72a50,50,0,0,1,0-100,50.68,50.68,0,0,1,5.91.36A85.54,85.54,0,0,0,74,128a6,6,0,0,0,12,0,74,74,0,1,1,103.6,67.85,6,6,0,0,0,4.8,11A86,86,0,0,0,160,42Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M178.34,165.66,160,147.31V208a8,8,0,0,1-16,0V147.31l-18.34,18.35a8,8,0,0,1-11.32-11.32l32-32a8,8,0,0,1,11.32,0l32,32a8,8,0,0,1-11.32,11.32ZM160,40A88.08,88.08,0,0,0,81.29,88.68,64,64,0,1,0,72,216h40a8,8,0,0,0,0-16H72a48,48,0,0,1,0-96c1.1,0,2.2,0,3.29.12A88,88,0,0,0,72,128a8,8,0,0,0,16,0,72,72,0,1,1,100.8,66,8,8,0,0,0,3.2,15.34,7.9,7.9,0,0,0,3.2-.68A88,88,0,0,0,160,40Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M186.83,162.83a4,4,0,0,1-5.66,0L156,137.66V208a4,4,0,0,1-8,0V137.66l-25.17,25.17a4,4,0,0,1-5.66-5.66l32-32a4,4,0,0,1,5.66,0l32,32A4,4,0,0,1,186.83,162.83ZM160,44A84.09,84.09,0,0,0,83.61,93.13,60,60,0,1,0,72,212h40a4,4,0,0,0,0-8H72a52,52,0,1,1,8.57-103.27A83.45,83.45,0,0,0,76,128a4,4,0,0,0,8,0,76,76,0,1,1,106.4,69.68,4,4,0,0,0,1.6,7.66,3.92,3.92,0,0,0,1.6-.33A84,84,0,0,0,160,44Z"}))]]),Qe=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216.49,79.52l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.52ZM160,57l23,23H160ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,88H152V32Z",opacity:"0.2"}),t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM152,88V44l44,44Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M210.83,85.17l-56-56A4,4,0,0,0,152,28H56A12,12,0,0,0,44,40V216a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V88A4,4,0,0,0,210.83,85.17ZM156,41.65,198.34,84H156ZM200,220H56a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h92V88a4,4,0,0,0,4,4h52V216A4,4,0,0,1,200,220Z"}))]]),Xe=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M225.15,197.71,164,95.81V44h4a12,12,0,0,0,0-24H88a12,12,0,0,0,0,24h4V95.81L30.85,197.71A20,20,0,0,0,48,228H208a20,20,0,0,0,17.15-30.29ZM140,44V99.14a12,12,0,0,0,1.71,6.17l35.13,58.54c-10.79.86-25.15-1.31-43.42-10.56-14-7.08-27.46-11.33-40.27-12.76l21.14-35.22A12,12,0,0,0,116,99.14V44ZM55.06,204,79,164.19c13-1.11,27.62,2.42,43.62,10.52,19.61,9.92,36.25,13.31,49.85,13.31A75.44,75.44,0,0,0,190.11,186l10.83,18Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,216H48a8,8,0,0,1-6.86-12.12l30.48-50.8h0c13.23-2.48,32-1.41,56.37,10.92,32.25,16.33,54.75,12.91,67.5,7.65h0l19.34,32.23A8,8,0,0,1,208,216Z",opacity:"0.2"}),t.createElement("path",{d:"M221.69,199.77,160,96.92V40h8a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16h8V96.92L34.31,199.77A16,16,0,0,0,48,224H208a16,16,0,0,0,13.72-24.23ZM110.86,103.25A7.93,7.93,0,0,0,112,99.14V40h32V99.14a7.93,7.93,0,0,0,1.14,4.11L183.36,167c-12,2.37-29.07,1.37-51.75-10.11-15.91-8.05-31.05-12.32-45.22-12.81ZM48,208l28.54-47.58c14.25-1.73,30.31,1.85,47.82,10.72,19,9.61,35,12.88,48,12.88a69.89,69.89,0,0,0,19.55-2.7L208,208Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M221.69,199.77,160,96.92V40h8a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16h8V96.92L34.31,199.77A16,16,0,0,0,48,224H208a16,16,0,0,0,13.72-24.23Zm-90.08-42.91c-15.91-8.05-31.05-12.32-45.22-12.81l24.47-40.8A7.93,7.93,0,0,0,112,99.14V40h32V99.14a7.93,7.93,0,0,0,1.14,4.11L183.36,167C171.4,169.34,154.29,168.34,131.61,156.86Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M220,200.8,158,97.48V38h10a6,6,0,0,0,0-12H88a6,6,0,0,0,0,12H98V97.48L36,200.8A14,14,0,0,0,48,222H208a14,14,0,0,0,12-21.2ZM109.15,102.23a6,6,0,0,0,.85-3.09V38h36V99.14a6,6,0,0,0,.85,3.09l39.65,66.08c-12.41,3.16-30.86,3-55.79-9.66-16.94-8.58-33-12.8-47.83-12.64ZM209.72,209a2,2,0,0,1-1.74,1H48a2,2,0,0,1-1.71-3l29-48.41c14.89-2.08,31.68,1.55,49.94,10.79C144,178.8,159.67,182,172.42,182A67.89,67.89,0,0,0,192.89,179l16.8,28A2,2,0,0,1,209.72,209Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M221.69,199.77,160,96.92V40h8a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16h8V96.92L34.31,199.77A16,16,0,0,0,48,224H208a16,16,0,0,0,13.72-24.23ZM110.86,103.25A7.93,7.93,0,0,0,112,99.14V40h32V99.14a7.93,7.93,0,0,0,1.14,4.11L183.36,167c-12,2.37-29.07,1.37-51.75-10.11-15.91-8.05-31.05-12.32-45.22-12.81ZM48,208l28.54-47.58c14.25-1.74,30.31,1.85,47.82,10.72,19,9.61,35,12.88,48,12.88a69.89,69.89,0,0,0,19.55-2.7L208,208Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M218.27,201.83,156,98V36h12a4,4,0,0,0,0-8H88a4,4,0,0,0,0,8h12V98L37.73,201.83A12,12,0,0,0,48,220H208a12,12,0,0,0,10.29-18.17ZM107.43,101.2a4.07,4.07,0,0,0,.57-2.06V36h40V99.14a4.07,4.07,0,0,0,.57,2.06l41,68.33c-12.76,3.94-32.54,4.68-59.75-9.1-18-9.14-35-13.24-50.54-12.29ZM211.46,210a3.94,3.94,0,0,1-3.48,2H48a4,4,0,0,1-3.43-6.06l29.53-49.21c15.54-2.43,33.05,1.21,52.07,10.84C144.54,176.86,160,180,172.42,180a65,65,0,0,0,21.36-3.46l17.63,29.38A3.92,3.92,0,0,1,211.46,210Z"}))]]),je=t.forwardRef((l,r)=>t.createElement(z,{ref:r,...l,weights:Je}));je.displayName="ArrowsLeftRightIcon";const Ye=je,ve=t.forwardRef((l,r)=>t.createElement(z,{ref:r,...l,weights:Ge}));ve.displayName="CloudArrowUpIcon";const Ae=ve,Ce=t.forwardRef((l,r)=>t.createElement(z,{ref:r,...l,weights:Qe}));Ce.displayName="FileIcon";const ue=Ce,Ee=t.forwardRef((l,r)=>t.createElement(z,{ref:r,...l,weights:Xe}));Ee.displayName="FlaskIcon";const We=Ee;function fe({onExport:l,disabled:r=!1,formats:H=["pem","pem-key","pem-chain","pem-full","der","pkcs12"],hasPrivateKey:h=!0}){const{showPrompt:B}=be(),o={pem:{label:"PEM (Certificate only)",icon:e.jsx(G,{size:16}),format:"pem",options:{}},"pem-key":{label:"PEM + Private Key",icon:e.jsx(Fe,{size:16}),format:"pem",options:{includeKey:!0},requiresKey:!0},"pem-chain":{label:"PEM + CA Chain",icon:e.jsx(Ue,{size:16}),format:"pem",options:{includeChain:!0}},"pem-full":{label:"Full Bundle (Cert + Key + Chain)",icon:e.jsx(ce,{size:16}),format:"pem",options:{includeKey:!0,includeChain:!0},requiresKey:!0},der:{label:"DER (Binary)",icon:e.jsx(G,{size:16}),format:"der",options:{}},pkcs12:{label:"PKCS#12 (.p12)",icon:e.jsx(ce,{size:16}),format:"pkcs12",options:{password:!0},requiresKey:!0}},c=H.filter(g=>{const i=o[g];return!(!i||i.requiresKey&&!h)}).map(g=>{const i=o[g];return{label:i.label,icon:i.icon,onClick:async()=>{if(i.options.password){const y=await B("Enter password for PKCS#12 file:",{title:"Export PKCS#12",type:"password",placeholder:"Password",confirmText:"Export"});y&&l(i.format,{...i.options,password:y})}else l(i.format,i.options)}}});return e.jsx(_e,{trigger:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{size:14}),"Export"]}),items:c,disabled:r,size:"sm"})}const he={async test(l){return oe.request("/import/opnsense/test",{method:"POST",body:JSON.stringify(l)})},async import(l){return oe.request("/import/opnsense/import",{method:"POST",body:JSON.stringify(l)})}},ge="opnsense_config",ye=[{id:"import-cert",label:"Import Certificate",icon:Q,category:"import"},{id:"import-ca",label:"Import CA",icon:F,category:"import"},{id:"import-opnsense",label:"OpnSense",icon:Ae,category:"import"},{id:"export-certs",label:"Export Certificates",icon:K,category:"export"},{id:"export-cas",label:"Export CAs",icon:K,category:"export"}];function et(){const{showSuccess:l,showError:r}=be(),H=Oe(),[h,B]=t.useState("import-cert"),[o,c]=t.useState(!1),g=t.useRef(null),i=t.useRef(null),[y,I]=t.useState(""),[E,V]=t.useState(""),[x,v]=t.useState(null),[u,A]=t.useState(""),[k,we]=t.useState([]),[L,X]=t.useState("auto"),[w,Y]=t.useState(""),[R,W]=t.useState("443"),[N,ee]=t.useState(""),[S,te]=t.useState(""),[b,O]=t.useState(null),[ae,$]=t.useState([]);t.useEffect(()=>{const a=localStorage.getItem(ge);if(a)try{const s=JSON.parse(a);Y(s.host||""),W(s.port||"443"),ee(s.api_key||""),te(s.api_secret||"")}catch{}Ne()},[]);const Ne=async()=>{try{const a=await xe.getAll();we(a.data||[])}catch{}},se=async()=>{if(!x&&!u.trim()){r("Please select a file or paste PEM content");return}c(!0);try{const a=new FormData;x?a.append("file",x):a.append("pem_content",u),y&&a.append("name",y),E&&a.append("password",E),L&&L!=="auto"&&a.append("ca_id",L),a.append("format","auto");const s=await qe.import(a);l(s.message||"Certificate imported successfully"),v(null),I(""),V(""),A(""),X("auto"),g.current&&(g.current.value=""),s.data&&(s.message?.includes("CA")?H(`/cas?selected=${s.data.id}`):H(`/certificates?selected=${s.data.id}`))}catch(a){r(a.message||"Failed to import certificate")}finally{c(!1)}},re=async()=>{if(!x&&!u.trim()){r("Please select a file or paste PEM content");return}c(!0);try{const a=new FormData;x?a.append("file",x):a.append("pem_content",u),y&&a.append("name",y),E&&a.append("password",E),a.append("format","auto");const s=await xe.import(a);l(s.message||"CA imported successfully"),v(null),I(""),V(""),A(""),i.current&&(i.current.value=""),s.data&&H(`/cas?selected=${s.data.id}`)}catch(a){r(a.message||"Failed to import CA")}finally{c(!1)}},Se=()=>{if(!w||!N||!S){r("Please fill all fields");return}const a={host:w,port:R,api_key:N,api_secret:S};localStorage.setItem(ge,JSON.stringify(a)),l("Configuration saved")},Me=async a=>{c(!0);try{const{certificatesService:s}=await me(async()=>{const{certificatesService:n}=await import("./index-DZhoaXx-.js");return{certificatesService:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])),p=(await s.getAll({per_page:1e3})).data||[];if(p.length===0){r("No certificates to export");return}const U=p.map(n=>({id:n.id,common_name:n.common_name,serial_number:n.serial_number,status:n.status,valid_from:n.valid_from,valid_until:n.valid_until,issuer:n.issuer_name})),q=new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),P=URL.createObjectURL(q),C=document.createElement("a");C.href=P,C.download=`certificates_export_${new Date().toISOString().slice(0,10)}.json`,C.click(),URL.revokeObjectURL(P),l(`Exported ${p.length} certificates`)}catch{r("Failed to export certificates")}finally{c(!1)}},He=async a=>{c(!0);try{const{casService:s}=await me(async()=>{const{casService:n}=await import("./index-DZhoaXx-.js");return{casService:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])),p=(await s.getAll()).data||[];if(p.length===0){r("No CAs to export");return}const U=p.map(n=>({id:n.id,name:n.name,common_name:n.common_name,ca_type:n.ca_type,valid_from:n.valid_from,valid_until:n.valid_until,serial_number:n.serial_number})),q=new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),P=URL.createObjectURL(q),C=document.createElement("a");C.href=P,C.download=`cas_export_${new Date().toISOString().slice(0,10)}.json`,C.click(),URL.revokeObjectURL(P),l(`Exported ${p.length} CAs`)}catch{r("Failed to export CAs")}finally{c(!1)}},Ie=async()=>{if(!w||!N||!S){r("Please fill all fields");return}c(!0);try{const a=await he.test({host:w,port:parseInt(R),api_key:N,api_secret:S,verify_ssl:!1});a.success?(O(a.stats),$(a.items||[]),l(`Found ${a.stats.certificates} certificates and ${a.stats.cas} CAs`)):(r(a.error||"Connection failed"),O(null),$([]))}catch(a){r(a.message||"Failed to test connection"),O(null),$([])}finally{c(!1)}},Ve=async()=>{if(!b||ae.length===0){r("Please test connection first");return}c(!0);try{const a=ae.map(d=>d.id),s=await he.import({host:w,port:parseInt(R),api_key:N,api_secret:S,verify_ssl:!1,items:a});if(s.success){const d=s.imported.cas+s.imported.certificates,p=s.skipped||0;d>0?l(`Imported ${d} items (${s.imported.cas} CAs, ${s.imported.certificates} certificates)${p>0?`, ${p} skipped`:""}`):p>0?l(`All ${p} items already exist (skipped)`):r("No items were imported"),O(null),$([])}else r(s.error||"Import failed")}catch(a){r(a.message||"Failed to import")}finally{c(!1)}},Pe=e.jsxs("div",{className:"space-y-4",children:[e.jsxs(de,{className:"p-4 space-y-3 bg-gradient-to-br from-accent-primary/5 to-transparent",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx($e,{size:16,className:"text-accent-primary"}),"Quick Stats"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:k.length}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Available CAs"})]}),e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold status-success-text",children:"âœ“"}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Ready"})]})]})]}),e.jsxs(de,{className:"p-4 space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Supported Formats"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(f,{variant:"blue",size:"sm",children:"PEM"}),e.jsx(f,{variant:"purple",size:"sm",children:"DER"}),e.jsx(f,{variant:"emerald",size:"sm",children:"PKCS#12"}),e.jsx(f,{variant:"orange",size:"sm",children:"CRT/CER"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{variant:"info",title:"Import Certificates",children:"Import certificates from files (.pem, .crt, .der, .p12) or paste PEM content directly. Certificates are automatically linked to their issuing CA when possible."}),e.jsx(T,{variant:"tip",title:"Import CAs",children:"Import existing Certificate Authorities to manage certificates issued by external PKIs. The CA hierarchy is preserved during import."}),e.jsx(T,{variant:"info",title:"OpnSense Import",children:"Connect to an OpnSense firewall to import all certificates and CAs. Requires API credentials with appropriate permissions."}),e.jsx(T,{variant:"warning",title:"Export Security",children:"Exported PKCS#12 files may contain private keys. Store them securely and use strong passwords when exporting sensitive certificates."})]})]}),[Ze,le]=t.useState(!1),{isMobile:ne}=ke(),ie=a=>{B(a),v(null),I(""),V(""),A("")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full w-full",children:[e.jsxs("div",{className:"shrink-0 border-b border-border bg-bg-secondary",children:[e.jsxs("div",{className:"px-4 md:px-6 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-accent-primary to-accent-primary/70 flex items-center justify-center shrink-0",children:e.jsx(Ye,{size:18,weight:"bold",className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Import & Export"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Transfer certificates and CAs"})]})]}),e.jsxs("button",{onClick:()=>le(!0),className:J("flex items-center gap-1.5 px-2.5 py-1.5 rounded-md transition-all","bg-accent-primary/10 border border-accent-primary/30","text-accent-primary hover:bg-accent-primary/20","text-xs font-medium"),children:[e.jsx(Te,{size:14,weight:"bold"}),e.jsx("span",{className:"hidden sm:inline",children:"Help"})]})]}),e.jsx("div",{className:"px-4 md:px-6 overflow-x-auto scrollbar-hide",children:e.jsxs("div",{className:"flex gap-1 min-w-max pb-0 items-center",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-wide text-text-tertiary mr-2 hidden md:inline",children:"Import"}),ye.filter(a=>a.category==="import").map(a=>{const s=a.icon,d=h===a.id;return e.jsxs("button",{onClick:()=>ie(a.id),className:J("flex items-center gap-2 px-3 py-2 rounded-t-lg text-sm font-medium transition-all","border-b-2 -mb-px",d?"border-accent-primary text-accent-primary bg-bg-primary":"border-transparent text-text-secondary hover:text-text-primary hover:bg-bg-tertiary/50"),children:[e.jsx(s,{size:16,weight:d?"fill":"regular"}),e.jsx("span",{className:ne?"hidden":"",children:a.label})]},a.id)}),e.jsx("div",{className:"h-6 w-px bg-border mx-2"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wide text-text-tertiary mr-2 hidden md:inline",children:"Export"}),ye.filter(a=>a.category==="export").map(a=>{const s=a.icon,d=h===a.id;return e.jsxs("button",{onClick:()=>ie(a.id),className:J("flex items-center gap-2 px-3 py-2 rounded-t-lg text-sm font-medium transition-all","border-b-2 -mb-px",d?"border-accent-primary text-accent-primary bg-bg-primary":"border-transparent text-text-secondary hover:text-text-primary hover:bg-bg-tertiary/50"),children:[e.jsx(s,{size:16,weight:d?"fill":"regular"}),e.jsx("span",{className:ne?"hidden":"",children:a.label})]},a.id)})]})})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"max-w-4xl mx-auto p-4 md:p-6",children:e.jsxs(Ke,{children:[h==="import-cert"&&e.jsxs("div",{className:"max-w-3xl space-y-0",children:[e.jsx(Z,{icon:Q,title:"Import Certificate",subtitle:"Import certificates from files or paste PEM content",badge:e.jsx(f,{variant:"blue",children:"PEM / DER / PKCS#12"}),stats:[{icon:ue,label:"Formats",value:".pem, .crt, .der, .p12"},{icon:F,label:"Available CAs",value:k.length}],actions:[{label:"Import",icon:D,onClick:se,disabled:o||!x&&!u.trim()}]}),e.jsx(m,{title:"Certificate File",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{ref:g,type:"file",accept:".pem,.crt,.cer,.der,.p12,.pfx",onChange:a=>{v(a.target.files[0]),A("")},className:"w-full text-sm text-text-secondary file:mr-4 file:py-1.5 file:px-3 file:rounded-md file:border-0 file:text-sm file:bg-accent-primary file:text-white hover:file:bg-accent-primary/80"}),e.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Accepted: .pem, .crt, .cer, .der, .p12, .pfx"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 border-t border-border"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"OR paste PEM content"}),e.jsx("div",{className:"flex-1 border-t border-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] md:text-xs text-text-tertiary uppercase tracking-wide mb-1",children:"Paste PEM Content"}),e.jsx("textarea",{value:u,onChange:a=>{A(a.target.value),v(null),g.current&&(g.current.value="")},placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`,rows:5,className:"w-full px-2 py-1.5 bg-bg-secondary border border-border rounded-md text-sm text-text-primary font-mono placeholder-text-secondary focus:outline-none focus:ring-1 focus:ring-accent-primary resize-y"})]})]})}),e.jsx(m,{title:"Options",children:e.jsxs(M,{children:[e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"Display Name (optional)",value:y,onChange:a=>I(a.target.value),placeholder:"My Certificate"})}),e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"Password (for PKCS#12)",type:"password",value:E,onChange:a=>V(a.target.value),placeholder:"Enter password if needed"})}),e.jsx("div",{className:"col-span-full",children:e.jsx(Be,{label:"Link to CA (optional)",value:L,onChange:a=>X(a.target.value),options:[{value:"auto",label:"Auto-detect from issuer"},...k.map(a=>({value:a.id.toString(),label:a.name}))]})})]})}),e.jsx("div",{className:"pt-4 border-t border-border/50",children:e.jsxs(pe,{onClick:se,disabled:o||!x&&!u.trim(),className:"w-full md:w-auto",children:[e.jsx(D,{size:18}),o?"Importing...":"Import Certificate"]})})]}),h==="import-ca"&&e.jsxs("div",{className:"max-w-3xl space-y-0",children:[e.jsx(Z,{icon:F,title:"Import Certificate Authority",subtitle:"Import a CA certificate from a file or paste PEM content",badge:e.jsx(f,{variant:"emerald",children:"CA Import"}),stats:[{icon:ue,label:"Formats",value:"PEM, DER, PKCS#12"}],actions:[{label:"Import CA",icon:D,onClick:re,disabled:o||!x&&!u.trim()}]}),e.jsx(m,{title:"CA Certificate File",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{ref:i,type:"file",accept:".pem,.crt,.cer,.der,.p12,.pfx",onChange:a=>{v(a.target.files[0]),A("")},className:"w-full text-sm text-text-secondary file:mr-4 file:py-1.5 file:px-3 file:rounded-md file:border-0 file:text-sm file:bg-accent-primary file:text-white hover:file:bg-accent-primary/80"}),e.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Accepted: .pem, .crt, .cer, .der, .p12, .pfx"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 border-t border-border"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"OR paste PEM content"}),e.jsx("div",{className:"flex-1 border-t border-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] md:text-xs text-text-tertiary uppercase tracking-wide mb-1",children:"Paste PEM Content"}),e.jsx("textarea",{value:u,onChange:a=>{A(a.target.value),v(null),i.current&&(i.current.value="")},placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`,rows:5,className:"w-full px-2 py-1.5 bg-bg-secondary border border-border rounded-md text-sm text-text-primary font-mono placeholder-text-secondary focus:outline-none focus:ring-1 focus:ring-accent-primary resize-y"})]})]})}),e.jsx(m,{title:"Options",children:e.jsxs(M,{children:[e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"Display Name (optional)",value:y,onChange:a=>I(a.target.value),placeholder:"My Root CA"})}),e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"Password (for PKCS#12)",type:"password",value:E,onChange:a=>V(a.target.value),placeholder:"Enter password if needed"})})]})}),e.jsx("div",{className:"pt-4 border-t border-border/50",children:e.jsxs(pe,{onClick:re,disabled:o||!x&&!u.trim(),className:"w-full md:w-auto",children:[e.jsx(D,{size:18}),o?"Importing...":"Import CA"]})})]}),h==="export-certs"&&e.jsxs("div",{className:"max-w-3xl space-y-0",children:[e.jsx(Z,{icon:K,title:"Export All Certificates",subtitle:"Download all certificates in a single archive",badge:e.jsx(f,{variant:"purple",children:"Bulk Export"})}),e.jsx(m,{title:"Available Formats",children:e.jsxs(M,{children:[e.jsx(_,{label:"PEM",value:"Base64 encoded, widely compatible"}),e.jsx(_,{label:"DER",value:"Binary format, compact"}),e.jsx(_,{label:"PKCS#12",value:"Includes private keys (password protected)"})]})}),e.jsx(m,{title:"Export",noBorder:!0,children:e.jsx(fe,{onExport:Me,formats:["pem","der","pkcs12"]})})]}),h==="export-cas"&&e.jsxs("div",{className:"max-w-3xl space-y-0",children:[e.jsx(Z,{icon:K,title:"Export All Certificate Authorities",subtitle:"Download all CAs including their hierarchy",badge:e.jsx(f,{variant:"emerald",children:"CA Export"}),stats:[{icon:F,label:"Total CAs",value:k.length}]}),e.jsx(m,{title:"Available Formats",children:e.jsxs(M,{children:[e.jsx(_,{label:"PEM",value:"Base64 encoded, widely compatible"}),e.jsx(_,{label:"DER",value:"Binary format, compact"})]})}),e.jsx(m,{title:"Export",noBorder:!0,children:e.jsx(fe,{onExport:He,formats:["pem","der"]})})]}),h==="import-opnsense"&&e.jsxs("div",{className:"max-w-3xl space-y-0",children:[e.jsx(Z,{icon:Ae,title:"Import from OpnSense",subtitle:"Connect to OpnSense API to import certificates and CAs",badge:b?e.jsx(f,{variant:"emerald",children:"Connected"}):e.jsx(f,{variant:"secondary",children:"Not Connected"}),stats:b?[{icon:F,label:"CAs Found",value:b.cas},{icon:Q,label:"Certificates",value:b.certificates}]:void 0,actions:[{label:"Save Config",icon:De,onClick:Se,variant:"secondary",disabled:o},{label:"Test",icon:We,onClick:Ie,variant:"secondary",disabled:o},{label:"Import",icon:Le,onClick:Ve,disabled:o||!b}]}),e.jsx(m,{title:"Connection Settings",children:e.jsxs(M,{children:[e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"OpnSense Host",value:w,onChange:a=>Y(a.target.value),placeholder:"192.168.1.1"})}),e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"Port",value:R,onChange:a=>W(a.target.value),placeholder:"443"})})]})}),e.jsx(m,{title:"API Credentials",children:e.jsxs(M,{children:[e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"API Key",value:N,onChange:a=>ee(a.target.value),placeholder:"Enter API Key"})}),e.jsx("div",{className:"col-span-full md:col-span-1",children:e.jsx(j,{label:"API Secret",type:"password",value:S,onChange:a=>te(a.target.value),placeholder:"Enter API Secret"})})]})}),b&&e.jsx(m,{title:"Connection Status",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 status-success-bg status-success-border border rounded-lg",children:[e.jsx(Re,{size:24,className:"status-success-text",weight:"fill"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold status-success-text",children:"Connection Successful"}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Found ",b.cas," CAs and ",b.certificates," certificates ready to import"]})]})]})})]})]})})})]}),e.jsx(ze,{open:Ze,onClose:()=>le(!1),title:"Import & Export Help",children:Pe})]})}const ht=Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"}));export{ht as I,he as o};
