# ============================================================================
# UCM v1.8.0-beta - Environment Configuration
# ============================================================================
# Copy this file to .env and customize for your environment
# 
# For Docker deployments, all settings can be overridden via ENV variables
# with UCM_ prefix (e.g., UCM_FQDN=ucm.example.com)
# ============================================================================

# ============================================================================
# CORE SETTINGS
# ============================================================================

# Fully Qualified Domain Name (REQUIRED for Docker)
# This is critical for correct URL generation and HTTPS certificates
# Examples: ucm.example.com, ca.company.local
FQDN=ucm.local

# Network Ports
HTTPS_PORT=8443
HTTP_PORT=8080

# Debug Mode (true/false)
# Set to false in production for better performance and security
DEBUG=false

# Logging Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Application Secret Key (REQUIRED)
# Used for session encryption and CSRF protection
# Generate with: python3 -c 'import secrets; print(secrets.token_hex(32))'
SECRET_KEY=changeme-generate-random-secret-key-here

# JWT Secret Key (REQUIRED)
# Used for JWT token signing
# Generate with: python3 -c 'import secrets; print(secrets.token_hex(32))'
JWT_SECRET_KEY=changeme-generate-random-jwt-secret-here

# Session Timeout (seconds)
# How long before inactive users are logged out
# Default: 3600 (1 hour)
SESSION_TIMEOUT=3600

# JWT Token Expiration (seconds)
# How long JWT tokens remain valid
# Default: 86400 (24 hours)
JWT_EXPIRATION=86400

# ============================================================================
# DATABASE SETTINGS
# ============================================================================

# Database Path
# SQLite database location (relative to backend/)
DATABASE_PATH=data/ucm.db

# Automatic Backups (true/false)
# Creates database backup on application start
BACKUP_ENABLED=true

# Backup Retention (days)
# Delete backups older than this many days
BACKUP_RETENTION_DAYS=30

# ============================================================================
# SMTP / EMAIL SETTINGS
# ============================================================================

# SMTP Enabled (true/false)
# Enable email notifications for certificate expiration
SMTP_ENABLED=false

# SMTP Server
# Your mail server hostname
SMTP_SERVER=smtp.gmail.com

# SMTP Port
# Common: 587 (TLS), 465 (SSL), 25 (unencrypted)
SMTP_PORT=587

# SMTP Authentication
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# From Address
# Email address shown as sender
SMTP_FROM=noreply@ucm.local

# SMTP TLS (true/false)
# Use TLS/STARTTLS encryption
SMTP_TLS=true

# ============================================================================
# CACHING SETTINGS
# ============================================================================

# Cache Enabled (true/false)
# Improves performance by caching frequent queries
CACHE_ENABLED=true

# Cache Type
# Options: simple (in-memory), redis, memcached
CACHE_TYPE=simple

# Default Cache Timeout (seconds)
# How long cached data remains valid
CACHE_DEFAULT_TIMEOUT=300

# ============================================================================
# mTLS AUTHENTICATION SETTINGS
# ============================================================================

# mTLS Enabled (true/false)
# Allow users to login with client certificates
MTLS_ENABLED=false

# mTLS CA ID
# Database ID of the CA used for client certificate validation
# Leave empty to configure via web interface
MTLS_CA_ID=

# Require Certificate (true/false)
# If true, ONLY certificate authentication is allowed (no password login)
# WARNING: Ensure you have valid client certificates before enabling!
MTLS_REQUIRE_CERT=false

# ============================================================================
# CERTIFICATE DEFAULT SETTINGS
# ============================================================================

# Default Validity Period (days)
# How long newly created certificates are valid
DEFAULT_VALIDITY_DAYS=365

# Default Key Size (bits)
# RSA key size for new certificates
# Options: 2048, 4096, 8192
DEFAULT_KEY_SIZE=4096

# Default Hash Algorithm
# Signing algorithm for certificates
# Options: SHA256, SHA384, SHA512
DEFAULT_HASH_ALGO=SHA256

# ============================================================================
# ACME PROTOCOL SETTINGS
# ============================================================================

# ACME Enabled (true/false)
# Enable RFC 8555 ACME protocol for automated certificate issuance
ACME_ENABLED=true

# ACME Directory URL
# URL where ACME clients can discover service endpoints
# Auto-generated based on FQDN if not specified
ACME_DIRECTORY_URL=https://ucm.local:8443/acme/directory

# ============================================================================
# SCEP PROTOCOL SETTINGS
# ============================================================================

# SCEP Enabled (true/false)
# Enable Simple Certificate Enrollment Protocol
SCEP_ENABLED=true

# SCEP Challenge Password
# Static password for SCEP enrollment (leave empty to disable)
SCEP_CHALLENGE_PASSWORD=

# SCEP Auto-Approve (true/false)
# Automatically approve SCEP enrollment requests
SCEP_AUTO_APPROVE=false

# SCEP Certificate Lifetime (days)
SCEP_CERT_LIFETIME=365

# SCEP Key Size (bits)
SCEP_KEY_SIZE=2048

# SCEP Renewal Days
# Allow renewal this many days before expiration
SCEP_RENEWAL_DAYS=30

# ============================================================================
# HTTPS CERTIFICATE SETTINGS
# ============================================================================

# HTTPS Certificate Path
# Location of web server SSL certificate
HTTPS_CERT_PATH=data/https_cert.pem

# HTTPS Key Path
# Location of web server SSL private key
HTTPS_KEY_PATH=data/https_key.pem

# Auto-Generate Certificate (true/false)
# Generate self-signed certificate if none exists
HTTPS_AUTO_GENERATE=true

# ============================================================================
# INITIAL ADMIN USER
# ============================================================================

# Only used on first run, then managed via web UI
INITIAL_ADMIN_USERNAME=admin
INITIAL_ADMIN_PASSWORD=changeme123
INITIAL_ADMIN_EMAIL=admin@localhost

# ============================================================================
# RATE LIMITING
# ============================================================================

# Rate Limit Enabled (true/false)
RATE_LIMIT_ENABLED=true

# Requests Per Minute
RATE_LIMIT_PER_MINUTE=60

# Requests Per Hour
RATE_LIMIT_PER_HOUR=1000

# ============================================================================
# LOGGING
# ============================================================================

# Log Files
LOG_FILE=data/ucm.log
AUDIT_LOG_FILE=data/audit.log

# ============================================================================
# DOCKER-SPECIFIC SETTINGS
# ============================================================================

# Gunicorn Workers
# Formula: (2 x CPU cores) + 1
GUNICORN_WORKERS=4

# Gunicorn Worker Class
# Options: sync, gevent, eventlet
GUNICORN_WORKER_CLASS=sync

# Gunicorn Timeout (seconds)
GUNICORN_TIMEOUT=120

# ============================================================================
# NOTES
# ============================================================================
#
# 1. FQDN Configuration:
#    - CRITICAL for Docker: hostname detection doesn't work in containers
#    - Must match your reverse proxy configuration
#    - Used for ACME URLs, email links, and certificate generation
#
# 2. Security Best Practices:
#    - Generate unique SECRET_KEY and JWT_SECRET_KEY
#    - Use strong SMTP passwords or app-specific passwords
#    - Enable HTTPS with trusted certificates in production
#    - Change default admin password immediately after first login
#
# 3. mTLS Setup:
#    - Requires reverse proxy (Nginx/Apache) for browser support
#    - Configure CA first via web interface
#    - Test with curl before enabling for browsers
#    - Keep password authentication enabled until mTLS is tested
#
# 4. Performance Tuning:
#    - Adjust GUNICORN_WORKERS based on CPU cores
#    - Enable CACHE_ENABLED for better performance
#    - Set appropriate SESSION_TIMEOUT for your use case
#
# 5. Backup Strategy:
#    - Enable BACKUP_ENABLED for production
#    - Mount data/ directory as persistent volume
#    - Regularly backup the volume to external storage
#
# ============================================================================
