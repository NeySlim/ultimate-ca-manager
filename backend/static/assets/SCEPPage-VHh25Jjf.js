import{j as e}from"./radix-B6Y-MRu0.js";import{a as t}from"./vendor-DEQSVNfj.js";import{m as P}from"./ArrowsClockwise.es-DS70dwCP.js";import{G as ue,c as he,i as b,j as v,f as C,B as n,C as c,H as N,L as $,p as F,I as M,h as q,v as O,g as ge}from"./index-vswyqp58.js";import{n as U,b as je,a as be}from"./Globe.es-CtUoIY1T.js";import{C as fe,a as ve,b as H,c as ye,d as w,s as _}from"./DetailCard-BKBzFg8i.js";import{m as Ce}from"./ListBullets.es-D737ktVU.js";import{M as Ne}from"./Modal-7_eTIvz3.js";import{B as we}from"./Badge-CZ5NzBfK.js";import{E as Se}from"./EmptyState-B4dAc_K5.js";import{S as Le}from"./Select-PwXyFoxR.js";import{T as Ee}from"./Textarea-DuI5mbE0.js";import{H as Z}from"./HelpCard-BINCqYIf.js";import{R as Re}from"./ResponsiveDataTable-kYvH3TtM.js";import{R as Ae}from"./ResponsiveLayout-BgG2EW8C.js";import{c as ke}from"./cas.service-CAbj5j2-.js";import{s as o}from"./scep.service-VPi3T2o7.js";import{u as ze}from"./usePermission-B5db8pNS.js";import"./CaretDown.es-DuThAI6u.js";import"./Fingerprint.es-a52JDt2Q.js";import"./CaretUp.es-CYK8cpGg.js";import"./CaretRight.es-B3hFfvz_.js";import"./ArrowLeft.es-CZcTzWfI.js";import"./UnifiedPageHeader-Cbwye_R6.js";const Pe=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M137,168l11.52-11.51a12,12,0,0,0-17-17L120,151l-15-15,11.52-11.51a12,12,0,0,0-17-17L88,119,72.49,103.51a12,12,0,0,0-17,17L59,124,38.54,144.49a36,36,0,0,0,0,50.91l2.55,2.54L15.51,223.51a12,12,0,0,0,17,17l25.57-25.58,2.54,2.55a36.06,36.06,0,0,0,50.91,0L132,197l3.51,3.52a12,12,0,0,0,17-17ZM94.54,200.49a12,12,0,0,1-17,0L55.51,178.43a12,12,0,0,1,0-17L76,141l39,39Zm146-185a12,12,0,0,0-17,0L197.94,41.09l-2.54-2.55a36.05,36.05,0,0,0-50.91,0L124,59l-3.51-3.52a12,12,0,0,0-17,17l80,80a12,12,0,0,0,17-17L197,132l20.49-20.49a36,36,0,0,0,0-50.91l-2.55-2.54,25.58-25.57A12,12,0,0,0,240.49,15.51Zm-40,79L180,115,141,76l20.49-20.49a12,12,0,0,1,17,0l22.06,22.06a12,12,0,0,1,0,17Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M76,124l56,56-29,29a24,24,0,0,1-33.94,0L47,186.91A24,24,0,0,1,47,153ZM209,69.09,186.91,47A24,24,0,0,0,153,47L124,76l56,56,29-29A24,24,0,0,0,209,69.09Z",opacity:"0.2"}),t.createElement("path",{d:"M149.66,138.34a8,8,0,0,0-11.32,0L120,156.69,99.31,136l18.35-18.34a8,8,0,0,0-11.32-11.32L88,124.69,69.66,106.34a8,8,0,0,0-11.32,11.32L64.69,124,41.37,147.31a32,32,0,0,0,0,45.26l5.38,5.37-28.41,28.4a8,8,0,0,0,11.32,11.32l28.4-28.41,5.37,5.38a32,32,0,0,0,45.26,0L132,191.31l6.34,6.35a8,8,0,0,0,11.32-11.32L131.31,168l18.35-18.34A8,8,0,0,0,149.66,138.34Zm-52.29,65a16,16,0,0,1-22.62,0L52.69,181.25a16,16,0,0,1,0-22.62L76,135.31,120.69,180Zm140.29-185a8,8,0,0,0-11.32,0l-28.4,28.41-5.37-5.38a32.05,32.05,0,0,0-45.26,0L124,64.69l-6.34-6.35a8,8,0,0,0-11.32,11.32l80,80a8,8,0,0,0,11.32-11.32L191.31,132l23.32-23.31a32,32,0,0,0,0-45.26l-5.38-5.37,28.41-28.4A8,8,0,0,0,237.66,18.34Zm-34.35,79L180,120.69,135.31,76l23.32-23.31a16,16,0,0,1,22.62,0l22.06,22A16,16,0,0,1,203.31,97.37Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M149.66,149.66,131.31,168l18.35,18.34a8,8,0,0,1-11.32,11.32L132,191.31l-23.31,23.32a32.06,32.06,0,0,1-45.26,0l-5.37-5.38-28.4,28.41a8,8,0,0,1-11.32-11.32l28.41-28.4-5.38-5.37a32,32,0,0,1,0-45.26L64.69,124l-6.35-6.34a8,8,0,0,1,11.32-11.32L88,124.69l18.34-18.35a8,8,0,0,1,11.32,11.32L99.31,136,120,156.69l18.34-18.35a8,8,0,0,1,11.32,11.32Zm88-131.32a8,8,0,0,0-11.32,0l-28.4,28.41-5.37-5.38a32.05,32.05,0,0,0-45.26,0L124,64.69l-6.34-6.35a8,8,0,0,0-11.32,11.32l80,80a8,8,0,0,0,11.32-11.32L191.31,132l23.32-23.31a32,32,0,0,0,0-45.26l-5.38-5.37,28.41-28.4A8,8,0,0,0,237.66,18.34Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M148.24,139.76a6,6,0,0,0-8.48,0L120,159.51,96.49,136l19.75-19.76a6,6,0,0,0-8.48-8.48L88,127.51,68.24,107.76a6,6,0,0,0-8.48,8.48L67.51,124,42.79,148.73a30,30,0,0,0,0,42.42l6.78,6.79L19.76,227.76a6,6,0,1,0,8.48,8.48l29.82-29.81,6.79,6.78a30,30,0,0,0,42.42,0L132,188.49l7.76,7.75a6,6,0,0,0,8.48-8.48L128.49,168l19.75-19.76A6,6,0,0,0,148.24,139.76Zm-49.45,65a18,18,0,0,1-25.46,0L51.27,182.67a18,18,0,0,1,0-25.46L76,132.49,123.51,180Zm137.45-185a6,6,0,0,0-8.48,0L197.94,49.57l-6.79-6.78a30,30,0,0,0-42.42,0L124,67.51l-7.76-7.75a6,6,0,0,0-8.48,8.48l80,80a6,6,0,0,0,8.48-8.48L188.49,132l24.72-24.73a30,30,0,0,0,0-42.42l-6.78-6.79,29.81-29.82A6,6,0,0,0,236.24,19.76Zm-31.51,79L180,123.51,132.49,76l24.72-24.73a18,18,0,0,1,25.46,0l22.06,22.06a18,18,0,0,1,0,25.46Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M149.66,138.34a8,8,0,0,0-11.32,0L120,156.69,99.31,136l18.35-18.34a8,8,0,0,0-11.32-11.32L88,124.69,69.66,106.34a8,8,0,0,0-11.32,11.32L64.69,124,41.37,147.31a32,32,0,0,0,0,45.26l5.38,5.37-28.41,28.4a8,8,0,0,0,11.32,11.32l28.4-28.41,5.37,5.38a32,32,0,0,0,45.26,0L132,191.31l6.34,6.35a8,8,0,0,0,11.32-11.32L131.31,168l18.35-18.34A8,8,0,0,0,149.66,138.34Zm-52.29,65a16,16,0,0,1-22.62,0L52.69,181.25a16,16,0,0,1,0-22.62L76,135.31,120.69,180Zm140.29-185a8,8,0,0,0-11.32,0l-28.4,28.41-5.37-5.38a32.05,32.05,0,0,0-45.26,0L124,64.69l-6.34-6.35a8,8,0,0,0-11.32,11.32l80,80a8,8,0,0,0,11.32-11.32L191.31,132l23.32-23.31a32,32,0,0,0,0-45.26l-5.38-5.37,28.41-28.4A8,8,0,0,0,237.66,18.34Zm-34.35,79L180,120.69,135.31,76l23.32-23.31a16,16,0,0,1,22.62,0l22.06,22A16,16,0,0,1,203.31,97.37Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M146.83,141.17a4,4,0,0,0-5.66,0L120,162.34,93.66,136l21.17-21.17a4,4,0,0,0-5.66-5.66L88,130.34,66.83,109.17a4,4,0,0,0-5.66,5.66L70.34,124,44.2,150.14a28,28,0,0,0,0,39.6l8.2,8.2L21.17,229.17a4,4,0,0,0,5.66,5.66L58.06,203.6l8.2,8.2a28,28,0,0,0,39.6,0L132,185.66l9.17,9.17a4,4,0,0,0,5.66-5.66L125.66,168l21.17-21.17A4,4,0,0,0,146.83,141.17Zm-46.63,65a20,20,0,0,1-28.28,0L49.86,184.08a20,20,0,0,1,0-28.28L76,129.66,126.34,180Zm134.63-185a4,4,0,0,0-5.66,0L197.94,52.4l-8.2-8.2a28,28,0,0,0-39.6,0L124,70.34l-9.17-9.17a4,4,0,0,0-5.66,5.66l80,80a4,4,0,0,0,5.66-5.66L185.66,132l26.14-26.14a28,28,0,0,0,0-39.6l-8.2-8.2,31.23-31.23A4,4,0,0,0,234.83,21.17ZM212,86.06a19.86,19.86,0,0,1-5.86,14.14L180,126.34,129.66,76,155.8,49.86a20,20,0,0,1,28.28,0l22.06,22.06A19.85,19.85,0,0,1,212,86.06Z"}))]]),G=t.forwardRef((m,d)=>t.createElement(ue,{ref:d,...m,weights:Pe}));G.displayName="PlugsIcon";const Me=G;function ns(){const{showSuccess:m,showError:d,showInfo:B}=he(),{hasPermission:p}=ze(),[V,I]=t.useState(!0),[a,u]=t.useState({}),[W,Q]=t.useState([]),[S,J]=t.useState([]),[r,K]=t.useState({pending:0,approved:0,rejected:0,total:0}),[l,h]=t.useState(null),[x,X]=t.useState("requests"),[L,T]=t.useState(!1),[Y,ee]=t.useState(""),[E,g]=t.useState(!1),[D,y]=t.useState(""),[qe,_e]=t.useState(!1);t.useEffect(()=>{j()},[]);const j=async()=>{I(!0);try{const[s,i,f,de]=await Promise.all([o.getConfig(),o.getRequests(),ke.getAll(),o.getStats()]);u(s.data||{}),Q(i.data||[]),K(de.data||{pending:0,approved:0,rejected:0,total:0});const xe=f.data||[],me=await Promise.all(xe.map(async z=>{try{const pe=await o.getChallenge(z.id);return{...z,scep_challenge:pe.data?.challenge}}catch{return{...z,scep_challenge:null}}}));J(me)}catch{d("Failed to load SCEP data")}finally{I(!1)}},se=async()=>{T(!0);try{await o.updateConfig(a),m("SCEP configuration saved")}catch(s){d(s.message||"Failed to save configuration")}finally{T(!1)}},R=async s=>{try{await o.approveRequest(s.id),m("Request approved - Certificate issued"),j()}catch(i){d(i.message||"Failed to approve request")}},te=async()=>{if(l)try{await o.rejectRequest(l.id,D),m("Request rejected"),g(!1),y(""),h(null),j()}catch(s){d(s.message||"Failed to reject request")}},ae=async s=>{try{await o.regenerateChallenge(s),m("Challenge password regenerated"),j()}catch(i){d(i.message||"Failed to regenerate challenge")}},A=s=>{navigator.clipboard.writeText(s),B("Copied to clipboard")},k=s=>{const i={pending:"warning",approved:"success",rejected:"danger",issued:"info"};return e.jsx(we,{variant:i[s]||"default",children:s})},le=t.useMemo(()=>[{id:"requests",label:"Requests",badge:r.pending>0?r.pending:null},{id:"config",label:"Configuration"},{id:"challenge",label:"Challenges"},{id:"info",label:"Info"}],[r.pending]),re=t.useMemo(()=>[{icon:U,label:"Pending",value:r.pending,variant:r.pending>0?"warning":"default"},{icon:b,label:"Approved",value:r.approved,variant:"success"},{icon:v,label:"Rejected",value:r.rejected,variant:"danger"},{icon:Ce,label:"Total",value:r.total}],[r]),ne=t.useMemo(()=>[{key:"id",label:"ID",width:"60px"},{key:"transaction_id",label:"Transaction ID",render:s=>e.jsxs("code",{className:"text-xs bg-bg-tertiary px-1.5 py-0.5 rounded",children:[s?.slice(0,16),"..."]})},{key:"subject",label:"Subject",render:s=>s||e.jsx("span",{className:"text-text-tertiary",children:"-"})},{key:"status",label:"Status",render:s=>k(s)},{key:"created_at",label:"Requested",render:s=>C(s)}],[]),ie=t.useCallback((s,i)=>e.jsx("div",{className:`p-4 ${i?"mobile-row-selected":""}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-text-primary truncate",children:s.subject||`Request #${s.id}`}),k(s.status)]}),e.jsx("div",{className:"text-xs text-text-secondary mt-1",children:e.jsxs("code",{className:"bg-bg-tertiary px-1 py-0.5 rounded",children:[s.transaction_id?.slice(0,20),"..."]})}),e.jsx("div",{className:"text-xs text-text-tertiary mt-1",children:C(s.created_at)})]}),s.status==="pending"&&p("write:scep")&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{size:"sm",variant:"success",onClick:f=>{f.stopPropagation(),R(s)},children:e.jsx(b,{size:14})}),e.jsx(n,{size:"sm",variant:"danger",onClick:f=>{f.stopPropagation(),h(s),g(!0)},children:e.jsx(v,{size:14})})]})]})}),[p]),ce=e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs(c,{className:"p-4 space-y-3 bg-gradient-to-br from-accent-primary/5 to-transparent",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(je,{size:16,className:"text-accent-primary"}),"SCEP Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold status-warning-text",children:r.pending}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Pending"})]}),e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold status-success-text",children:r.approved}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Approved"})]}),e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-status-error",children:r.rejected}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Rejected"})]}),e.jsxs("div",{className:"text-center p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r.total}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Total"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Z,{variant:"info",title:"About SCEP",children:"Simple Certificate Enrollment Protocol (SCEP) enables automated certificate enrollment for devices like MDM-managed devices, network equipment, and IoT devices."}),e.jsx(Z,{variant:"tip",title:"MDM Integration",children:"Compatible with Microsoft Intune, Jamf Pro, VMware Workspace ONE, and other MDM solutions. Configure the SCEP URL and challenge password in your MDM profile."}),e.jsx(Z,{variant:"warning",title:"Challenge Security",children:"Challenge passwords should be securely distributed. Consider using auto-approve only in trusted environments with proper network segmentation."})]})]}),oe=l&&!E&&e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsx(fe,{icon:N,iconClass:l.status==="approved"?"bg-status-success/20":l.status==="rejected"?"bg-status-error/20":"bg-status-warning/20",title:`Request #${l.id}`,subtitle:l.subject||"SCEP Enrollment Request",badge:k(l.status)}),e.jsx(ve,{stats:[{icon:U,value:C(l.created_at)}]}),l.status==="pending"&&p("write:scep")&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{size:"sm",variant:"primary",className:"flex-1",onClick:()=>R(l),children:[e.jsx(b,{size:14})," Approve"]}),e.jsxs(n,{size:"sm",variant:"danger",onClick:()=>g(!0),children:[e.jsx(v,{size:14})," Reject"]})]}),e.jsx(H,{title:"Request Details",children:e.jsxs(ye,{children:[e.jsx(w,{label:"Transaction ID",value:l.transaction_id,mono:!0,copyable:!0}),e.jsx(w,{label:"Subject",value:l.subject}),e.jsx(w,{label:"Status",value:l.status}),e.jsx(w,{label:"Created",value:C(l.created_at)})]})}),l.csr_pem&&e.jsx(H,{title:"CSR Content",collapsible:!0,defaultOpen:!1,children:e.jsx("pre",{className:"text-[10px] font-mono text-text-secondary bg-bg-tertiary/50 p-2 rounded overflow-x-auto max-h-32 overflow-y-auto",children:l.csr_pem})})]});return V?e.jsx("div",{className:"flex items-center justify-center h-full w-full",children:e.jsx($,{size:"lg"})}):e.jsxs(e.Fragment,{children:[e.jsxs(Ae,{title:"SCEP Protocol",icon:N,subtitle:a.enabled?"Enabled":"Disabled",tabs:le,activeTab:x,onTabChange:X,stats:x==="requests"?re:void 0,helpContent:ce,splitView:x==="requests",splitEmptyContent:e.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-bg-tertiary flex items-center justify-center mb-3",children:e.jsx(N,{size:24,className:"text-text-tertiary"})}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Select a request to view details"})]}),slideOverOpen:!!l&&!E,onSlideOverClose:()=>h(null),slideOverTitle:"Request Details",slideOverContent:oe,slideOverWidth:"md",children:[x==="requests"&&e.jsx(Re,{data:W,columns:ne,keyField:"id",searchable:!0,externalSearch:Y,onSearchChange:ee,searchPlaceholder:"Search requests...",toolbarActions:e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"secondary",size:"sm",onClick:j,className:"hidden md:inline-flex",children:e.jsx(P,{size:14})}),e.jsx(n,{variant:"secondary",size:"lg",onClick:j,className:"md:hidden h-11 w-11 p-0",children:e.jsx(P,{size:22})})]}),selectedId:l?.id,onRowClick:h,renderMobileCard:ie,emptyState:{icon:N,title:"No SCEP requests",description:"Enrollment requests will appear here when devices request certificates via SCEP protocol"},rowActions:s=>s.status==="pending"&&p("write:scep")?[{icon:b,label:"Approve",onClick:()=>R(s),variant:"success"},{icon:v,label:"Reject",onClick:()=>{h(s),g(!0)},variant:"danger"}]:[]}),x==="config"&&e.jsxs("div",{className:"p-4 md:p-6 max-w-3xl mx-auto space-y-6",children:[e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${a.enabled?"status-success-bg":"bg-bg-tertiary"}`,children:e.jsx(Me,{size:24,className:a.enabled?"status-success-text":"text-text-tertiary",weight:"duotone"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.enabled||!1,onChange:s=>u({...a,enabled:s.target.checked}),className:"w-5 h-5 rounded border-border bg-bg-tertiary accent-accent-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary font-semibold",children:"Enable SCEP Server"}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Allow devices to enroll certificates via SCEP protocol"})]})]})})]})}),e.jsxs(c,{className:"p-4 space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(F,{size:16}),"Server Settings"]}),e.jsx(M,{label:"SCEP Endpoint URL",value:`${window.location.origin}/scep/pkiclient.exe`,readOnly:!0,helperText:"Use this URL in client configuration",className:"bg-bg-tertiary"}),e.jsx(Le,{label:"Issuing CA",placeholder:"Select a CA...",options:S.map(s=>({value:s.id.toString(),label:s.name||s.subject})),value:a.ca_id?.toString()||"",onChange:s=>u({...a,ca_id:parseInt(s)}),disabled:!a.enabled}),e.jsx(M,{label:"CA Identifier",value:a.ca_ident||"ucm-ca",onChange:s=>u({...a,ca_ident:s.target.value}),helperText:"Identifier sent to clients during GetCACaps",disabled:!a.enabled})]}),e.jsxs(c,{className:"p-4 space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(q,{size:16}),"Security Settings"]}),e.jsxs("div",{className:"p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.auto_approve||!1,onChange:s=>u({...a,auto_approve:s.target.checked}),className:"w-5 h-5 rounded border-border bg-bg-secondary accent-accent-primary",disabled:!a.enabled}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary font-medium",children:"Auto-approve requests"}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Automatically approve valid SCEP requests"})]})]}),a.auto_approve&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 status-warning-text text-xs",children:[e.jsx(O,{size:14,className:"flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Auto-approve enabled. Ensure challenge passwords are securely distributed."})]})]}),e.jsx(M,{label:"Challenge Password Validity",type:"number",value:a.challenge_validity||24,onChange:s=>u({...a,challenge_validity:parseInt(s.target.value)}),min:"1",max:"168",disabled:!a.enabled,helperText:"Hours before challenge passwords expire (1-168)",suffix:"hours"})]}),p("write:scep")&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(n,{onClick:se,disabled:L,children:[L?e.jsx($,{size:"sm"}):e.jsx(F,{size:14}),L?"Saving...":"Save Configuration"]})})]}),x==="challenge"&&e.jsxs("div",{className:"p-4 md:p-6 max-w-3xl mx-auto space-y-4",children:[!a.enabled&&e.jsx(c,{className:"p-4 status-warning-border status-warning-bg border",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(O,{size:20,className:"status-warning-text flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium status-warning-text",children:"SCEP is disabled"}),e.jsx("p",{className:"text-xs text-text-secondary",children:"Enable SCEP in Configuration tab to use challenge passwords."})]})]})}),S.length===0?e.jsx(Se,{icon:q,title:"No CAs available",description:"Create a Certificate Authority first to configure SCEP challenge passwords"}):S.map(s=>e.jsxs(c,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{size:16,className:"text-accent-primary",weight:"duotone"}),e.jsx("h3",{className:"text-sm font-semibold text-text-primary truncate",children:s.name||s.subject})]}),e.jsx("p",{className:"text-xs text-text-tertiary truncate",children:s.subject})]}),p("write:scep")&&e.jsxs(n,{size:"sm",variant:"secondary",onClick:()=>ae(s.id),children:[e.jsx(P,{size:14}),e.jsx("span",{className:"hidden md:inline",children:"Regenerate"})]})]}),e.jsx("div",{className:"p-3 bg-bg-tertiary rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-text-secondary mb-1",children:"Challenge Password"}),e.jsx("code",{className:"text-sm font-mono text-text-primary break-all",children:s.scep_challenge||"No challenge password set"})]}),s.scep_challenge&&e.jsx(n,{size:"sm",variant:"ghost",onClick:()=>A(s.scep_challenge),children:e.jsx(_,{size:14})})]})})]},s.id))]}),x==="info"&&e.jsxs("div",{className:"p-4 md:p-6 max-w-3xl mx-auto space-y-4",children:[e.jsxs(c,{className:"p-4 space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(be,{size:16}),"Connection Details"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-secondary mb-1",children:"SCEP URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("code",{className:"text-sm font-mono text-text-primary flex-1 break-all",children:[window.location.origin,"/scep/pkiclient.exe"]}),e.jsx(n,{size:"sm",variant:"ghost",onClick:()=>A(`${window.location.origin}/scep/pkiclient.exe`),children:e.jsx(_,{size:14})})]})]}),e.jsxs("div",{className:"p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-secondary mb-1",children:"CA Identifier"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm font-mono text-text-primary flex-1",children:a.ca_ident||"ucm-ca"}),e.jsx(n,{size:"sm",variant:"ghost",onClick:()=>A(a.ca_ident||"ucm-ca"),children:e.jsx(_,{size:14})})]})]})]})]}),e.jsxs(c,{className:"p-4 space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(b,{size:16}),"Supported Operations"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["GetCACaps","GetCACert","GetCACertChain","PKIOperation"].map(s=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-bg-tertiary rounded",children:[e.jsx(b,{size:14,className:"status-success-text"}),e.jsx("span",{className:"text-sm text-text-primary",children:s})]},s))})]}),e.jsxs(c,{className:"p-4 space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(ge,{size:16}),"Cisco IOS Example"]}),e.jsx("pre",{className:"p-3 bg-bg-tertiary rounded-lg text-xs text-text-primary font-mono overflow-x-auto border border-border",children:`crypto ca trustpoint UCM-CA
 enrollment url ${window.location.origin}/scep/pkiclient.exe
 subject-name CN=device.example.com
 revocation-check none
 auto-enroll 70
!
crypto ca authenticate UCM-CA
crypto ca enroll UCM-CA`})]})]})]}),e.jsx(Ne,{open:E,onClose:()=>{g(!1),y(""),h(null)},title:"Reject SCEP Request",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 status-danger-bg status-danger-border border rounded-lg",children:[e.jsx("p",{className:"text-sm text-text-primary",children:"Reject enrollment request from:"}),e.jsx("p",{className:"text-sm font-mono status-danger-text mt-1",children:l?.subject||l?.transaction_id})]}),e.jsx(Ee,{label:"Rejection Reason (optional)",value:D,onChange:s=>y(s.target.value),placeholder:"Enter reason for rejection...",rows:3}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"secondary",onClick:()=>{g(!1),y("")},children:"Cancel"}),e.jsxs(n,{variant:"danger",onClick:te,children:[e.jsx(v,{size:14}),"Reject Request"]})]})]})})]})}export{ns as default};
