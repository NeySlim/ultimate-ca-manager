import{r as t,p as b,u as U,j as e,h as _,e as S,f as W,i as X,k as L,m as Y}from"./index-BF_YdiPX.js";import{n as M,a as I}from"./Trash.es-p7b1E2tk.js";import{n as ee}from"./Key.es-7iVDExMN.js";import{C as F}from"./Card-BzlITdNo.js";import{G as te,a as Z}from"./GradientBadge-B3ZXEIZN.js";import{S as v,B as d}from"./Stack-C_7mMXTe.js";import{I as ae,S as z}from"./Select-mHs9Xkwm.js";import{B}from"./Badge-D-K75TUN.js";import{G as se}from"./Grid-BQE-nKEI.js";import{I as T}from"./Inline-DMsV3voq.js";import{E as V}from"./EmptyState-C4VTkU-T.js";import{S as y}from"./Skeleton-XIcmCXbb.js";import{D as R}from"./Dropdown-B6BThf9z.js";import{u as re}from"./useCAs-CvngTJQZ.js";import"./useQuery-UtDf8O_D.js";import"./useMutation-DxcS9g0U.js";const ie=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M184.49,136.49l-80,80a12,12,0,0,1-17-17L159,128,87.51,56.49a12,12,0,1,1,17-17l80,80A12,12,0,0,1,184.49,136.49Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M176,128,96,208V48Z",opacity:"0.2"}),t.createElement("path",{d:"M181.66,122.34l-80-80A8,8,0,0,0,88,48V208a8,8,0,0,0,13.66,5.66l80-80A8,8,0,0,0,181.66,122.34ZM104,188.69V67.31L164.69,128Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M181.66,133.66l-80,80A8,8,0,0,1,88,208V48a8,8,0,0,1,13.66-5.66l80,80A8,8,0,0,1,181.66,133.66Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M180.24,132.24l-80,80a6,6,0,0,1-8.48-8.48L167.51,128,91.76,52.24a6,6,0,0,1,8.48-8.48l80,80A6,6,0,0,1,180.24,132.24Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M178.83,130.83l-80,80a4,4,0,0,1-5.66-5.66L170.34,128,93.17,50.83a4,4,0,0,1,5.66-5.66l80,80A4,4,0,0,1,178.83,130.83Z"}))]]),ne=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M201.17,59.62a80,80,0,0,0-146.34,0,76,76,0,0,0,61.17,139V232a12,12,0,0,0,24,0V198.64A76.26,76.26,0,0,0,168,204l1.92,0A76,76,0,0,0,201.17,59.62ZM169.35,180A52,52,0,0,1,140,171.79V135.42l41.37-20.69a12,12,0,1,0-10.74-21.46L140,108.58V88a12,12,0,0,0-24,0v44.58L85.37,117.27a12,12,0,0,0-10.74,21.46L116,159.42v12.37A52.24,52.24,0,0,1,86.65,180c-27.53-.69-50.72-24.56-50.65-52.13a51.81,51.81,0,0,1,32.61-48.1,12,12,0,0,0,6.78-7,56,56,0,0,1,105.22,0,12,12,0,0,0,6.78,7A51.81,51.81,0,0,1,220,127.85C220.08,155.41,196.88,179.29,169.35,180Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M232,127.82c.09,33.94-28.41,63.3-62.34,64.16a63.72,63.72,0,0,1-41.66-14,63.71,63.71,0,0,1-41.65,14c-33.93-.86-62.44-30.22-62.35-64.16a64,64,0,0,1,40.13-59.2,68,68,0,0,1,127.74,0A64,64,0,0,1,232,127.82Z",opacity:"0.2"}),t.createElement("path",{d:"M198.1,62.59a76,76,0,0,0-140.2,0A71.71,71.71,0,0,0,16,127.8C15.9,166,48,199,86.14,200A72.22,72.22,0,0,0,120,192.47V232a8,8,0,0,0,16,0V192.47A72.17,72.17,0,0,0,168,200l1.82,0C208,199,240.11,166,240,127.8A71.71,71.71,0,0,0,198.1,62.59ZM169.45,184a56.08,56.08,0,0,1-33.45-10v-41l43.58-21.78a8,8,0,1,0-7.16-14.32L136,115.06V88a8,8,0,0,0-16,0v51.06L83.58,120.84a8,8,0,1,0-7.16,14.32L120,156.94v17a56,56,0,0,1-33.45,10C56.9,183.23,31.92,157.52,32,127.84A55.79,55.79,0,0,1,67.11,76a8,8,0,0,0,4.53-4.67,60,60,0,0,1,112.72,0A8,8,0,0,0,188.89,76,55.79,55.79,0,0,1,224,127.84C224.08,157.52,199.1,183.23,169.45,184Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M128,187.85a72.44,72.44,0,0,0,8,4.62V232a8,8,0,0,1-16,0V192.47A72.44,72.44,0,0,0,128,187.85ZM198.1,62.59a76,76,0,0,0-140.2,0A71.71,71.71,0,0,0,16,127.8C15.9,166,48,199,86.14,200A72.22,72.22,0,0,0,120,192.47V156.94L76.42,135.16a8,8,0,1,1,7.16-14.32L120,139.06V88a8,8,0,0,1,16,0v27.06l36.42-18.22a8,8,0,1,1,7.16,14.32L136,132.94v59.53A72.17,72.17,0,0,0,168,200l1.82,0C208,199,240.11,166,240,127.8A71.71,71.71,0,0,0,198.1,62.59Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M196.55,64.09a74,74,0,0,0-137.1,0A69.71,69.71,0,0,0,18,127.8C17.9,164.91,49.13,197,86.19,198A70.32,70.32,0,0,0,122,189.16V232a6,6,0,0,0,12,0V189.16A70.1,70.1,0,0,0,168,198l1.77,0C206.87,197,238.1,164.9,238,127.8A69.71,69.71,0,0,0,196.55,64.09ZM169.5,186A57.88,57.88,0,0,1,134,175V131.71l44.68-22.34a6,6,0,1,0-5.36-10.74L134,118.29V88a6,6,0,0,0-12,0v54.29L82.68,122.63a6,6,0,0,0-5.36,10.74L122,155.71V175a58.09,58.09,0,0,1-35.5,11c-30.71-.77-56.58-27.4-56.5-58.14A57.78,57.78,0,0,1,66.37,74.19a6,6,0,0,0,3.39-3.51,62,62,0,0,1,116.48,0,6,6,0,0,0,3.39,3.51A57.77,57.77,0,0,1,226,127.83C226.08,158.58,200.21,185.2,169.5,186Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M198.1,62.59a76,76,0,0,0-140.2,0A71.71,71.71,0,0,0,16,127.8C15.9,166,48,199,86.14,200A72.09,72.09,0,0,0,120,192.47V232a8,8,0,0,0,16,0V192.47A72.17,72.17,0,0,0,168,200l1.82,0C208,199,240.11,166,240,127.8A71.71,71.71,0,0,0,198.1,62.59ZM169.45,184a56.08,56.08,0,0,1-33.45-10v-41l43.58-21.78a8,8,0,1,0-7.16-14.32L136,115.06V88a8,8,0,0,0-16,0v51.06L83.58,120.84a8,8,0,1,0-7.16,14.32L120,156.94v17a56,56,0,0,1-33.45,10C56.9,183.23,31.92,157.52,32,127.84A55.77,55.77,0,0,1,67.11,76a8,8,0,0,0,4.53-4.67,60,60,0,0,1,112.72,0A8,8,0,0,0,188.89,76,55.79,55.79,0,0,1,224,127.84C224.08,157.52,199.1,183.23,169.45,184Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M195,65.59a72,72,0,0,0-134,0,67.72,67.72,0,0,0-41,62.22c-.1,36,30.24,67.26,66.25,68.17A68.24,68.24,0,0,0,124,185.66V232a4,4,0,0,0,8,0V185.67A68.09,68.09,0,0,0,168,196l1.72,0c36-.91,66.34-32.13,66.24-68.17A67.73,67.73,0,0,0,195,65.59ZM169.55,188A60.15,60.15,0,0,1,132,176v-45.5l45.79-22.89a4,4,0,1,0-3.58-7.16L132,121.53V88a4,4,0,0,0-8,0v57.53L81.79,124.42a4,4,0,1,0-3.58,7.16L124,154.47V176a60,60,0,0,1-37.55,12c-31.77-.8-58.54-28.35-58.45-60.15a59.77,59.77,0,0,1,37.62-55.5A4,4,0,0,0,67.88,70a64,64,0,0,1,120.24,0,4,4,0,0,0,2.26,2.33A59.79,59.79,0,0,1,228,127.83C228.09,159.63,201.32,187.18,169.55,188Z"}))]]),$=t.forwardRef((a,i)=>t.createElement(b,{ref:i,...a,weights:ie}));$.displayName="CaretRightIcon";const le=$,D=t.forwardRef((a,i)=>t.createElement(b,{ref:i,...a,weights:ne}));D.displayName="TreeIcon";const G=D,de="_container_16zpk_1",oe="_header_16zpk_7",ce="_title_16zpk_14",he="_subtitle_16zpk_21",pe="_filtersBar_16zpk_28",me="_filtersLeft_16zpk_36",xe="_filtersRight_16zpk_44",ge="_viewToggle_16zpk_50",Ce="_treeView_16zpk_59",ue="_treeNode_16zpk_65",je="_treeChildren_16zpk_70",ve="_caCard_16zpk_86",_e="_caCardContent_16zpk_91",fe="_expandButton_16zpk_97",Ae="_caIcon_16zpk_122",ze="_caInfo_16zpk_134",ye="_caName_16zpk_139",ke="_caMeta_16zpk_149",Ee="_caActions_16zpk_158",Ne="_gridCard_16zpk_163",we="_gridCardHeader_16zpk_173",Se="_gridCardIcon_16zpk_179",Ve="_gridCardTitle_16zpk_189",be="_gridCardSubtitle_16zpk_199",Le="_gridCardFooter_16zpk_207",Me="_gridCardStat_16zpk_215",s={container:de,header:oe,title:ce,subtitle:he,filtersBar:pe,filtersLeft:me,filtersRight:xe,viewToggle:ge,treeView:Ce,treeNode:ue,treeChildren:je,caCard:ve,caCardContent:_e,expandButton:fe,caIcon:Ae,caInfo:ze,caName:ye,caMeta:ke,caActions:Ee,gridCard:Ne,gridCardHeader:we,gridCardIcon:Se,gridCardTitle:Ve,gridCardSubtitle:be,gridCardFooter:Le,gridCardStat:Me};function H({ca:a,level:i=0,onExpand:o,expanded:x,onSelect:c}){const p=a.children&&a.children.length>0,h=x.has(a.id),C=n=>{n.stopPropagation(),o(a.id)},m={root:"success",intermediate:"info",issuing:"primary"};return e.jsxs("div",{className:s.treeNode,style:{"--level":i},children:[e.jsx(F,{hoverable:!0,className:s.caCard,onClick:()=>c?.(a),children:e.jsxs("div",{className:s.caCardContent,children:[e.jsx("button",{className:s.expandButton,onClick:C,disabled:!p,children:p?h?e.jsx(X,{size:16,weight:"bold"}):e.jsx(le,{size:16,weight:"bold"}):e.jsx("div",{style:{width:"16px"}})}),e.jsx("div",{className:s.caIcon,children:e.jsx(_,{size:24,weight:"duotone"})}),e.jsxs("div",{className:s.caInfo,children:[e.jsx("div",{className:s.caName,children:a.common_name||a.name}),e.jsxs("div",{className:s.caMeta,children:[e.jsx(Z,{variant:m[a.type]||"primary",size:"sm",children:a.type}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[a.serial_number?.substring(0,16),"..."]}),a.expires_in&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(B,{variant:a.expires_in_days<30?"warning":"default",size:"sm",children:a.expires_in})]})]})]}),e.jsx("div",{className:s.caActions,onClick:n=>n.stopPropagation(),children:e.jsx(R,{items:[{label:"View Details",icon:e.jsx(M,{size:16}),onClick:()=>c?.(a)},{label:"Export Certificate",icon:e.jsx(L,{size:16}),onClick:()=>{}},{label:"Export Private Key",icon:e.jsx(ee,{size:16}),onClick:()=>{}},{type:"divider"},{label:"Delete",icon:e.jsx(I,{size:16}),onClick:()=>{},variant:"danger"}],children:e.jsx(d,{variant:"ghost",size:"sm",children:"•••"})})})]})}),p&&h&&e.jsx("div",{className:s.treeChildren,children:a.children.map(n=>e.jsx(H,{ca:n,level:i+1,onExpand:o,expanded:x,onSelect:c},n.id))})]})}function Ie({ca:a,onSelect:i}){const o={root:"success",intermediate:"info",issuing:"primary"};return e.jsx(F,{hoverable:!0,className:s.gridCard,onClick:()=>i?.(a),children:e.jsxs(v,{gap:"md",children:[e.jsxs("div",{className:s.gridCardHeader,children:[e.jsx("div",{className:s.gridCardIcon,style:{background:`linear-gradient(135deg, var(--color-${o[a.type]}-500) 0%, var(--color-${o[a.type]}-600) 100%)`},children:e.jsx(_,{size:32,weight:"bold",color:"white"})}),e.jsx(R,{items:[{label:"View Details",icon:e.jsx(M,{size:16}),onClick:()=>i?.(a)},{label:"Export",icon:e.jsx(L,{size:16}),onClick:()=>{}},{type:"divider"},{label:"Delete",icon:e.jsx(I,{size:16}),onClick:()=>{},variant:"danger"}],children:e.jsx(d,{variant:"ghost",size:"sm",children:"•••"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:s.gridCardTitle,children:a.common_name||a.name}),e.jsx("div",{className:s.gridCardSubtitle,children:a.organization||"No Organization"})]}),e.jsxs(T,{gap:"xs",wrap:!0,children:[e.jsx(Z,{variant:o[a.type],size:"sm",children:a.type}),a.expires_in&&e.jsx(B,{variant:a.expires_in_days<30?"warning":"default",size:"sm",children:a.expires_in})]}),e.jsxs("div",{className:s.gridCardFooter,children:[e.jsxs("div",{className:s.gridCardStat,children:[e.jsx(Y,{size:16}),e.jsxs("span",{children:[a.issued_certificates||0," certs"]})]}),e.jsxs("div",{className:s.gridCardStat,children:[e.jsx(G,{size:16}),e.jsxs("span",{children:[a.children?.length||0," children"]})]})]})]})})}function Xe(){const a=U(),{data:i,isLoading:o,error:x}=re(),[c,p]=t.useState("tree"),[h,C]=t.useState(""),[m,n]=t.useState("all"),[g,k]=t.useState("all"),[P,E]=t.useState("name"),[N,f]=t.useState(new Set),[Fe,w]=t.useState(null),Q=r=>{const l=new Set(N);l.has(r)?l.delete(r):l.add(r),f(l)},K=()=>{const r=new Set,l=J=>{J?.forEach(A=>{r.add(A.id),A.children&&l(A.children)})};l(i),f(r)},O=()=>{f(new Set)},q=()=>{C(""),n("all"),k("all"),E("name")},u=i?.filter(r=>!(h&&!r.common_name?.toLowerCase().includes(h.toLowerCase())||m!=="all"&&r.type!==m||g!=="all"&&(g==="active"&&r.status!=="active"||g==="expired"&&r.status!=="expired")));if(o)return e.jsx("div",{className:s.container,children:e.jsxs(v,{gap:"xl",children:[e.jsx(y,{height:"60px"}),e.jsx(y,{height:"120px"}),e.jsx(v,{gap:"sm",children:[...Array(5)].map((r,l)=>e.jsx(y,{height:"80px"},l))})]})});if(x)return e.jsx("div",{className:s.container,children:e.jsx(V,{icon:e.jsx(_,{size:64}),title:"Error loading CAs",description:x.message})});const j=h||m!=="all"||g!=="all";return e.jsx("div",{className:s.container,children:e.jsxs(v,{gap:"xl",children:[e.jsxs("div",{className:s.header,children:[e.jsxs("div",{children:[e.jsx("h1",{className:s.title,children:"Certificate Authorities"}),e.jsx("p",{className:s.subtitle,children:"Manage your CA hierarchy"})]}),e.jsx(d,{variant:"primary",leftIcon:e.jsx(S,{size:20,weight:"bold"}),onClick:()=>a("/cas/new"),children:"Create CA"})]}),e.jsx(te,{blur:"md",children:e.jsxs("div",{className:s.filtersBar,children:[e.jsxs("div",{className:s.filtersLeft,children:[e.jsx(ae,{placeholder:"Search CAs...",leftIcon:e.jsx(W,{size:18}),value:h,onChange:r=>C(r.target.value),style:{width:"300px"}}),e.jsxs(z,{value:m,onChange:r=>n(r.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"root",children:"Root CA"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"issuing",children:"Issuing CA"})]}),e.jsxs(z,{value:g,onChange:r=>k(r.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]}),e.jsxs(z,{value:P,onChange:r=>E(r.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"expiry",children:"Sort by Expiry"})]})]}),e.jsxs("div",{className:s.filtersRight,children:[j&&e.jsx(d,{variant:"ghost",size:"sm",onClick:q,children:"Clear Filters"}),e.jsxs("div",{className:s.viewToggle,children:[e.jsx(d,{variant:c==="tree"?"primary":"ghost",size:"sm",onClick:()=>p("tree"),children:e.jsx(G,{size:18})}),e.jsx(d,{variant:c==="grid"?"primary":"ghost",size:"sm",onClick:()=>p("grid"),children:"Grid"})]}),c==="tree"&&e.jsxs(T,{gap:"xs",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:K,children:"Expand All"}),e.jsx(d,{variant:"ghost",size:"sm",onClick:O,children:"Collapse All"})]})]})]})}),!u||u.length===0?e.jsx(V,{icon:e.jsx(_,{size:64}),title:j?"No CAs match your filters":"No Certificate Authorities",description:j?"Try adjusting your filters":"Create your first CA to get started",action:!j&&e.jsx(d,{variant:"primary",leftIcon:e.jsx(S,{size:20}),onClick:()=>a("/cas/new"),children:"Create CA"})}):c==="tree"?e.jsx("div",{className:s.treeView,children:u.map(r=>e.jsx(H,{ca:r,level:0,onExpand:Q,expanded:N,onSelect:w},r.id))}):e.jsx(se,{cols:3,gap:"lg",children:u.map(r=>e.jsx(Ie,{ca:r,onSelect:w},r.id))})]})})}export{Xe as CAListV3,Xe as default};
