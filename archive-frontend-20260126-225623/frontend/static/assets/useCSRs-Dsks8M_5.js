import{u}from"./useQuery-BTYUFOaa.js";import{d as a}from"./index-qRzKqHpr.js";const d={getAll:async(e={})=>{const s=await a.get("/api/v2/csrs",{params:e}),n=(s.data||[]).map(t=>{const o=t.subject?.match(/CN=([^,]+)/),p=o?o[1]:t.subject||"Unnamed CSR",i=t.key_type&&t.key_size?`${t.key_type.toUpperCase()} ${t.key_size}`:"Unknown",c=t.created_at?t.created_at.split("T")[0]:"N/A",l=t.priority||"NORMAL";return{id:t.id,subject:p,key:i,status:(t.status||"PENDING").toUpperCase(),submitted:c,requester:t.requester||"Unknown",priority:l,_raw:t}});return{data:n,meta:s.meta||{page:1,per_page:20,total:n.length}}},getById:async e=>(await a.get(`/api/v2/csrs/${e}`)).data,approve:async(e,s)=>(await a.post(`/api/v2/csrs/${e}/approve`,{ca_id:s})).data,reject:async(e,s)=>(await a.post(`/api/v2/csrs/${e}/reject`,{reason:s})).data,delete:async e=>(await a.delete(`/api/v2/csrs/${e}`)).data},r={all:["csrs"],lists:()=>[...r.all,"list"],list:e=>[...r.lists(),e],details:()=>[...r.all,"detail"],detail:e=>[...r.details(),e]},_=(e={})=>u({queryKey:r.list(e),queryFn:()=>d.getAll(e)});export{_ as u};
