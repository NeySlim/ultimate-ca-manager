import{r as i,p as D,u as F,j as e,e as G,f as B,m as S,n as g,h as f,k as b,s as R}from"./index-BF_YdiPX.js";import{s as O}from"./CheckCircle.es-BGsiUxrQ.js";import{n as $}from"./Key.es-7iVDExMN.js";import{c as P}from"./Warning.es-DaiRCwyh.js";import{n as H}from"./X.es-D65hcxyn.js";import{T as Q}from"./Table-AdW7fLDd.js";import{S as o,B as m}from"./Stack-C_7mMXTe.js";import{I as U,S as y}from"./Select-mHs9Xkwm.js";import{B as h}from"./Badge-D-K75TUN.js";import{G as I,a as q}from"./GradientBadge-B3ZXEIZN.js";import{I as j}from"./Inline-DMsV3voq.js";import{M as J}from"./Modal-JKUCtzHQ.js";import{T as K}from"./Tabs-CiBRPDXT.js";import{u as W}from"./useCertificates-Dnt8OMvr.js";import"./Checkbox-C0Z25dh5.js";import"./EmptyState-C4VTkU-T.js";import"./Skeleton-XIcmCXbb.js";import"./index-CvQLL3eC.js";import"./useQuery-UtDf8O_D.js";import"./useMutation-DxcS9g0U.js";const X=new Map([["bold",i.createElement(i.Fragment,null,i.createElement("path",{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm84,108a83.6,83.6,0,0,1-16.75,50.28L77.72,60.75A84,84,0,0,1,212,128ZM44,128A83.6,83.6,0,0,1,60.75,77.72L178.28,195.25A84,84,0,0,1,44,128Z"}))],["duotone",i.createElement(i.Fragment,null,i.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),i.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm88,104a87.56,87.56,0,0,1-20.41,56.28L71.72,60.4A88,88,0,0,1,216,128ZM40,128A87.56,87.56,0,0,1,60.41,71.72L184.28,195.6A88,88,0,0,1,40,128Z"}))],["fill",i.createElement(i.Fragment,null,i.createElement("path",{d:"M200,128a71.69,71.69,0,0,1-15.78,44.91L83.09,71.78A71.95,71.95,0,0,1,200,128ZM56,128a71.95,71.95,0,0,0,116.91,56.22L71.78,83.09A71.69,71.69,0,0,0,56,128Zm180,0A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-20,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"}))],["light",i.createElement(i.Fragment,null,i.createElement("path",{d:"M128,26A102,102,0,1,0,230,128,102.12,102.12,0,0,0,128,26Zm90,102a89.6,89.6,0,0,1-22.29,59.22L68.78,60.29A89.95,89.95,0,0,1,218,128ZM38,128A89.6,89.6,0,0,1,60.29,68.78L187.22,195.71A89.95,89.95,0,0,1,38,128Z"}))],["regular",i.createElement(i.Fragment,null,i.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm88,104a87.56,87.56,0,0,1-20.41,56.28L71.72,60.4A88,88,0,0,1,216,128ZM40,128A87.56,87.56,0,0,1,60.41,71.72L184.28,195.6A88,88,0,0,1,40,128Z"}))],["thin",i.createElement(i.Fragment,null,i.createElement("path",{d:"M128,28A100,100,0,1,0,228,128,100.11,100.11,0,0,0,128,28Zm92,100a91.67,91.67,0,0,1-24.21,62.13L65.87,60.21A92,92,0,0,1,220,128ZM36,128A91.67,91.67,0,0,1,60.21,65.87L190.13,195.79A92,92,0,0,1,36,128Z"}))]]),C=i.forwardRef((l,c)=>i.createElement(D,{ref:c,...l,weights:X}));C.displayName="ProhibitIcon";const w=C,Y="_container_1ph3p_1",ee="_header_1ph3p_7",ae="_title_1ph3p_14",se="_subtitle_1ph3p_21",ie="_filtersBar_1ph3p_28",le="_certName_1ph3p_36",te="_certSerial_1ph3p_43",ne="_issuer_1ph3p_49",re="_expiryDate_1ph3p_54",de="_detailSection_1ph3p_61",ce="_detailSectionTitle_1ph3p_67",oe="_detailGrid_1ph3p_74",me="_detailItem_1ph3p_80",he="_detailLabel_1ph3p_86",pe="_detailValue_1ph3p_94",xe="_detailValueMono_1ph3p_100",ue="_chainCertName_1ph3p_111",je="_chainCertMeta_1ph3p_118",ve="_extensionItem_1ph3p_124",Ne="_extensionName_1ph3p_131",_e="_extensionValue_1ph3p_138",ge="_rawData_1ph3p_146",a={container:Y,header:ee,title:ae,subtitle:se,filtersBar:ie,certName:le,certSerial:te,issuer:ne,expiryDate:re,detailSection:de,detailSectionTitle:ce,detailGrid:oe,detailItem:me,detailLabel:he,detailValue:pe,detailValueMono:xe,chainCertName:ue,chainCertMeta:je,extensionItem:ve,extensionName:Ne,extensionValue:_e,rawData:ge};function fe({certificate:l,isOpen:c,onClose:x}){const[n,p]=i.useState("info");if(!l)return null;const d=[{id:"info",label:"Information",icon:e.jsx(R,{size:16})},{id:"chain",label:"Certificate Chain",icon:e.jsx(f,{size:16})},{id:"extensions",label:"Extensions",icon:e.jsx($,{size:16})},{id:"raw",label:"Raw Data",icon:e.jsx(S,{size:16})}];return e.jsx(J,{isOpen:c,onClose:x,size:"lg",title:l.common_name||"Certificate Details",children:e.jsxs(o,{gap:"lg",children:[e.jsx(K,{tabs:d,activeTab:n,onChange:p}),n==="info"&&e.jsxs(o,{gap:"md",children:[e.jsxs("div",{className:a.detailSection,children:[e.jsx("h3",{className:a.detailSectionTitle,children:"Subject"}),e.jsxs("div",{className:a.detailGrid,children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Common Name"}),e.jsx("span",{className:a.detailValue,children:l.common_name})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Organization"}),e.jsx("span",{className:a.detailValue,children:l.organization||"N/A"})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Organizational Unit"}),e.jsx("span",{className:a.detailValue,children:l.organizational_unit||"N/A"})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Country"}),e.jsx("span",{className:a.detailValue,children:l.country||"N/A"})]})]})]}),e.jsxs("div",{className:a.detailSection,children:[e.jsx("h3",{className:a.detailSectionTitle,children:"Issuer"}),e.jsxs("div",{className:a.detailGrid,children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Issuer CN"}),e.jsx("span",{className:a.detailValue,children:l.issuer_cn})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Issuer Organization"}),e.jsx("span",{className:a.detailValue,children:l.issuer_org||"N/A"})]})]})]}),e.jsxs("div",{className:a.detailSection,children:[e.jsx("h3",{className:a.detailSectionTitle,children:"Validity"}),e.jsxs("div",{className:a.detailGrid,children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Valid From"}),e.jsx("span",{className:a.detailValue,children:l.valid_from})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Valid Until"}),e.jsx("span",{className:a.detailValue,children:l.valid_until})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Expires In"}),e.jsx("span",{className:a.detailValue,children:e.jsx(h,{variant:l.days_left<30?"warning":"success",children:l.expires_in})})]})]})]}),e.jsxs("div",{className:a.detailSection,children:[e.jsx("h3",{className:a.detailSectionTitle,children:"Identifiers"}),e.jsxs("div",{className:a.detailGrid,children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"Serial Number"}),e.jsx("span",{className:a.detailValueMono,children:l.serial_number})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"SHA-256 Fingerprint"}),e.jsx("span",{className:a.detailValueMono,children:l.fingerprint_sha256})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"SHA-1 Fingerprint"}),e.jsx("span",{className:a.detailValueMono,children:l.fingerprint_sha1})]})]})]})]}),n==="chain"&&e.jsx(o,{gap:"sm",children:l.chain?.map((t,r)=>e.jsx(I,{blur:"sm",children:e.jsxs(j,{gap:"md",align:"center",children:[e.jsx(f,{size:24,weight:"duotone"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:a.chainCertName,children:t.common_name}),e.jsxs("div",{className:a.chainCertMeta,children:[t.type," â€¢ ",t.organization]})]}),e.jsx(h,{variant:t.valid?"success":"danger",children:t.valid?"Valid":"Invalid"})]})},r))||e.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"No chain information available"})}),n==="extensions"&&e.jsx(o,{gap:"sm",children:l.extensions?.map((t,r)=>e.jsxs("div",{className:a.extensionItem,children:[e.jsx("div",{className:a.extensionName,children:t.name}),e.jsx("div",{className:a.extensionValue,children:t.value}),t.critical&&e.jsx(h,{variant:"warning",size:"sm",children:"Critical"})]},r))||e.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"No extensions"})}),n==="raw"&&e.jsx("div",{className:a.rawData,children:e.jsx("pre",{children:l.pem||"No PEM data available"})}),e.jsxs(j,{gap:"sm",justify:"end",children:[e.jsx(m,{variant:"secondary",leftIcon:e.jsx(b,{size:18}),children:"Download PEM"}),e.jsx(m,{variant:"secondary",leftIcon:e.jsx(b,{size:18}),children:"Download DER"}),e.jsx(m,{variant:"danger",leftIcon:e.jsx(w,{size:18}),children:"Revoke"})]})]})})}function Oe(){const l=F(),{data:c,isLoading:x}=W(),[n,p]=i.useState(""),[d,t]=i.useState("all"),[r,v]=i.useState("all"),[A,L]=i.useState(null),[M,N]=i.useState(!1),V=()=>{p(""),t("all"),v("all")},z=s=>{L(s),N(!0)},E=s=>{switch(s){case"valid":return e.jsx(O,{size:14,weight:"fill"});case"expiring":return e.jsx(P,{size:14,weight:"fill"});case"expired":return e.jsx(g,{size:14,weight:"fill"});case"revoked":return e.jsx(w,{size:14,weight:"fill"});default:return null}},Z=s=>{switch(s){case"valid":return"success";case"expiring":return"warning";case"expired":return"danger";case"revoked":return"danger";default:return"default"}},T=s=>{switch(s){case"server":return"blue";case"client":return"green";case"email":return"purple";case"code-signing":return"orange";default:return"blue"}},u=c?.filter(s=>!(n&&!s.common_name?.toLowerCase().includes(n.toLowerCase())||d!=="all"&&s.type!==d||r!=="all"&&s.status!==r)),k=[{key:"common_name",label:"Common Name",sortable:!0,width:"25%",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:a.certName,children:s.common_name}),e.jsxs("div",{className:a.certSerial,children:[s.serial_number?.substring(0,24),"..."]})]})},{key:"type",label:"Type",sortable:!0,width:"12%",render:s=>e.jsx(q,{variant:T(s.type),size:"sm",children:s.type})},{key:"status",label:"Status",sortable:!0,width:"12%",render:s=>e.jsx(h,{variant:Z(s.status),children:e.jsxs(j,{gap:"xs",align:"center",children:[E(s.status),e.jsx("span",{children:s.status})]})})},{key:"issuer_cn",label:"Issuer",sortable:!0,width:"20%",render:s=>e.jsx("div",{className:a.issuer,children:s.issuer_cn})},{key:"valid_until",label:"Expires",sortable:!0,width:"18%",render:s=>e.jsxs("div",{children:[e.jsx("div",{className:a.expiryDate,children:s.valid_until}),e.jsxs(h,{variant:s.days_left<7?"danger":s.days_left<30?"warning":"default",size:"sm",children:[e.jsx(g,{size:12,weight:"bold"}),s.expires_in]})]})}],_=n||d!=="all"||r!=="all";return e.jsxs("div",{className:a.container,children:[e.jsxs(o,{gap:"xl",children:[e.jsxs("div",{className:a.header,children:[e.jsxs("div",{children:[e.jsx("h1",{className:a.title,children:"Certificates"}),e.jsxs("p",{className:a.subtitle,children:[u?.length||0," certificate",u?.length!==1?"s":""]})]}),e.jsx(m,{variant:"primary",leftIcon:e.jsx(G,{size:20,weight:"bold"}),onClick:()=>l("/certificates/new"),children:"Issue Certificate"})]}),e.jsx(I,{blur:"md",children:e.jsxs("div",{className:a.filtersBar,children:[e.jsx(U,{placeholder:"Search certificates...",leftIcon:e.jsx(B,{size:18}),value:n,onChange:s=>p(s.target.value),style:{width:"300px"}}),e.jsxs(y,{value:d,onChange:s=>t(s.target.value),style:{width:"180px"},children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"server",children:"Server Auth"}),e.jsx("option",{value:"client",children:"Client Auth"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"code-signing",children:"Code Signing"})]}),e.jsxs(y,{value:r,onChange:s=>v(s.target.value),style:{width:"160px"},children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"valid",children:"Valid"}),e.jsx("option",{value:"expiring",children:"Expiring Soon"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"revoked",children:"Revoked"})]}),_&&e.jsx(m,{variant:"ghost",size:"sm",leftIcon:e.jsx(H,{size:16}),onClick:V,children:"Clear"})]})}),e.jsx(Q,{columns:k,data:u||[],isLoading:x,selectable:!0,striped:!0,hoverable:!0,onRowClick:z,emptyMessage:_?"No certificates match your filters":"No certificates found",emptyIcon:e.jsx(S,{size:64})})]}),e.jsx(fe,{certificate:A,isOpen:M,onClose:()=>N(!1)})]})}export{Oe as CertificateListV3,Oe as default};
