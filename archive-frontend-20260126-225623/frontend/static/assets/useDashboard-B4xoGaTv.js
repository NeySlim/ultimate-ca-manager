import{r as e,p as y,d as n}from"./index-qRzKqHpr.js";import{u as c}from"./useQuery-BTYUFOaa.js";const A=new Map([["bold",e.createElement(e.Fragment,null,e.createElement("path",{d:"M108,84a16,16,0,1,1,16,16A16,16,0,0,1,108,84Zm128,44A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Zm-72,36.68V132a20,20,0,0,0-20-20,12,12,0,0,0-4,23.32V168a20,20,0,0,0,20,20,12,12,0,0,0,4-23.32Z"}))],["duotone",e.createElement(e.Fragment,null,e.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),e.createElement("path",{d:"M144,176a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176Zm88-48A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128ZM124,96a12,12,0,1,0-12-12A12,12,0,0,0,124,96Z"}))],["fill",e.createElement(e.Fragment,null,e.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm-4,48a12,12,0,1,1-12,12A12,12,0,0,1,124,72Zm12,112a16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40a8,8,0,0,1,0,16Z"}))],["light",e.createElement(e.Fragment,null,e.createElement("path",{d:"M142,176a6,6,0,0,1-6,6,14,14,0,0,1-14-14V128a2,2,0,0,0-2-2,6,6,0,0,1,0-12,14,14,0,0,1,14,14v40a2,2,0,0,0,2,2A6,6,0,0,1,142,176ZM124,94a10,10,0,1,0-10-10A10,10,0,0,0,124,94Zm106,34A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"}))],["regular",e.createElement(e.Fragment,null,e.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"}))],["thin",e.createElement(e.Fragment,null,e.createElement("path",{d:"M140,176a4,4,0,0,1-4,4,12,12,0,0,1-12-12V128a4,4,0,0,0-4-4,4,4,0,0,1,0-8,12,12,0,0,1,12,12v40a4,4,0,0,0,4,4A4,4,0,0,1,140,176ZM124,92a8,8,0,1,0-8-8A8,8,0,0,0,124,92Zm104,36A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"}))]]),m=e.forwardRef((t,a)=>e.createElement(y,{ref:a,...t,weights:A}));m.displayName="InfoIcon";const E=m,o={getOverview:async()=>{const a=(await n.get("/api/v2/stats/overview")).data;return[{label:"Certificate Authorities",value:String(a.total_cas||0),subtext:"Root & Intermediate"},{label:"Issued Certificates",value:String(a.total_certs||0),subtext:"Active certificates"},{label:"ACME Accounts",value:String(a.acme_accounts||0),subtext:"Registered accounts"},{label:"Active Users",value:String(a.active_users||0),subtext:"System users"}]},getStats:async()=>{const a=(await n.get("/api/v2/dashboard/stats")).data;return{activeCertificates:String(a.total_certificates||0),expiringSoon:String(a.expiring_soon||0),pendingRequests:String(a.pending_csrs||0),acmeRenewals:String(a.acme_renewals||0),totalCAs:String(a.total_cas||0),revoked:String(a.revoked||0)}},getActivity:async(t=20)=>(await n.get(`/api/v2/dashboard/activity?limit=${t}`)).data.activity||[],getSystemStatus:async()=>(await n.get("/api/v2/dashboard/system-status")).data,getExpiringCerts:async(t=10)=>((await n.get(`/api/v2/dashboard/expiring-certs?limit=${t}`)).data||[]).map(s=>{const p=new Date(s.valid_to),l=Math.ceil((p-new Date)/(1e3*60*60*24)),d=s.subject.match(/CN=([^,]+)/),g=d?d[1]:s.descr||"Unknown";let i="Server";s.descr&&s.descr.toLowerCase().includes("acme")?i="ACME":s.subject.includes("CN=Users")?i="User":s.descr&&s.descr.toLowerCase().includes("ca")&&(i="CA");const u=s.subject.match(/O=([^,]+)/),v=u?u[1]:"Self-signed";return{id:s.id,name:g,type:i,issuer:v,expiresIn:l>0?`${l} days`:"Expired",daysLeft:l,fingerprint:s.refid||"",validTo:s.valid_to}})},r={all:["dashboard"],stats:()=>[...r.all,"stats"],overview:()=>[...r.all,"overview"],activity:t=>[...r.all,"activity",t],expiringCerts:t=>[...r.all,"expiring-certs",t]},f=()=>c({queryKey:r.stats(),queryFn:o.getStats}),S=()=>c({queryKey:r.overview(),queryFn:o.getOverview}),x=(t=20)=>c({queryKey:r.activity(t),queryFn:()=>o.getActivity(t)}),M=(t=10)=>c({queryKey:r.expiringCerts(t),queryFn:()=>o.getExpiringCerts(t)});export{S as a,x as b,M as c,E as d,f as u};
