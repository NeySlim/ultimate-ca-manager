import{r as f,j as e,c as j,B as S,n as L}from"./index-BF_YdiPX.js";import{I as y,D as $}from"./DataTable-C1f7aHM_.js";import{B as N}from"./Badge-CBeR2bmS.js";import{S as A,E}from"./ErrorState-DjUcTYZG.js";import{s as H}from"./CheckCircle.es-BGsiUxrQ.js";import{u as k,a as D,b as V,c as z,d as R}from"./useDashboard-BtL1v_6L.js";import{c as C}from"./Warning.es-DaiRCwyh.js";import{g as B}from"./getBadgeVariant-SNrdtPAh.js";import"./useQuery-UtDf8O_D.js";const G="_counter_srq0m_1",F={counter:G},q=({value:o=0,duration:l=1e3,prefix:n="",suffix:r="",decimals:d=0,className:i=""})=>{const[s,m]=f.useState(0);f.useEffect(()=>{let _,g;const v=p=>{_||(_=p);const u=Math.min((p-_)/l,1),b=1-Math.pow(1-u,4);m(Math.floor(o*b)),u<1&&(g=requestAnimationFrame(v))};return g=requestAnimationFrame(v),()=>cancelAnimationFrame(g)},[o,l]);const w=d>0?s.toFixed(d):s.toLocaleString();return e.jsxs("span",{className:`${F.counter} ${i}`,children:[n,w,r]})},M="_widget_noaw5_3",O="_widgetHeader_noaw5_19",U="_widgetTitle_noaw5_26",P="_widgetIcon_noaw5_34",J="_widgetValue_noaw5_40",K="_gradient_noaw5_47",Q="_warning_noaw5_54",W="_widgetSublabel_noaw5_58",X="_statTrend_noaw5_65",Y="_positive_noaw5_73",Z="_negative_noaw5_77",c={widget:M,widgetHeader:O,widgetTitle:U,widgetIcon:P,widgetValue:J,gradient:K,warning:Q,widgetSublabel:W,statTrend:X,positive:Y,negative:Z};function h({value:o,label:l,sublabel:n,icon:r,gradient:d=!0,trend:i,variant:s,cols:m=3,className:w}){const _=i?.positive??i?.direction==="up",g=i?.positive===!1||i?.direction==="down";return e.jsx("div",{className:j(c.widget,w),"data-cols":m,"data-variant":s,children:e.jsxs("div",{className:c.widgetHeader,children:[e.jsxs("div",{children:[e.jsx("div",{className:c.widgetTitle,children:l}),e.jsx("div",{className:j(c.widgetValue,d&&!s&&c.gradient,s&&c[s]),children:e.jsx(q,{value:parseInt(o)||0,duration:1200})}),n&&e.jsx("div",{className:c.widgetSublabel,children:n}),i&&e.jsxs("div",{className:j(c.statTrend,_&&c.positive,g&&c.negative),children:[i.direction==="up"&&e.jsx(y,{name:"ph ph-arrow-up",size:12}),i.direction==="down"&&e.jsx(y,{name:"ph ph-warning",size:12}),e.jsx("span",{children:i.text})]})]}),r&&e.jsx(y,{name:r,size:32,className:c.widgetIcon})]})})}const ee="_activityList_1a8o4_3",te="_activityItem_1a8o4_9",ie="_activityIcon_1a8o4_23",ae="_activityContent_1a8o4_34",se="_activityText_1a8o4_39",ne="_activityUser_1a8o4_46",re="_activityTime_1a8o4_50",x={activityList:ee,activityItem:te,activityIcon:ie,activityContent:ae,activityText:se,activityUser:ne,activityTime:re};function ce({icon:o,text:l,time:n,user:r,variant:d="default",gradient:i=!1}){const s={success:"success",warning:"warning",danger:"danger",info:"info"}[d];return e.jsxs("div",{className:x.activityItem,children:[e.jsx("div",{className:x.activityIcon,children:e.jsx(y,{name:o,size:14,gradient:i,color:!i&&s?s:void 0})}),e.jsxs("div",{className:x.activityContent,children:[e.jsxs("div",{className:x.activityText,children:[l,r&&e.jsxs("span",{className:x.activityUser,children:[" Â· ",r]})]}),e.jsx("div",{className:x.activityTime,children:n})]})]})}function oe({items:o=[],className:l}){return e.jsx("div",{className:j(x.activityList,l),children:o.map((n,r)=>e.jsx(ce,{...n},r))})}const le="_dashboard_1lg19_3",de="_widget_1lg19_10",ve="_widgetSpan3_1lg19_19",ge="_widgetSpan6_1lg19_23",xe="_widgetSpan12_1lg19_27",_e="_overviewGrid_1lg19_38",we="_overviewCard_1lg19_44",me="_overviewLabel_1lg19_53",pe="_overviewValue_1lg19_59",ue="_overviewSubtext_1lg19_66",he="_alertsHeader_1lg19_78",je="_alertsGrid_1lg19_86",ye="_alertCard_1lg19_92",be="_alertIcon_1lg19_119",Ne="_alertText_1lg19_124",fe="_sectionHeader_1lg19_137",Se="_sectionTitle_1lg19_145",t={dashboard:le,widget:de,widgetSpan3:ve,widgetSpan6:ge,widgetSpan12:xe,overviewGrid:_e,overviewCard:we,overviewLabel:me,overviewValue:pe,overviewSubtext:ue,alertsHeader:he,alertsGrid:je,alertCard:ye,alertIcon:be,alertText:Ne,sectionHeader:fe,sectionTitle:Se};function De(){const{data:o,isLoading:l,error:n}=k(),{data:r,isLoading:d,error:i}=D(),{data:s,isLoading:m}=V(20),{data:w,isLoading:_}=z(10),g=[{key:"name",label:"Certificate",sortable:!0,render:a=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"13px",color:"var(--text-primary)",marginBottom:"2px"},children:a.name}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-tertiary)",fontFamily:"JetBrains Mono, monospace"},children:a.fingerprint})]})},{key:"type",label:"Type",sortable:!0,render:a=>e.jsx(N,{variant:B("cert-type",a.type),children:a.type})},{key:"issuer",label:"Issuer",sortable:!0},{key:"expiresIn",label:"Expires In",sortable:!0,render:a=>{const T=a.daysLeft<=7?"error":"warning",I=a.daysLeft<=7?e.jsx(C,{size:14}):e.jsx(L,{size:14});return e.jsxs(N,{variant:T,children:[I,a.expiresIn]})}}];if(l||d)return e.jsx(A,{});if(n||i)return e.jsx("div",{style:{padding:"var(--spacing-xl)"},children:e.jsx(E,{error:n||i,message:"Error loading dashboard",shake:!0})});const v=o||{activeCertificates:"0",expiringSoon:"0",pendingRequests:"0",acmeRenewals:"0"},p=r||[],u=s||[],b=w||[];return e.jsxs("div",{className:t.dashboard,children:[e.jsx("div",{className:t.widgetSpan3,children:e.jsx(h,{value:v.activeCertificates,label:"Active Certificates",icon:"certificate",trend:{direction:"up",text:"+12 this week",positive:!0},gradient:!0})}),e.jsx("div",{className:t.widgetSpan3,children:e.jsx(h,{value:v.expiringSoon,label:"Expiring Soon",sublabel:"Within 30 days",icon:"clock",trend:{direction:"down",text:"5 critical (7 days)",positive:!1},variant:"warning"})}),e.jsx("div",{className:t.widgetSpan3,children:e.jsx(h,{value:v.pendingRequests,label:"Pending Requests",sublabel:"CSRs awaiting approval",icon:"file-text",gradient:!0})}),e.jsx("div",{className:t.widgetSpan3,children:e.jsx(h,{value:v.acmeRenewals,label:"ACME Renewals",sublabel:"Last 30 days",icon:"globe",trend:{direction:"up",text:"100% success rate",positive:!0},gradient:!0})}),e.jsxs("div",{className:`${t.widget} ${t.widgetSpan6}`,children:[e.jsx("h2",{className:t.sectionTitle,children:"System Overview"}),e.jsx("div",{className:t.overviewGrid,children:p.map(a=>e.jsxs("div",{className:t.overviewCard,children:[e.jsx("div",{className:t.overviewLabel,children:a.label}),e.jsx("div",{className:t.overviewValue,children:a.value}),e.jsx("div",{className:t.overviewSubtext,children:a.subtext})]},a.label))})]}),e.jsxs("div",{className:`${t.widget} ${t.widgetSpan6}`,children:[e.jsxs("div",{className:t.alertsHeader,children:[e.jsx("h2",{className:t.sectionTitle,style:{marginBottom:0},children:"Alerts"}),e.jsx(N,{variant:"warning",children:"3"})]}),e.jsxs("div",{className:t.alertsGrid,children:[e.jsxs("div",{className:t.alertCard,"data-variant":"warning",children:[e.jsx(C,{size:18,className:t.alertIcon,style:{color:"var(--status-warning)"}}),e.jsxs("div",{className:t.alertText,children:["5 certs",e.jsx("br",{}),"expire soon"]})]}),e.jsxs("div",{className:t.alertCard,"data-variant":"info",children:[e.jsx(R,{size:18,className:t.alertIcon,style:{color:"var(--status-info)"}}),e.jsxs("div",{className:t.alertText,children:["8 CSRs",e.jsx("br",{}),"pending"]})]}),e.jsxs("div",{className:t.alertCard,"data-variant":"success",children:[e.jsx(H,{size:18,className:t.alertIcon,style:{color:"var(--status-success)"}}),e.jsxs("div",{className:t.alertText,children:["Backup",e.jsx("br",{}),"OK"]})]})]})]}),e.jsxs("div",{className:`${t.widget} ${t.widgetSpan12}`,style:{padding:0},children:[e.jsx("div",{style:{padding:"var(--spacing-lg)",paddingBottom:"var(--spacing-sm)"},children:e.jsxs("div",{className:t.sectionHeader,children:[e.jsx("h2",{className:t.sectionTitle,children:"Certificates Expiring Soon"}),e.jsxs(S,{variant:"secondary",children:["View All (",v.expiringSoon,")"]})]})}),e.jsx($,{columns:g,data:b,onRowClick:a=>console.log("Certificate clicked:",a)})]}),e.jsxs("div",{className:`${t.widget} ${t.widgetSpan12}`,children:[e.jsxs("div",{className:t.sectionHeader,children:[e.jsx("h2",{className:t.sectionTitle,children:"Recent Activity"}),e.jsx(S,{variant:"secondary",onClick:()=>window.location.href="/activity",children:"View All"})]}),e.jsx(oe,{items:u})]})]})}export{De as Dashboard,De as default};
