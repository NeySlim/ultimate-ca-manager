import{u}from"./useQuery-Bt0_NKK3.js";import{b as t,d as p}from"./index-SGsZ1yW6.js";import{u as l}from"./useMutation-DsohqOM1.js";const a={getProfile:async()=>(await t.get("/api/v2/account/profile")).data||{},updateProfile:async e=>(await t.patch("/api/v2/account/profile",e)).data,changePassword:async(e,o)=>(await t.post("/api/v2/account/password",{current_password:e,new_password:o})).data,getActivity:async(e={})=>{const o=await t.get("/api/v2/account/activity",{params:e}),i=(o.data||[]).map(s=>{const r=s.action||s.event||"",d=s.category||(r.includes("certificate")||r.includes("ca")||r.includes("csr")?"pki":"app"),c=s.type||s.severity||(r.includes("error")||r.includes("failed")?"error":r.includes("warn")?"warning":"info"),y=s.icon||(c==="error"?"ph-x-circle":c==="warning"?"ph-warning":c==="success"?"ph-check-circle":"ph-info");return{id:s.id,category:d,type:c,icon:y,text:s.message||s.description||r,time:s.timestamp||s.created_at||"N/A",user:s.user||s.username||"System",_raw:s}});return{data:i,meta:o.meta||{page:1,per_page:50,total:i.length}}},getSessions:async()=>(await t.get("/api/v2/account/sessions")).data||[],revokeSession:async e=>(await t.delete(`/api/v2/account/sessions/${e}`)).data,revokeAllSessions:async()=>(await t.delete("/api/v2/account/sessions")).data},n={all:["account"],profile:()=>[...n.all,"profile"],activity:e=>[...n.all,"activity",e],sessions:()=>[...n.all,"sessions"]},w=()=>u({queryKey:n.profile(),queryFn:a.getProfile}),S=(e={})=>u({queryKey:n.activity(e),queryFn:()=>a.getActivity(e)}),v=()=>u({queryKey:n.sessions(),queryFn:a.getSessions}),q=()=>{const e=p();return l({mutationFn:a.revokeSession,onSuccess:()=>{e.invalidateQueries({queryKey:n.sessions()})}})},A=()=>{const e=p();return l({mutationFn:a.revokeAllSessions,onSuccess:()=>{e.invalidateQueries({queryKey:n.sessions()})}})};export{w as a,v as b,q as c,A as d,S as u};
