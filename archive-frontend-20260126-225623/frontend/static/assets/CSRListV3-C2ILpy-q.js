import{r as t,p as D,j as e,s as N,m as S,f as V}from"./index-qRzKqHpr.js";import{n as b}from"./Check.es-Zt1pqGMs.js";import{n as C,a as A}from"./Trash.es-CAaUlvKf.js";import{l as H}from"./UploadSimple.es-Bf2yK2n5.js";import{c as k}from"./Warning.es-BfnXPl2i.js";import{n as z}from"./X.es-BJJE6H0d.js";import{C as M}from"./Card-DP2O2sMW.js";import{S as p,B as h}from"./Stack-cJ82gbg8.js";import{B as Z}from"./Badge-DsMNPsgr.js";import{G as y,a as E}from"./GradientBadge-CBXzLV_s.js";import{I as g}from"./Inline-B7-Fdfl2.js";import{G as f}from"./Grid-DlnCuwNp.js";import{M as L}from"./Modal-1TCfrLh8.js";import{A as w}from"./Alert-COAMCkYg.js";import{E as R}from"./EmptyState-BXoBV4Lu.js";import{S as T}from"./Spinner-CAhRq2Pm.js";import{u as P}from"./useCSRs-Dsks8M_5.js";import"./index-Gg_cCWSY.js";import"./useQuery-BTYUFOaa.js";const F=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216.49,79.51l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.51ZM160,57l23,23H160ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Zm104-60a12,12,0,0,1-12,12H140v12a12,12,0,0,1-24,0V164H104a12,12,0,0,1,0-24h12V128a12,12,0,0,1,24,0v12h12A12,12,0,0,1,164,152Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,88H152V32Z",opacity:"0.2"}),t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-40-64a8,8,0,0,1-8,8H136v16a8,8,0,0,1-16,0V160H104a8,8,0,0,1,0-16h16V128a8,8,0,0,1,16,0v16h16A8,8,0,0,1,160,152Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM152,160H136v16a8,8,0,0,1-16,0V160H104a8,8,0,0,1,0-16h16V128a8,8,0,0,1,16,0v16h16a8,8,0,0,1,0,16Zm0-72V43.31L196.69,88Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Zm-42-66a6,6,0,0,1-6,6H134v18a6,6,0,0,1-12,0V158H104a6,6,0,0,1,0-12h18V128a6,6,0,0,1,12,0v18h18A6,6,0,0,1,158,152Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-40-64a8,8,0,0,1-8,8H136v16a8,8,0,0,1-16,0V160H104a8,8,0,0,1,0-16h16V128a8,8,0,0,1,16,0v16h16A8,8,0,0,1,160,152Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M210.83,85.17l-56-56A4,4,0,0,0,152,28H56A12,12,0,0,0,44,40V216a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V88A4,4,0,0,0,210.83,85.17ZM156,41.65,198.34,84H156ZM200,220H56a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h92V88a4,4,0,0,0,4,4h52V216A4,4,0,0,1,200,220Zm-44-68a4,4,0,0,1-4,4H132v20a4,4,0,0,1-8,0V156H104a4,4,0,0,1,0-8h20V128a4,4,0,0,1,8,0v20h20A4,4,0,0,1,156,152Z"}))]]),I=t.forwardRef((s,c)=>t.createElement(D,{ref:c,...s,weights:F}));I.displayName="FilePlusIcon";const O=I,U="_container_9oke4_1",B="_header_9oke4_7",G="_title_9oke4_14",$="_subtitle_9oke4_21",K="_uploadZone_9oke4_28",q="_uploadIcon_9oke4_54",J="_uploadText_9oke4_67",Q="_uploadSubtext_9oke4_73",W="_csrCard_9oke4_80",X="_csrIcon_9oke4_90",Y="_csrName_9oke4_102",ee="_csrMeta_9oke4_112",ae="_csrDetails_9oke4_117",se="_csrDetailItem_9oke4_123",te="_csrDetailLabel_9oke4_128",le="_modalSection_9oke4_134",ie="_modalSectionTitle_9oke4_140",ne="_detailItem_9oke4_147",re="_detailLabel_9oke4_153",ce="_detailValue_9oke4_162",oe="_sanItem_9oke4_168",de="_pemData_9oke4_174",a={container:U,header:B,title:G,subtitle:$,uploadZone:K,uploadIcon:q,uploadText:J,uploadSubtext:Q,csrCard:W,csrIcon:X,csrName:Y,csrMeta:ee,csrDetails:ae,csrDetailItem:se,csrDetailLabel:te,modalSection:le,modalSectionTitle:ie,detailItem:ne,detailLabel:re,detailValue:ce,sanItem:oe,pemData:de};function me({onUpload:s}){const[c,r]=t.useState(!1),[o,d]=t.useState(!1),n=t.useRef(null),m=l=>{l.preventDefault(),l.stopPropagation(),r(!0)},x=l=>{l.preventDefault(),l.stopPropagation(),r(!1)},v=l=>{l.preventDefault(),l.stopPropagation()},_=l=>{l.preventDefault(),l.stopPropagation(),r(!1);const u=Array.from(l.dataTransfer.files);j(u)},i=l=>{const u=Array.from(l.target.files);j(u)},j=async l=>{d(!0),await new Promise(u=>setTimeout(u,1e3)),s?.(l),d(!1),n.current&&(n.current.value="")};return e.jsxs("div",{className:a.uploadZone,"data-dragging":c,"data-processing":o,onDragEnter:m,onDragOver:v,onDragLeave:x,onDrop:_,onClick:()=>n.current?.click(),children:[e.jsx("input",{ref:n,type:"file",accept:".pem,.csr",multiple:!0,onChange:i,style:{display:"none"}}),o?e.jsxs(p,{gap:"md",align:"center",children:[e.jsx(T,{size:"lg"}),e.jsx("div",{className:a.uploadText,children:"Processing..."})]}):e.jsxs(p,{gap:"md",align:"center",children:[e.jsx("div",{className:a.uploadIcon,children:e.jsx(H,{size:48,weight:"duotone"})}),e.jsxs("div",{children:[e.jsx("div",{className:a.uploadText,children:"Drop CSR files here or click to browse"}),e.jsx("div",{className:a.uploadSubtext,children:"Supports PEM format (.pem, .csr)"})]}),e.jsx(h,{variant:"primary",leftIcon:e.jsx(O,{size:20}),children:"Select Files"})]})]})}function he({csr:s,onView:c,onIssue:r,onDelete:o}){const d=m=>{switch(m){case"pending":return e.jsx(k,{size:14,weight:"fill"});case"approved":return e.jsx(b,{size:14,weight:"fill"});case"rejected":return e.jsx(z,{size:14,weight:"fill"});default:return null}},n=m=>{switch(m){case"pending":return"warning";case"approved":return"success";case"rejected":return"danger";default:return"default"}};return e.jsx(M,{hoverable:!0,className:a.csrCard,children:e.jsxs(p,{gap:"md",children:[e.jsxs(g,{gap:"md",align:"center",children:[e.jsx("div",{className:a.csrIcon,children:e.jsx(N,{size:24,weight:"duotone"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:a.csrName,children:s.common_name}),e.jsx("div",{className:a.csrMeta,children:s.organization||"No Organization"})]}),e.jsx(Z,{variant:n(s.status),children:e.jsxs(g,{gap:"xs",align:"center",children:[d(s.status),e.jsx("span",{children:s.status})]})})]}),e.jsx("div",{className:a.csrDetails,children:e.jsxs(f,{cols:2,gap:"xs",children:[e.jsxs("div",{className:a.csrDetailItem,children:[e.jsx("span",{className:a.csrDetailLabel,children:"Key Size:"}),e.jsxs("span",{children:[s.key_size," bits"]})]}),e.jsxs("div",{className:a.csrDetailItem,children:[e.jsx("span",{className:a.csrDetailLabel,children:"Algorithm:"}),e.jsx("span",{children:s.algorithm})]}),e.jsxs("div",{className:a.csrDetailItem,children:[e.jsx("span",{className:a.csrDetailLabel,children:"Submitted:"}),e.jsx("span",{children:s.created_at})]}),e.jsxs("div",{className:a.csrDetailItem,children:[e.jsx("span",{className:a.csrDetailLabel,children:"By:"}),e.jsx("span",{children:s.submitted_by})]})]})}),e.jsxs(g,{gap:"xs",children:[e.jsx(h,{variant:"secondary",size:"sm",leftIcon:e.jsx(C,{size:16}),onClick:()=>c?.(s),children:"View"}),s.status==="pending"&&e.jsx(h,{variant:"primary",size:"sm",leftIcon:e.jsx(S,{size:16}),onClick:()=>r?.(s),children:"Issue"}),e.jsx(h,{variant:"ghost",size:"sm",leftIcon:e.jsx(V,{size:16}),onClick:()=>{},children:"Export"}),e.jsx(h,{variant:"ghost",size:"sm",leftIcon:e.jsx(A,{size:16}),onClick:()=>o?.(s),children:"Delete"})]})]})})}function pe({csr:s,isOpen:c,onClose:r,onIssue:o}){return s?e.jsx(L,{isOpen:c,onClose:r,size:"lg",title:"CSR Details",children:e.jsxs(p,{gap:"lg",children:[e.jsxs("div",{className:a.modalSection,children:[e.jsx("h3",{className:a.modalSectionTitle,children:"Subject"}),e.jsxs(f,{cols:2,gap:"md",children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("div",{className:a.detailLabel,children:"Common Name"}),e.jsx("div",{className:a.detailValue,children:s.common_name})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("div",{className:a.detailLabel,children:"Organization"}),e.jsx("div",{className:a.detailValue,children:s.organization||"N/A"})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("div",{className:a.detailLabel,children:"Organizational Unit"}),e.jsx("div",{className:a.detailValue,children:s.organizational_unit||"N/A"})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("div",{className:a.detailLabel,children:"Country"}),e.jsx("div",{className:a.detailValue,children:s.country||"N/A"})]})]})]}),e.jsxs("div",{className:a.modalSection,children:[e.jsx("h3",{className:a.modalSectionTitle,children:"Key Information"}),e.jsxs(f,{cols:2,gap:"md",children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("div",{className:a.detailLabel,children:"Algorithm"}),e.jsx("div",{className:a.detailValue,children:s.algorithm})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("div",{className:a.detailLabel,children:"Key Size"}),e.jsxs("div",{className:a.detailValue,children:[s.key_size," bits"]})]})]})]}),s.san&&s.san.length>0&&e.jsxs("div",{className:a.modalSection,children:[e.jsx("h3",{className:a.modalSectionTitle,children:"Subject Alternative Names"}),e.jsx(p,{gap:"xs",children:s.san.map((d,n)=>e.jsx("div",{className:a.sanItem,children:e.jsx(E,{variant:"blue",size:"sm",children:d})},n))})]}),e.jsxs("div",{className:a.modalSection,children:[e.jsx("h3",{className:a.modalSectionTitle,children:"PEM Data"}),e.jsx("div",{className:a.pemData,children:e.jsx("pre",{children:s.pem||"No PEM data available"})})]}),e.jsxs(g,{gap:"sm",justify:"end",children:[e.jsx(h,{variant:"secondary",leftIcon:e.jsx(V,{size:18}),children:"Download"}),s.status==="pending"&&e.jsx(h,{variant:"primary",leftIcon:e.jsx(S,{size:18}),onClick:()=>o?.(s),children:"Issue Certificate"})]})]})}):null}function Ze(){const{data:s,isLoading:c}=P(),[r,o]=t.useState(null),[d,n]=t.useState(!1),m=i=>{console.log("Upload files:",i)},x=i=>{console.log("Issue certificate for CSR:",i)},v=i=>{console.log("Delete CSR:",i)},_=s?.filter(i=>i.status==="pending").length||0;return e.jsxs("div",{className:a.container,children:[e.jsxs(p,{gap:"xl",children:[e.jsx("div",{className:a.header,children:e.jsxs("div",{children:[e.jsx("h1",{className:a.title,children:"Certificate Signing Requests"}),e.jsxs("p",{className:a.subtitle,children:[s?.length||0," CSR",s?.length!==1?"s":""," â€¢ ",_," pending approval"]})]})}),e.jsx(y,{blur:"md",children:e.jsx(me,{onUpload:m})}),e.jsxs(w,{variant:"info",children:[e.jsx("strong",{children:"How it works:"})," Upload CSR files to validate and issue certificates. Supported formats: PEM (.pem, .csr). Each CSR will be automatically parsed and validated."]}),!s||s.length===0?e.jsx(R,{icon:e.jsx(N,{size:64}),title:"No CSRs",description:"Upload CSR files to get started"}):e.jsx(f,{cols:2,gap:"lg",children:s.map(i=>e.jsx(he,{csr:i,onView:j=>{o(j),n(!0)},onIssue:x,onDelete:v},i.id))})]}),e.jsx(pe,{csr:r,isOpen:d,onClose:()=>n(!1),onIssue:x})]})}export{Ze as CSRListV3,Ze as default};
